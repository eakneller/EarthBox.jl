<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Model Building, Execution and Plotting · EarthBox.jl</title><meta name="title" content="Model Building, Execution and Plotting · EarthBox.jl"/><meta property="og:title" content="Model Building, Execution and Plotting · EarthBox.jl"/><meta property="twitter:title" content="Model Building, Execution and Plotting · EarthBox.jl"/><meta name="description" content="Documentation for EarthBox.jl."/><meta property="og:description" content="Documentation for EarthBox.jl."/><meta property="twitter:description" content="Documentation for EarthBox.jl."/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/custom.css" rel="stylesheet" type="text/css"/><script src="../../../assets/equation-refs.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../"><img src="../../../assets/logo.png" alt="EarthBox.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">EarthBox.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../">Introduction</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox"/><label class="tocitem" for="menuitem-2"><span class="docs-label">Installation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../installation/installation/">Installation</a></li><li><a class="tocitem" href="../../../installation/MPI_system/">Using System MPI Binaries</a></li><li><a class="tocitem" href="../../../installation/MUMPS_custom/">Using Custom MUMPS Libraries</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox" checked/><label class="tocitem" for="menuitem-3"><span class="docs-label">Models</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-3-1" type="checkbox" checked/><label class="tocitem" for="menuitem-3-1"><span class="docs-label">Model Management with the EarthBox API</span><i class="docs-chevron"></i></label><ul class="collapsed"><li class="is-active"><a class="tocitem" href>Model Building, Execution and Plotting</a><ul class="internal"><li class="toplevel"><a class="tocitem" href="#Model.jl"><span><code>Model.jl</code></span></a></li><li><a class="tocitem" href="#Command-line-Arguments-for-Model.jl"><span>Command-line Arguments for <code>Model.jl</code></span></a></li><li><a class="tocitem" href="#Using-Model.jl-From-the-REPL"><span>Using <code>Model.jl</code> From the REPL</span></a></li><li><a class="tocitem" href="#Using-Model.jl-From-Command-line"><span>Using <code>Model.jl</code> From Command-line</span></a></li><li><a class="tocitem" href="#Example-Model.jl:-Extension-with-Weak-Fault"><span>Example <code>Model.jl</code>: Extension with Weak Fault</span></a></li><li class="toplevel"><a class="tocitem" href="#Materials.jl"><span><code>Materials.jl</code></span></a></li><li class="toplevel"><a class="tocitem" href="#Plot.jl"><span><code>Plot.jl</code></span></a></li><li><a class="tocitem" href="#Using-Plot.jl-From-Command-line:"><span>Using <code>Plot.jl</code> From Command-line:</span></a></li><li><a class="tocitem" href="#Using-Plot.jl-From-REPL"><span>Using <code>Plot.jl</code> From REPL</span></a></li><li><a class="tocitem" href="#Example-Plot.jl:-Extension-with-Weak-Fault"><span>Example <code>Plot.jl</code>: Extension with Weak Fault</span></a></li></ul></li><li><a class="tocitem" href="../input_file_execution/">Using Input Files</a></li><li><a class="tocitem" href="../background_command_line_execution/">Background Command-line Execution</a></li><li><a class="tocitem" href="../remote_execution/">Batch Remote Execution</a></li><li><a class="tocitem" href="../batch_local_execution/">Batch Local Execution</a></li><li><a class="tocitem" href="../parallel_marker_plotting/">Plotting Marker Swarms in Parallel</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">Models</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../model_list/">Model List</a></li><li><a class="tocitem" href="../../lithospheric_extension/polyphase_extension_n17/">Polyphase Extension n17</a></li><li><a class="tocitem" href="../../lithospheric_extension/extension_weak_fault/">Extension with Weak Fault</a></li><li><a class="tocitem" href="../../lithospheric_extension/extension_with_softening_b14/">Extension with Softening b14</a></li><li><a class="tocitem" href="../../sdr_formation/sdr_formation/">SDR Formation</a></li><li><a class="tocitem" href="../../vep_extension_downhill_diffusion/vep_extension_downhill_diffusion/">Visco-elasto-plastic Extension with Downhill Diffusion</a></li><li><a class="tocitem" href="../../subduction/slab_retreat/">Slab Retreat</a></li><li><a class="tocitem" href="../../sandbox/sandbox_extension/">Sandbox Extension</a></li><li><a class="tocitem" href="../../sandbox/sandbox_shortening/">Sandbox Shortening</a></li><li><a class="tocitem" href="../../spreading_center/spreading_center/">Spreading Center</a></li><li><a class="tocitem" href="../../hot_box_melting/hot_box_melting/">Hot Box Melting</a></li><li><a class="tocitem" href="../../regional/catl/">Magmatic Crust Formation: Central Atlantic</a></li><li><a class="tocitem" href="../../regional/iberia/">Magma Poor Margin: Iberia</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Methods</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../methods/introduction/">Introduction</a></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">Governing Equations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../methods/governing_equations/momentum_and_mass/">Conservation of Momentum and Mass</a></li><li><a class="tocitem" href="../../../methods/governing_equations/energy/">Conservation of Energy</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-3" type="checkbox"/><label class="tocitem" for="menuitem-4-3"><span class="docs-label">Discretization</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../methods/discretization/grid_structure/">Staggered Grid Structure</a></li><li><a class="tocitem" href="../../../methods/discretization/grid_generation/">Staggered Grid Generation</a></li><li><a class="tocitem" href="../../../methods/discretization/marker_distribution/">Marker Distribution</a></li><li><a class="tocitem" href="../../../methods/discretization/stokes2D/">Discretization of the 2D Stokes-continuity Equations</a></li><li><a class="tocitem" href="../../../methods/discretization/conduction/">Discretization of Heat-conduction Equation</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-4" type="checkbox"/><label class="tocitem" for="menuitem-4-4"><span class="docs-label">Boundary Conditions</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../methods/discretization/stokes_bcs/">Stokes Boundary Conditions</a></li><li><a class="tocitem" href="../../../methods/discretization/heat_bcs/">Heat Boundary Conditions</a></li></ul></li><li><a class="tocitem" href="../../../methods/interpolation/marker_grid_interpolation/">Marker-Grid Interpolation</a></li><li><a class="tocitem" href="../../../methods/stokes_algorithm/stokes_algorithm/">Stokes-Continuity Algorithm</a></li><li><a class="tocitem" href="../../../methods/heat_algorithm/heat_algorithm/">Heat Algorithm</a></li><li><a class="tocitem" href="../../../methods/sediment_transport/sediment_transport/">Sediment Transport</a></li><li><a class="tocitem" href="../../../methods/melt/melt/">Melt</a></li><li><a class="tocitem" href="../../../methods/lava_flow/lava_flow/">Lava Flow</a></li><li><a class="tocitem" href="../../../methods/viscous_creep/viscous_creep/">Viscous Creep</a></li><li><a class="tocitem" href="../../../methods/strain_weakening/strain_weakening/">Strain Weakening</a></li><li><a class="tocitem" href="../../../methods/hydrothermal/hydrothermal/">Hydrothermal Circulation</a></li><li><a class="tocitem" href="../../../methods/serpentinization/serpentinization/">Serpentinization</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Thermo-mechanical Algorithm</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/main_steps/">Main Steps</a></li><li><input class="collapse-toggle" id="menuitem-5-2" type="checkbox"/><label class="tocitem" for="menuitem-5-2"><span class="docs-label">Pre-solver Steps</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/pre_solver_steps/pre_solver_steps/">Pre-solver Steps</a></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/pre_solver_steps/sections/rock_property_update/">Rock Property Update Steps</a></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/pre_solver_steps/sections/latent_heat_update/">Latent Heat Update Steps</a></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/pre_solver_steps/sections/hydrothermal_update/">Hydrothermal Update Steps</a></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/pre_solver_steps/sections/marker_failure_prop_update/">Marker Failure Properties Update Steps</a></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/pre_solver_steps/sections/marker_viscosity_update/">Marker Creep Viscosity Update Steps</a></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/pre_solver_steps/sections/melt_damage_update/">Melt Damage Update Steps</a></li></ul></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/stokes_solver_steps/stokes_solver_steps/">Stokes-solver Steps</a></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/heat_solver_steps/heat_solver_steps/">Heat-solver Steps</a></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/advection_solver_steps/advection_solver_steps/">Advection-solver Steps</a></li><li><input class="collapse-toggle" id="menuitem-5-6" type="checkbox"/><label class="tocitem" for="menuitem-5-6"><span class="docs-label">Post-solver Steps</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/post_solver_steps/post_solver_steps/">Post-solver Steps</a></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/post_solver_steps/sections/topography/">Topography</a></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/post_solver_steps/sections/melt_extraction/">Melt Extraction</a></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/post_solver_steps/sections/sediment_transport/">Sediment Transport</a></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/post_solver_steps/sections/lava_flow/">Lava Flow</a></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/post_solver_steps/sections/marker_transformation/">Marker Transformation</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">EarthBox API</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/earthbox_api/">API Overview</a></li><li><a class="tocitem" href="../../../api/earthbox_state/earthbox_state/">EarthBoxState</a></li><li><input class="collapse-toggle" id="menuitem-6-3" type="checkbox"/><label class="tocitem" for="menuitem-6-3"><span class="docs-label">Model Management</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/model_manager/model_manager/">ModelManager</a></li><li><a class="tocitem" href="../../../api/model_manager/xdmf/xdmf_timestep_manager/">XdmfTimeStepsManager</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-4" type="checkbox"/><label class="tocitem" for="menuitem-6-4"><span class="docs-label">Staggered Grid</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/staggered_grid/initialization/">Initialization</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-5" type="checkbox"/><label class="tocitem" for="menuitem-6-5"><span class="docs-label">Material Geometry</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/material_geometry/sticky_air_geometry/">StickyAirGeometry</a></li><li><a class="tocitem" href="../../../api/material_geometry/earth_layering/">EarthLayering</a></li><li><a class="tocitem" href="../../../api/material_geometry/litho_strong_zones/">LithoStrongZones</a></li><li><a class="tocitem" href="../../../api/material_geometry/plume/">Plume</a></li><li><a class="tocitem" href="../../../api/material_geometry/crustal_hole/">CrustalHole</a></li><li><a class="tocitem" href="../../../api/material_geometry/rayleigh_taylor/">RayleighTaylor</a></li><li><a class="tocitem" href="../../../api/material_geometry/mobile_wall/">MobileWall</a></li><li><a class="tocitem" href="../../../api/material_geometry/sandbox/">Sandbox</a></li><li><a class="tocitem" href="../../../api/material_geometry/internal_velocity_zone/">InternalVelocityZone</a></li><li><a class="tocitem" href="../../../api/material_geometry/fracture_zone/">FractureZone</a></li><li><a class="tocitem" href="../../../api/material_geometry/weak_fault/">WeakFault</a></li><li><a class="tocitem" href="../../../api/material_geometry/weak_seed/">WeakSeed</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-6" type="checkbox"/><label class="tocitem" for="menuitem-6-6"><span class="docs-label">Boundary Conditions</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/boundary_conditions/boundary_conditions/">Initialization</a></li><li><a class="tocitem" href="../../../api/boundary_conditions/bc_managers/pressure/">Pressure</a></li><li><a class="tocitem" href="../../../api/boundary_conditions/bc_managers/temperature/">Temperature</a></li><li><a class="tocitem" href="../../../api/boundary_conditions/bc_managers/transient_bottom_temperature/">TransientBottomTemperature</a></li><li><a class="tocitem" href="../../../api/boundary_conditions/bc_managers/velocity/">Velocity</a></li><li><a class="tocitem" href="../../../api/boundary_conditions/bc_managers/velocity_from_strain_rate/">VelocityFromStrainRate</a></li><li><a class="tocitem" href="../../../api/boundary_conditions/bc_managers/velocity_stop/">VelocityStop</a></li><li><a class="tocitem" href="../../../api/boundary_conditions/bc_managers/velocity_step/">VelocityStep</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-7" type="checkbox"/><label class="tocitem" for="menuitem-6-7"><span class="docs-label">Marker Initialization</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/markers/coordinates/">MarkerCoordinates</a></li><li><a class="tocitem" href="../../../api/markers/temperature/">MarkerTemperature</a></li><li><a class="tocitem" href="../../../api/markers/friction/">MarkerFriction</a></li><li><a class="tocitem" href="../../../api/markers/cohesion/">MarkerCohesion</a></li><li><a class="tocitem" href="../../../api/markers/dilatancy/">MarkerDilatancy</a></li><li><a class="tocitem" href="../../../api/markers/viscous_strain_softening/">MarkerViscousStrainSoftening</a></li><li><a class="tocitem" href="../../../api/markers/preexponential/">MarkerPreexponential</a></li><li><a class="tocitem" href="../../../api/markers/stress_limits/">MarkerStressLimits</a></li><li><a class="tocitem" href="../../../api/markers/boundary_friction/">MarkerBoundaryFriction</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-8" type="checkbox"/><label class="tocitem" for="menuitem-6-8"><span class="docs-label">Marker Materials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/marker_materials/materials/">MarkerMaterials</a></li><li><a class="tocitem" href="../../../api/marker_materials/material_collection_files/">Material Collection Files</a></li><li><a class="tocitem" href="../../../api/marker_materials/material_properties/">Material Properties</a></li><li><a class="tocitem" href="../../../api/marker_materials/material_input/">Material Input</a></li><li><a class="tocitem" href="../../../api/marker_materials/material_types/">Material Types</a></li><li><a class="tocitem" href="../../../api/marker_materials/material_domains/">Material Domains</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-9" type="checkbox"/><label class="tocitem" for="menuitem-6-9"><span class="docs-label">Rock Properties</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/rock_properties/rock_properties/">RockProperties</a></li><li><a class="tocitem" href="../../../api/rock_properties/hydrothermal/hydrothermal/">Hydrothermal Circulation</a></li><li><a class="tocitem" href="../../../api/rock_properties/serpentinization/serpentinization/">Serpentinization</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-10" type="checkbox"/><label class="tocitem" for="menuitem-6-10"><span class="docs-label">Stokes Continuity Solver</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/stokes_continuity_solver/stokes_continuity_solver/">StokesContinuitySolver</a></li><li><a class="tocitem" href="../../../api/stokes_continuity_solver/global_plasticity_loop/">GlobalPlasticityLoop</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-11" type="checkbox"/><label class="tocitem" for="menuitem-6-11"><span class="docs-label">Heat Solver</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/heat_solver/heat_solver/">HeatSolver</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-12" type="checkbox"/><label class="tocitem" for="menuitem-6-12"><span class="docs-label">Marker Advection</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/advection/advection/">Advection</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-13" type="checkbox"/><label class="tocitem" for="menuitem-6-13"><span class="docs-label">Interpolation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/interpolation/interpolation/">Interpolation</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-14" type="checkbox"/><label class="tocitem" for="menuitem-6-14"><span class="docs-label">Melt Model</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/melt_model/melt_model/">MeltModel</a></li><li><a class="tocitem" href="../../../api/melt_model/melt_extraction/">MeltExtraction</a></li><li><a class="tocitem" href="../../../api/melt_model/melt_extrusion/">MeltExtrusion</a></li><li><a class="tocitem" href="../../../api/melt_model/melt_damage/">MeltDamage</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-15" type="checkbox"/><label class="tocitem" for="menuitem-6-15"><span class="docs-label">Surface Processes</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/surface_processes/topography/">Topography</a></li><li><a class="tocitem" href="../../../api/surface_processes/sealevel/">Sealevel</a></li><li><a class="tocitem" href="../../../api/surface_processes/relative_base_level/">RelativeBaseLevel</a></li><li><a class="tocitem" href="../../../api/surface_processes/sediment_transport/">SedimentTransport</a></li><li><a class="tocitem" href="../../../api/surface_processes/salt/">SaltDeposition</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-16" type="checkbox"/><label class="tocitem" for="menuitem-6-16"><span class="docs-label">Time Step Execution and Initialization</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/run_time_steps/run_time_steps/">Execution</a></li><li><a class="tocitem" href="../../../api/run_time_steps/time_Step_initialization/">Initialization</a></li><li><a class="tocitem" href="../../../api/run_time_steps/examples/">Examples</a></li></ul></li><li><a class="tocitem" href="../../../api/command_line_args/command_line_args/">Command-line Arguments</a></li><li><a class="tocitem" href="../../../api/case_management/case_management/">Case Management</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox"/><label class="tocitem" for="menuitem-7"><span class="docs-label">Material Library</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../material_library/material_library/">MaterialLibrary</a></li><li><a class="tocitem" href="../../../material_library/collections/lithospheric_deformation_eb1/">Collection: Lithospheric Deformation eb1</a></li><li><a class="tocitem" href="../../../material_library/collections/benchmarks/">Collection: Benchmarks</a></li><li><a class="tocitem" href="../../../material_library/collections/benchmarks_sfs/">Collection: Benchmarks SFS</a></li><li><a class="tocitem" href="../../../material_library/collections/sandbox/">Collection: Sandbox</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8" type="checkbox"/><label class="tocitem" for="menuitem-8"><span class="docs-label">Plot Tools</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../plot_tools/cl_plotter/">Command-line Plotter</a></li><li><a class="tocitem" href="../../../plot_tools/scalar_grid_plots/">Scalar Grid Plots</a></li><li><a class="tocitem" href="../../../plot_tools/vector_plots/">Velocity Vector Plots</a></li><li><a class="tocitem" href="../../../plot_tools/marker_plots/">Marker Swarm Plots</a></li><li><a class="tocitem" href="../../../plot_tools/yield_strength_plots/">Yield Strength Plots</a></li><li><a class="tocitem" href="../../../plot_tools/stokes_convergence_plots/">Stokes Convergence Plots</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-9" type="checkbox"/><label class="tocitem" for="menuitem-9"><span class="docs-label">Data Types</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../data_types/data_types/">Data Types</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-10" type="checkbox"/><label class="tocitem" for="menuitem-10"><span class="docs-label">Model Data</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../model_data/model_data/">ModelData</a></li><li><input class="collapse-toggle" id="menuitem-10-2" type="checkbox"/><label class="tocitem" for="menuitem-10-2"><span class="docs-label">Collections</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../model_data/collections/benchmarks/">Benchmarks</a></li><li><a class="tocitem" href="../../../model_data/collections/bcs/">BoundaryConditions</a></li><li><a class="tocitem" href="../../../model_data/collections/carbonate/">Carbonate</a></li><li><a class="tocitem" href="../../../model_data/collections/conversion/">Conversion</a></li><li><a class="tocitem" href="../../../model_data/collections/geometry/">Geometry</a></li><li><a class="tocitem" href="../../../model_data/collections/gravity/">Gravity</a></li><li><a class="tocitem" href="../../../model_data/collections/grids/">Grids</a></li><li><a class="tocitem" href="../../../model_data/collections/heat_equation/">HeatEquation</a></li><li><a class="tocitem" href="../../../model_data/collections/interpolation/">Interpolation</a></li><li><a class="tocitem" href="../../../model_data/collections/markers/">Markers</a></li><li><a class="tocitem" href="../../../model_data/collections/materials/">Materials</a></li><li><a class="tocitem" href="../../../model_data/collections/melting/">Melting</a></li><li><a class="tocitem" href="../../../model_data/collections/stokes_continuity/">StokesContinuity</a></li><li><a class="tocitem" href="../../../model_data/collections/timestep/">Timestep</a></li><li><a class="tocitem" href="../../../model_data/collections/topography/">Topography</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-11" type="checkbox"/><label class="tocitem" for="menuitem-11"><span class="docs-label">Units</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../units/units/">Units</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-12" type="checkbox"/><label class="tocitem" for="menuitem-12"><span class="docs-label">Benchmarks</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../benchmarks/benchmarks/">Benchmarks</a></li><li><a class="tocitem" href="../../../benchmarks/single_execution/">Single Execution</a></li><li><a class="tocitem" href="../../../benchmarks/batch_execution/">Batch Execution</a></li><li><input class="collapse-toggle" id="menuitem-12-4" type="checkbox"/><label class="tocitem" for="menuitem-12-4"><span class="docs-label">Results</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../benchmarks/models/couette_flow_viscous_heating/">Couette Flow with Viscous Heating</a></li><li><a class="tocitem" href="../../../benchmarks/models/channel_flow_variable_conductivity/">Channel Flow Variable Conductivity</a></li><li><a class="tocitem" href="../../../benchmarks/models/channel_flow_non_steady_temperature/">Channel Flow Non Steady Temperature</a></li><li><a class="tocitem" href="../../../benchmarks/models/channel_flow_non_newtonian/">Channel Flow Non Newtonian</a></li><li><a class="tocitem" href="../../../benchmarks/models/solid_body_rotation/">Solid Body Rotation</a></li><li><a class="tocitem" href="../../../benchmarks/models/rayleigh_taylor_instability/">Rayleigh Taylor Instability</a></li><li><a class="tocitem" href="../../../benchmarks/models/elastic_slab/">Elastic Slab</a></li><li><a class="tocitem" href="../../../benchmarks/models/viscoelastic_stress_buildup/">Viscoelastic Stress Buildup</a></li><li><a class="tocitem" href="../../../benchmarks/models/box_convection_isoviscous_1a/">Box Convection Isoviscous 1a</a></li><li><a class="tocitem" href="../../../benchmarks/models/plasticity_benchmark_kaus10/">Plasticity Benchmark Kaus10</a></li><li><a class="tocitem" href="../../../benchmarks/models/seafloor_spreading/">Seafloor Spreading</a></li><li><a class="tocitem" href="../../../benchmarks/models/flexure_triangular_hole/">Flexure Triangular Hole</a></li><li><a class="tocitem" href="../../../benchmarks/models/viscoelastic_extension/">Viscoelastic Extension</a></li><li><a class="tocitem" href="../../../benchmarks/models/viscoelastic_contraction/">Viscoelastic Contraction</a></li><li><a class="tocitem" href="../../../benchmarks/models/simple_sedimentation/">Simple Sedimentation</a></li></ul></li></ul></li><li><a class="tocitem" href="../../../bibliography/bibliography/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Models</a></li><li><a class="is-disabled">Model Management with the EarthBox API</a></li><li class="is-active"><a href>Model Building, Execution and Plotting</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Model Building, Execution and Plotting</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/eakneller/EarthBox.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Building-and-Executing-Models-with-the-EarthBox-API"><a class="docs-heading-anchor" href="#Building-and-Executing-Models-with-the-EarthBox-API">Building and Executing Models with the EarthBox API</a><a id="Building-and-Executing-Models-with-the-EarthBox-API-1"></a><a class="docs-heading-anchor-permalink" href="#Building-and-Executing-Models-with-the-EarthBox-API" title="Permalink"></a></h1><p>EarthBox models can be constructed and executed using an API. The recommended way to do this is by calling API functions (see <a href="../../../api/earthbox_api/#EarthBox-API-Overview">EarthBox API Overview</a>) from a  script called <a href="#Model.jl"><code>Model.jl</code></a> that includes a module called <code>Model</code> containing the  API calls and a function called <code>run_case()</code> that can be executed via command  line. A script called <a href="#Plot.jl"><code>Plot.jl</code></a> is built by the user for plotting output  files using customizable functions for scalar grids, markers, yield strength profiles and convergence of the non-linear Picard iterations. </p><p>The following scripts are commonly used to build, initialize and execute EarthBox models using the API:</p><ul><li><a href="#Model.jl"><code>Model.jl</code></a></li><li><a href="#Materials.jl"><code>Materials.jl</code></a></li><li><a href="#Plot.jl"><code>Plot.jl</code></a></li></ul><div class="admonition is-info" id="run_earthbox()-b887609a4409eed"><header class="admonition-header">`run_earthbox()`<a class="admonition-anchor" href="#run_earthbox()-b887609a4409eed" title="Permalink"></a></header><div class="admonition-body"><p>The <a href="#Model.jl"><code>Model.jl</code></a> and <a href="#Plot.jl"><code>Plot.jl</code></a> scripts are required by the  <code>run_earthbox()</code> function used for sequential background command-line execution  (see <a href="../background_command_line_execution/#Background-Command-line-Execution">Background Command-line Execution</a>) and for execution on remote  machines (see <a href="../remote_execution/#Batch-Remote-Execution">Batch Remote Execution</a>).</p></div></div><h1 id="Model.jl"><a class="docs-heading-anchor" href="#Model.jl"><code>Model.jl</code></a><a id="Model.jl-1"></a><a class="docs-heading-anchor-permalink" href="#Model.jl" title="Permalink"></a></h1><p>The <code>Model.jl</code> script defines key paths, executes initialization API functions and runs model time steps. The example below is for an extensional model using  a weak fault zone to localize deformation. Material input is defined  by importing a function from a script called <a href="#Materials.jl">Materials.jl</a> that defines  the a dictionary called <code>materials_input_dict</code> with types, domains, colors and  material names from a material library where properties are defined. Alternatively, material input could be defined using a yamal formatted file (See  <a href="../../../api/marker_materials/materials/#MarkerMaterials">MarkerMaterials</a> and <a href="../../../api/marker_materials/material_input/#Material-Input">Material Input</a> for more details).</p><p>The <code>Model.jl</code> script should be setup to manage model case names using EarthBox  API functions (see [EarthBox.GetArgs.get<em>case</em>name<em>from</em>cl<em>args]). The format  used for model cases is <code>case0</code>, <code>case1</code>, <code>case2</code>, etc (default=<code>case0</code>). Model  output is sent to the model output directory named `&lt;case</em>name&gt;<em>output<code>where</code>&lt;case</em>name&gt;` is the name of the model case. </p><p>The model output path is defined using the <code>case_name</code> and the <code>ROOT_PATH_OUTPUT</code> constant unless the <code>model_output_path</code> is provided via command line argument.</p><p>The <code>Model.jl</code> can be used with the module <code>CaseInputs.jl</code> to define model input  parameters based on the model case name (see <a href="../../../api/case_management/case_management/#Case-Management">Case Management</a>). This is  accomplished by including the <code>CaseInputs.jl</code> module and calling the  <code>define_case_inputs</code> function with the <code>case_name</code> as an argument.</p><h2 id="Command-line-Arguments-for-Model.jl"><a class="docs-heading-anchor" href="#Command-line-Arguments-for-Model.jl">Command-line Arguments for <code>Model.jl</code></a><a id="Command-line-Arguments-for-Model.jl-1"></a><a class="docs-heading-anchor-permalink" href="#Command-line-Arguments-for-Model.jl" title="Permalink"></a></h2><ul><li><code>case_name=&lt;case_name&gt;</code><ul><li>The name of the model case like &quot;case0&quot;, &quot;case1&quot;, &quot;case2&quot;, etc. Default is    &quot;case0&quot;. The case name will be used to define inputs if this script is   integrated with the <code>CaseInputs.jl</code> module. The case name is also used to   define the model output path if the model output path is not provided via a    command line argument. If the case name is passed as an argument to the    <code>run_case</code> function, the <code>case_name</code> command line argument will be ignored.</li></ul></li></ul><p>-<code>model_output_path=&lt;model_output_path&gt;</code>     - The path to the model output directory. If not provided, then the model output        path is defined using the <code>case_name</code> and the <code>ROOT_PATH_OUTPUT</code>.</p><h2 id="Using-Model.jl-From-the-REPL"><a class="docs-heading-anchor" href="#Using-Model.jl-From-the-REPL">Using <code>Model.jl</code> From the REPL</a><a id="Using-Model.jl-From-the-REPL-1"></a><a class="docs-heading-anchor-permalink" href="#Using-Model.jl-From-the-REPL" title="Permalink"></a></h2><pre><code class="language-julia hljs">include(&quot;Model.jl&quot;)
Model.run_case(case_name=&lt;case_name&gt;)</code></pre><p>If no <code>&lt;case_name&gt;</code> is provided, then the default case name is <code>case0</code>.</p><h2 id="Using-Model.jl-From-Command-line"><a class="docs-heading-anchor" href="#Using-Model.jl-From-Command-line">Using <code>Model.jl</code> From Command-line</a><a id="Using-Model.jl-From-Command-line-1"></a><a class="docs-heading-anchor-permalink" href="#Using-Model.jl-From-Command-line" title="Permalink"></a></h2><pre><code class="language-bash hljs">julia Model.jl case_name=&lt;case_name&gt;</code></pre><p>where <code>&lt;case_name&gt;</code> is the name of the model case and the model output path is  defined automatically using the <code>case_name</code> and the constant <code>ROOT_PATH_OUTPUT</code>.</p><p>You can also specify the model output path via a command line argument:</p><pre><code class="language-bash hljs">julia Model.jl case_name=&lt;case_name&gt; model_output_path=&lt;model_output_path&gt;</code></pre><h2 id="Example-Model.jl:-Extension-with-Weak-Fault"><a class="docs-heading-anchor" href="#Example-Model.jl:-Extension-with-Weak-Fault">Example <code>Model.jl</code>: Extension with Weak Fault</a><a id="Example-Model.jl:-Extension-with-Weak-Fault-1"></a><a class="docs-heading-anchor-permalink" href="#Example-Model.jl:-Extension-with-Weak-Fault" title="Permalink"></a></h2><pre><code class="language-julia hljs">module Model

using EarthBox
include(&quot;Materials.jl&quot;)
import .Materials: get_materials_input_dict

const ROOT_PATH_OUTPUT = &quot;/mnt/extradrive1/earthbox_output/extension_to_sfs/extension_strong_zones&quot;
const MATERIAL_COLLECTION_PATH = MaterialLibrary().lithospheric_deformation.lithospheric_deformation_eb1.path

# Get the input parameters object so names can be accessed programmatically
const PARAMS = get_eb_parameters()

# Constants are defined for parameters used in multiple initialization functions
const adiabatic_gradient       = 0.4 # K/km
const xsize                    = 500_000.0 # meters
const ysize                    = 160_000.0 # meters
const thick_air                = 10_000.0 # meters
const thick_crust              = 32_000.0 # meters
const thick_upper_crust        = 22_000.0 # meters
const thick_lith               = 125_000.0 # meters
const marker_spacing           = 100.0 # meters (50 m for high resolution case)
const grid_spacing_high_res    = 500.0 # meters (200 m for high resolution case)
const avg_grid_spacing_low_res = 2000.0 # meters
const temperature_base_lith_celsius = 1330.0

function run_case(;case_name::String=&quot;case0&quot;)::Nothing
    print_info(&quot;Running model for case: $case_name&quot;)
    # model output directories are named &lt;case_name&gt;_output where &lt;case_name&gt; is 
    # the name of the model case
    model_output_path = get_model_output_path(case_name, ROOT_PATH_OUTPUT)
    eb = setup_model(model_output_path=model_output_path)
    PRINT_SETTINGS.print_performance = false
    # Here we specify model duration and let EarthBox calculate the viscoelastic
    # time step based on minimum grid spacing and extension rate. The number of
    # time steps is estimated based on the `model_duration_myr` parameter, velocity 
    # stepping and the calculated viscoelastic time step. Alternatively, you could specify 
    # `timestep_viscoelastic` in seconds and `ntimestep_max`. This will deactivate
    # the automated calculations and requires a bit of math to define adequate values.
    # If the calculated velocity is higher than the half-spreading rate leading to
    # a reduced time step , you may may have to set the model duration to a
    # larger value to achieve the desired actual model duration.
    run_time_steps(
        eb,
        make_backup           = true,
        model_duration_myr    = 50.0,
        timestep_out          = ConversionFuncs.years_to_seconds(500_000.0)
    )
    return nothing
end

function setup_model(;model_output_path::String)::EarthBoxState
    # Number of basic nodes in x- and y-directions (xnum, ynum) are calculated 
    # from the T-type refinement parameters and used to initialize the staggered 
    # grid. Alternatively, you could define xnum and ynum directly as input 
    # parameters and provided t-type parameters during Staggered grid initialization.
    # However, this will require putting some thought into defining a sufficient
    # number of basic nodes in x- and y-directions.
    ttype_refinement_parameters = Dict(
        PARAMS.xo_highres.name =&gt; 150_000.0, # meters
        PARAMS.xf_highres.name =&gt; 350_000.0, # meters
        PARAMS.yf_highres.name =&gt; 50_000.0, # meters
        PARAMS.dx_highres.name =&gt; grid_spacing_high_res, # meters (200 m for high resolution case)
        PARAMS.dx_lowres.name  =&gt; avg_grid_spacing_low_res, # meters
        PARAMS.dy_highres.name =&gt; grid_spacing_high_res, # meters (200 m for high resolution case)
        PARAMS.dy_lowres.name  =&gt; avg_grid_spacing_low_res # meters
    )
    eb = EarthBoxState(
        restart_from_backup         = false,
        xsize                       = xsize, # meters
        ysize                       = ysize, # meters
        dx_marker                   = marker_spacing, # meters (50 m for high resolution case)
        dy_marker                   = marker_spacing, # meters (50 m for high resolution case)
        ttype_refinement_parameters = ttype_refinement_parameters,
        use_mumps                   = false,
        nprocs                      = 8,
        use_internal_mumps          = true,
        paths                       = Dict(&quot;output_dir&quot; =&gt; model_output_path)
    )
    initialize_model_input(eb)
    return eb
end

function initialize_model_input(eb::EarthBoxState)::Nothing
    initialize_staggered_grid(eb)
    initialize_geometry(eb)
    initialize_boundary_conditions(eb)
    initialize_marker_coordinates(eb)
    initialize_marker_materials(eb)
    initialize_marker_temperature(eb)
    initialize_marker_plasticity(eb)
    initialize_rock_properties(eb)
    initialize_stokes_continuity_solver(eb)
    initialize_heat_solver(eb)
    initialize_advection_model(eb)
    initialize_interpolation_model(eb)
    initialize_surface_processes_model(eb)
    return nothing
end

function initialize_staggered_grid(eb::EarthBoxState)::Nothing
    # T-type refinement parameters are used from EarthBoxState initialization
    # and not required to be set here. However, if T-type refinement parameters
    # were not previously defined, they must be set here.
    StaggeredGrid.initialize!(
        eb.model_manager.model, grid_type = grid_type_names.TtypeRefinedGrid)
    return nothing
end

function initialize_geometry(eb::EarthBoxState)::Nothing
    model = eb.model_manager.model
    MaterialGeometry.StickyAirGeometry.initialize!(model, thick_air=thick_air)
    MaterialGeometry.EarthLayering.initialize!(
        model,
        thick_lith        = thick_lith, # meters
        thick_crust       = thick_crust, # meters
        thick_upper_crust = thick_upper_crust, # meters
    )
    # The strong zone boundaries are set using T-type refinement parameters
    # and not required to be set here. However, if T-type refinement parameters
    # were not previously defined, `x_left_strong` and `x_right_strong` must be set 
    # here.
    MaterialGeometry.LithoStrongZones.initialize!(model, iuse_strong_zones = 1)
    return nothing
end

function initialize_boundary_conditions(eb::EarthBoxState)::Nothing
    model = eb.model_manager.model
    BoundaryConditions.initialize!(
        model, model_type = bc_model_type_names.LithosphericExtensionFixedBoundaries)
    BoundaryConditions.Pressure.initialize!(model, pressure_bc=1e5)
    BoundaryConditions.Temperature.initialize!(
        model,
        temperature_top    = ConversionFuncs.celsius_to_kelvin(0.0),
        temperature_bottom = ConversionFuncs.celsius_to_kelvin(
            temperature_base_lith_celsius 
            + adiabatic_gradient*(ysize - thick_air - thick_lith)/1000.0
        )
    )
    BoundaryConditions.Velocity.initialize!(
        model,
        full_velocity_extension = ConversionFuncs.cm_yr_to_m_s(0.1),
        full_velocity_extension_step1 = ConversionFuncs.cm_yr_to_m_s(0.5),
        )
    # It is often required to start extension models with a relatively low extension rate
    # and then later increase the extension rate to avoid numerical issues that
    # may manifest themselves as erroneous high strain zones. This issue is
    # overcome by using velocity stepping. In this example we turn on velocity stepping,
    # specify and step time and let EarthBox calculate the the velocity step factor 
    # (`velocity_step_factor`) and time step adjustment factor (`timestep_adjustment_factor`).
    # based on the extension velocities specified above (`full_velocity_extension` and 
    # `full_velocity_extension_step1`). Alternatively, you could specify the velocity step
    # factor (`velocity_step_factor`) and time step adjustment factor (`timestep_adjustment_factor`) 
    # directly.
    BoundaryConditions.VelocityStep.initialize!(
        model,
        iuse_velocity_step = 1,
        velocity_step_time = 0.5, # Myr
    )
    return nothing
end
 
function initialize_marker_coordinates(eb::EarthBoxState)::Nothing
    Markers.MarkerCoordinates.initialize!(
        eb.model_manager.model, 
        marker_distribution=marker_distribution_names.Randomized
        )
    return nothing
end

function initialize_marker_materials(eb::EarthBoxState)::Nothing
    model = eb.model_manager.model
    Markers.MarkerMaterials.initialize!(
        model,
        material_model       = material_model_names.LithosphericExtensionLateralStrongZones,
        paths                = Dict(&quot;materials_library_file&quot; =&gt; MATERIAL_COLLECTION_PATH),
        materials_input_dict = get_materials_input_dict(),
        viscosity_min        = 1e18, # Pa.s
        viscosity_max        = 1e26 # Pa.s
    )
    Markers.MarkerMaterials.MarkerStressLimits.initialize!(
        model, 
        powerlaw_stress_min = 1e4, # Pa
        yield_stress_min    = 0.0, # Pa
        yield_stress_max    = 1e32 # Pa
    )
    return nothing
end

function initialize_marker_temperature(eb::EarthBoxState)::Nothing
    Markers.MarkerTemperature.initialize!(
        eb.model_manager.model,
        initial_temperature_model=initial_temperature_names.AnalyticalThreeLayer,
        parameters=Dict(
            PARAMS.temperature_base_lith.name       =&gt; (
                ConversionFuncs.celsius_to_kelvin(temperature_base_lith_celsius)),
            PARAMS.amplitude_perturbation.name      =&gt; 4000.0, # meters
            PARAMS.width_perturbation.name          =&gt; 10_000.0, # meters
            PARAMS.thick_thermal_lithosphere.name   =&gt; thick_lith, # meters
            PARAMS.adiabatic_gradient.name          =&gt; adiabatic_gradient, # K/km
            PARAMS.conductivity_upper_crust.name    =&gt; 2.25, # W/m/K
            PARAMS.conductivity_lower_crust.name    =&gt; 2.2, # W/m/K
            PARAMS.conductivity_mantle.name         =&gt; 2.0, # W/m/K
            PARAMS.heat_production_upper_crust.name =&gt; 1.25e-6, # W/m^3
            PARAMS.heat_production_lower_crust.name =&gt; 0.2e-6, # W/m^3
            PARAMS.heat_production_mantle.name      =&gt; 0.0, # W/m^3
        )
    )
    return nothing
end

function initialize_marker_plasticity(eb::EarthBoxState)::Nothing
    model = eb.model_manager.model
    Markers.MarkerFriction.initialize!(
        model, initialization_model = friction_init_names.Regular)
    Markers.MarkerCohesion.initialize!(model)
    Markers.MarkerPreexponential.initialize!(model)
    return nothing
end

function initialize_rock_properties(eb::EarthBoxState)::Nothing
    model = eb.model_manager.model
    RockProperties.initialize!(
        model,
        density_model              = density_model_names.Liao14,
        thermal_conductivity_model = thermal_conductivity_model_names.SekiguchiWaples,
        rhocp_model                = rhocp_model_names.TemperatureDependentWaples,
        iuse_sed_porosity          = 1
    )
    return nothing
end

function initialize_stokes_continuity_solver(eb::EarthBoxState)::Nothing
    model = eb.model_manager.model
    StokesContinuitySolver.initialize!(
        model,
        velocity_type                = velocity_type_names.VelocityFromStokesSolver,
        gravity_y                    = 9.8, # m/s^2
        iuse_interface_stabilization = 1
    )
    GlobalPlasticityLoop.initialize!(
        model,
        global_plasticity_loop = global_plasticity_names.NodalPlasticityLoop,
        tolerance_picard       = 1e-2,
        nglobal                = 3
    )
    return nothing
end

function initialize_heat_solver(eb::EarthBoxState)::Nothing
    HeatSolver.initialize!(
        eb.model_manager.model,
        iuse_heat              = 1,
        iuse_adiabatic_heating = 1,
        iuse_shear_heating     = 1,
        iuse_sticky_correction = 1,
        # The max_temp_change is used for the adaptive time stepping scheme used
        # to solve the heat equation.
        max_temp_change        = 70.0 # K
    )
    return nothing
end

function initialize_advection_model(eb::EarthBoxState)::Nothing
    Advection.initialize!(
        eb.model_manager.model,
        advection_scheme         = advection_scheme_names.RungeKutta4thOrder,
        # Decreasing the marker_cell_displ_max can increase numerical accuracy.
        marker_cell_displ_max    = 0.75, # fraction
        subgrid_diff_coef_temp   = 1.0,
        subgrid_diff_coef_stress = 1.0
    )    
    return nothing
end

function initialize_interpolation_model(eb::EarthBoxState)::Nothing
    Interpolation.initialize!(
        eb.model_manager.model,
        iuse_harmonic_avg_normal_viscosity = 1,
        iuse_initial_temp_interp           = 1
    )
    return nothing
end

function initialize_surface_processes_model(eb::EarthBoxState)::Nothing
    model = eb.model_manager.model
    
    SurfaceProcesses.Topography.initialize!(
        model,
        iuse_topo            = 1,
        node_advection       = topo_node_advection_names.RungeKuttaWithInterp,
        dx_topo              = 200.0, # meters
        topo_xsize           = xsize, # meters
        nsmooth_top_bottom   = 2,
        marker_search_factor = 2.0    
    )
    
    SurfaceProcesses.Sealevel.initialize!(
        model,
        option_name               = sealevel_option_names.AveragePressure,
        y_sealevel                = thick_air, # meters
        base_level_shift_end_time = 16.0, # Myr
        base_level_shift          = 0.0, # meters
    )

    SurfaceProcesses.Sealevel.RelativeBaseLevel.initialize!(
        model,
        iuse_linear_segments                   = 0,
        thickness_upper_continental_crust_ref = thick_upper_crust, # meters
        thickness_lower_continental_crust_ref = thick_crust - thick_upper_crust, # meters
        thickness_lithosphere_ref             = thick_lith, # meters
        gridy_spacing_ref                     = 100.0, # meters
        temperature_top_ref                   = 0.0, # Celsius
        temperature_moho_ref                  = 600.0, # Celsius
        temperature_base_lith_ref             = temperature_base_lith_celsius, # Celsius
        adiabatic_gradient_ref                = adiabatic_gradient, # K/km
    )
    return nothing

end

function main()::Nothing
    run_case(case_name=get_case_name_from_cl_args())
    return nothing
end

end # module

if abspath(PROGRAM_FILE) == @__FILE__
    Model.main()
end
</code></pre><h1 id="Materials.jl"><a class="docs-heading-anchor" href="#Materials.jl"><code>Materials.jl</code></a><a id="Materials.jl-1"></a><a class="docs-heading-anchor-permalink" href="#Materials.jl" title="Permalink"></a></h1><p>The <code>Materials.jl</code> script is used to define the material inputs used in the model. This script is not required as material input dictionaries could be built in <code>Model.jl</code> or material input could be defined using a yamal file (See  <a href="../../../api/marker_materials/materials/#MarkerMaterials">MarkerMaterials</a> and <a href="../../../api/marker_materials/material_input/#Material-Input">Material Input</a> for more details).</p><pre><code class="language-julia hljs">module Materials

using EarthBox

function get_materials_input_dict()::MaterialsDictType
    mat_names = MaterialLibrary().lithospheric_deformation.lithospheric_deformation_eb1.materials
    types = MaterialTypesRegistry()
    domains = MaterialDomainsRegistry()

    return MaterialsDictType(
        # Sticky Domain
        Int16(1) =&gt; MaterialDictType(
            &quot;mat_name&quot; =&gt; mat_names.sticky_air,
            &quot;mat_type&quot; =&gt; types.sticky_air,
            &quot;mat_domain&quot; =&gt; domains.atmosphere,
            &quot;red_fraction&quot; =&gt; 255/255,
            &quot;green_fraction&quot; =&gt; 255/255,
            &quot;blue_fraction&quot; =&gt; 255/255,
        ),
        Int16(2) =&gt; MaterialDictType(
            &quot;mat_name&quot; =&gt; mat_names.sticky_water,
            &quot;mat_type&quot; =&gt; types.sticky_water,
            &quot;mat_domain&quot; =&gt; domains.ocean,
            &quot;red_fraction&quot; =&gt; 0/255,
            &quot;green_fraction&quot; =&gt; 255/255,
            &quot;blue_fraction&quot; =&gt; 255/255,
        ),
        # Sedimentary Basin
        Int16(3) =&gt; MaterialDictType(
            &quot;mat_name&quot; =&gt; mat_names.clastic_sediment,
            &quot;mat_type&quot; =&gt; types.sediment,
            &quot;mat_domain&quot; =&gt; domains.sedimentary_basin,
            &quot;red_fraction&quot; =&gt; 0.89411765,
            &quot;green_fraction&quot; =&gt; 0.58039216,
            &quot;blue_fraction&quot; =&gt; 0.28627451,
        ),
        # Felsic Continental Crust
        Int16(4) =&gt; MaterialDictType(
            &quot;mat_name&quot; =&gt; mat_names.felsic_continental_crust,
            &quot;mat_type&quot; =&gt; types.general,
            &quot;mat_domain&quot; =&gt; domains.upper_continental_crust,
            &quot;red_fraction&quot; =&gt; 255/255,
            &quot;green_fraction&quot; =&gt; 153/255,
            &quot;blue_fraction&quot; =&gt; 153/255,
        ),
        Int16(5) =&gt; MaterialDictType(
            &quot;mat_name&quot; =&gt; mat_names.felsic_continental_crust_strong_zone,
            &quot;mat_type&quot; =&gt; types.general,
            &quot;mat_domain&quot; =&gt; domains.upper_continental_crust_strong_zone,
            &quot;red_fraction&quot; =&gt; 255/255,
            &quot;green_fraction&quot; =&gt; 163/255,
            &quot;blue_fraction&quot; =&gt; 163/255,
        ),
        # Mafic Continental Crust
        Int16(6) =&gt; MaterialDictType(
            &quot;mat_name&quot; =&gt; mat_names.mafic_continental_crust,
            &quot;mat_type&quot; =&gt; types.general,
            &quot;mat_domain&quot; =&gt; domains.lower_continental_crust,
            &quot;red_fraction&quot; =&gt; 255/255,
            &quot;green_fraction&quot; =&gt; 200/255,
            &quot;blue_fraction&quot; =&gt; 200/255,
        ),
        Int16(7) =&gt; MaterialDictType(
            &quot;mat_name&quot; =&gt; mat_names.mafic_continental_crust_strong_zone,
            &quot;mat_type&quot; =&gt; types.general,
            &quot;mat_domain&quot; =&gt; domains.lower_continental_crust_strong_zone,
            &quot;red_fraction&quot; =&gt; 255/255,
            &quot;green_fraction&quot; =&gt; 210/255,
            &quot;blue_fraction&quot; =&gt; 210/255,
        ),
        # Continental Mantle Lithosphere
        Int16(8) =&gt; MaterialDictType(
            &quot;mat_name&quot; =&gt; mat_names.ultramafic_continental_lithosphere,
            &quot;mat_type&quot; =&gt; types.general,
            &quot;mat_domain&quot; =&gt; domains.mantle_lithosphere,
            &quot;red_fraction&quot; =&gt; 0.0,
            &quot;green_fraction&quot; =&gt; 153/255,
            &quot;blue_fraction&quot; =&gt; 153/255,
        ),
        Int16(9) =&gt; MaterialDictType(
            &quot;mat_name&quot; =&gt; mat_names.ultramafic_continental_lithosphere_strong_zone,
            &quot;mat_type&quot; =&gt; types.general,
            &quot;mat_domain&quot; =&gt; domains.lithospheric_mantle_strong_zone,
            &quot;red_fraction&quot; =&gt; 0.0,
            &quot;green_fraction&quot; =&gt; 163/255,
            &quot;blue_fraction&quot; =&gt; 163/255,
        ),
        # Asthenosphere
        Int16(10) =&gt; MaterialDictType(
            &quot;mat_name&quot; =&gt; mat_names.ultramafic_asthenosphere_dry_fertile,
            &quot;mat_type&quot; =&gt; types.general,
            &quot;mat_domain&quot; =&gt; domains.asthenosphere,
            &quot;red_fraction&quot; =&gt; 0.0,
            &quot;green_fraction&quot; =&gt; 200/255,
            &quot;blue_fraction&quot; =&gt; 153/255,
        )
    )
end

end # module</code></pre><h1 id="Plot.jl"><a class="docs-heading-anchor" href="#Plot.jl"><code>Plot.jl</code></a><a id="Plot.jl-1"></a><a class="docs-heading-anchor-permalink" href="#Plot.jl" title="Permalink"></a></h1><p>The <code>Plot.jl</code> script is a customized plotting module with user defined plotting  functions and command-line plotter that plots output files stored in the model  output directory. Note that model output directories are named <code>&lt;case_name&gt;_output</code>  where <code>&lt;case_name&gt;</code> is the name of the model case like <code>case0</code>, <code>case1</code>, <code>case2</code>, etc (default=<code>case0</code>).</p><p>For details on command-line arguments and examples, see <a href="../../../plot_tools/cl_plotter/#Command-line-Plotter">Command-line Plotter</a>.</p><h2 id="Using-Plot.jl-From-Command-line:"><a class="docs-heading-anchor" href="#Using-Plot.jl-From-Command-line:">Using <code>Plot.jl</code> From Command-line:</a><a id="Using-Plot.jl-From-Command-line:-1"></a><a class="docs-heading-anchor-permalink" href="#Using-Plot.jl-From-Command-line:" title="Permalink"></a></h2><pre><code class="language-bash hljs">julia Plot.jl &lt;plot_option_name&gt; case_name=&lt;case_name&gt; istart=1 iend=100</code></pre><p>where <code>istart</code> and <code>iend</code> are the starting and ending time steps, <code>&lt;case_name&gt;</code>  is the name of the model case and <code>&lt;plot_option_name&gt;</code> is the name of the plot  option that can be set equal to one of the following values:</p><ul><li><code>marker_plots</code>: Plot markers.</li><li><code>scalar_plots</code>: Plot scalars.</li><li><code>velocity_plots</code>: Plot velocity.</li><li><code>stokes_convergence_plots</code>: Plot Stokes convergence.</li><li><code>yield_strength_plots</code>: Plot yield strength.</li></ul><h2 id="Using-Plot.jl-From-REPL"><a class="docs-heading-anchor" href="#Using-Plot.jl-From-REPL">Using <code>Plot.jl</code> From REPL</a><a id="Using-Plot.jl-From-REPL-1"></a><a class="docs-heading-anchor-permalink" href="#Using-Plot.jl-From-REPL" title="Permalink"></a></h2><pre><code class="language-julia hljs">include(&quot;Plot.jl&quot;)
Plot.marker_plots(
    model_output_path = &quot;/path/to/model_output&quot;,
    istart = 1,
    iend = 100
);</code></pre><div class="admonition is-info" id="istart-and-iend-8b9530a2aec53e02"><header class="admonition-header">istart and iend<a class="admonition-anchor" href="#istart-and-iend-8b9530a2aec53e02" title="Permalink"></a></header><div class="admonition-body"><p><code>istart</code> and <code>iend</code> are not used by the stokes convergence and yield  strength plotting functions.</p></div></div><h2 id="Example-Plot.jl:-Extension-with-Weak-Fault"><a class="docs-heading-anchor" href="#Example-Plot.jl:-Extension-with-Weak-Fault">Example <code>Plot.jl</code>: Extension with Weak Fault</a><a id="Example-Plot.jl:-Extension-with-Weak-Fault-1"></a><a class="docs-heading-anchor-permalink" href="#Example-Plot.jl:-Extension-with-Weak-Fault" title="Permalink"></a></h2><pre><code class="language-julia hljs">module Plot

using EarthBox

include(&quot;Model.jl&quot;)
include(&quot;Materials.jl&quot;)
import .Model: MATERIAL_COLLECTION_PATH, ROOT_PATH_OUTPUT
import .Materials: get_materials_input_dict 

const dimensions = (0.0, 500.0, 0.0, 160.0)
const xyspacing = (50.0, 10.0)
const model_figsize = (10.0, 5.0)

function scalar_plots(;
    model_output_path::String,
    istart::Int64 = 1,
    iend::Union{Int64, Nothing} = nothing
)::Nothing
    plot_scalars(
        scalar_name = :temperature,
        model_output_path = model_output_path,
        dimensions = dimensions,
        xyspacing = xyspacing,
        istart = istart,
        iend = iend,
        figsize = model_figsize
    )
    plot_scalars(
        scalar_name = :viscosity,
        model_output_path = model_output_path,
        dimensions = dimensions,
        xyspacing = xyspacing,
        istart = istart,
        iend = iend,
        figsize = model_figsize
    )
    return nothing
end

function velocity_plots(;
    model_output_path::String,
    istart::Int64 = 1,
    iend::Union{Int64, Nothing} = nothing
)::Nothing
    plot_velocity(
        model_output_path = model_output_path,
        dimensions        = dimensions,
        xyspacing         = xyspacing,
        istart            = istart,
        iend              = iend,
        decimation_factor = 8,
        scale_factor      = 10.0,
        figsize = model_figsize
    )
    return nothing
end

function marker_plots(;
    model_output_path::String,
    istart::Int64 = 1,
    iend::Union{Int64, Nothing} = nothing
)::Nothing
    plot_markers(
        plot_type=:CompositionHeatFlowGravity,
        model_output_path=model_output_path,
        material_library_file_path=MATERIAL_COLLECTION_PATH,
        materials_input_dict=get_materials_input_dict(),
        # General plotting parameters
        dimensions=dimensions,
        xyspacing=xyspacing,
        istart=istart, iend=iend,
        figsize = model_figsize,
        xy_location_contour_legend = (1.0, 5.0),
        text_box_font_size = 5,
        # General marker parameters
        # (reducing the decimation factor reduces pixelation of the plot)
        marker_size=2.0, decimation_factor=5,
        plot_mesh=0, mesh_line_width=0.1,
        plot_contour_labels=1, contour_line_width=1.0, contour_line_color=&quot;black&quot;,
        # Topography parameters
        plot_topography=1, topo_line_width=1.0, 
        topo_line_color=&quot;red&quot;,
        # Base level parameters
        plot_base_level=1, base_level_line_width=1.0,
        base_level_line_color=&quot;blue&quot;,
        # Plastic strain parameters
        plot_plastic_strain = true,
        strain_min = 1.0, strain_max = 6.0,
        strain_contour_interval = 0.25, strain_cmap=&quot;inferno&quot;,
        # Plastic strain rate parameters
        plot_plastic_strain_rate = 1,
        strain_rate_min = -18, strain_rate_max = -12,
        strain_rate_contour_interval = 0.5, strain_rate_cmap = &quot;Reds&quot;,
        # Temperature contours parameters
        plot_temperature_contours=1,
        temperature_min=100.0, temperature_max=1400.0,
        temperature_contour_interval=100.0,
        temperature_number_format=&quot;%6.0f&quot;,
        temperature_contour_color=&quot;black&quot;,
        # Heat flow parameters
        heatflow_min=0.0, heatflow_max=200.0,
        heatflow_spacing=50.0,
        # Gravity Parameters (mgal)
        gravity_min=-1000.0, gravity_max=1000.0,
        gravity_spacing=200.0
    )
    return nothing
end

function yield_strength_plots(;
    model_output_path::String
)::Nothing
    plot_yield_strength(
        model_output_path=model_output_path,
        material_library_file_path=MATERIAL_COLLECTION_PATH,
        materials_input_dict=get_materials_input_dict(),
        depth_plot_limit=150.0,
        depth_axis_spacing=10.0,
        temperature_plot_limit=1400.0,
        temperature_axis_spacing=200.0,
        yield_stress_plot_limit=600.0,
        yield_stress_axis_spacing=50.0,
        strain_rate=1e-15,
        thickness_upr_cont_crust_meters=22_000.0,
        thickness_lwr_cont_crust_meters=10_000.0,
        thickness_lithosphere_meters=125_000.0,
        thickness_asthenosphere_meters=25_000.0,
        dy_meters=100.0,
        expansivity=3e-5,
        compressibility=1e-11,
        density_upper_continental_crust=2822.72,
        density_lower_continental_crust=2900.0,
        density_mantle_lithosphere=3250.0,
        density_asthenosphere=3300.0,
        iuse_linear_segments=false,
        temperature_top_celsius=0.0,
        temperature_moho_celsius=600.0,
        temperature_base_lith_celsius=1330.0,
        adiabatic_gradient_kelvin_km=0.4,
        conductivity_upper_crust=2.25,
        conductivity_lower_crust=2.2,
        conductivity_mantle=2.0,
        heat_production_upper_crust=1.8e-6,
        heat_production_lower_crust=0.5e-6,
        heat_production_mantle=0.0,
        thickness_thermal_lithosphere=125_000.0,
        iuse_fluid_pressure_for_yield=1,
        log10_viscosity_plot_min=20.0,
        log10_viscosity_plot_max=26.0,
        extension=&quot;.pdf&quot;,
        figsize=(3.0, 6.0)
        )
    return nothing
end

function stokes_convergence_plots(;
    model_output_path::String
)::Nothing
    plot_stokes_convergence(
        model_output_path=model_output_path,
        figsize=(16, 4),
        xmin=0,
        xmax=200,
        xspacing=50,
        log_l2_ymin=-7,
        log_l2_ymax=1,
        log_l2_yspacing=1,
        plot_title=&quot;TestCase&quot;,
        axis_label_size=8,
        axis_title_size=8,
        legend_font_size=8,
        xtick_label_size=6,
        ytick_label_size=6,
        annotation_font_size=4
        )
    return nothing
end

function main()::Nothing
    run_cl_plotter(
        root_path_output              = ROOT_PATH_OUTPUT,
        marker_plots_func             = marker_plots,
        scalar_plots_func             = scalar_plots,
        velocity_plots_func           = velocity_plots,
        stokes_convergence_plots_func = stokes_convergence_plots,
        yield_strength_plots_func     = yield_strength_plots
    )
    return nothing
end

end # module

if abspath(PROGRAM_FILE) == @__FILE__
    Plot.main()
end
</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../../installation/MUMPS_custom/">« Using Custom MUMPS Libraries</a><a class="docs-footer-nextpage" href="../input_file_execution/">Using Input Files »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.0 on <span class="colophon-date" title="Saturday 22 November 2025 10:00">Saturday 22 November 2025</span>. Using Julia version 1.12.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
