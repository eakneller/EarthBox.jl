<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Discretization of the 2D Stokes-continuity Equations · EarthBox.jl</title><meta name="title" content="Discretization of the 2D Stokes-continuity Equations · EarthBox.jl"/><meta property="og:title" content="Discretization of the 2D Stokes-continuity Equations · EarthBox.jl"/><meta property="twitter:title" content="Discretization of the 2D Stokes-continuity Equations · EarthBox.jl"/><meta name="description" content="Documentation for EarthBox.jl."/><meta property="og:description" content="Documentation for EarthBox.jl."/><meta property="twitter:description" content="Documentation for EarthBox.jl."/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/custom.css" rel="stylesheet" type="text/css"/><script src="../../../assets/equation-refs.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../"><img src="../../../assets/logo.png" alt="EarthBox.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">EarthBox.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../">Introduction</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox"/><label class="tocitem" for="menuitem-2"><span class="docs-label">Installation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../installation/installation/">Installation</a></li><li><a class="tocitem" href="../../../installation/MPI_system/">Using System MPI Binaries</a></li><li><a class="tocitem" href="../../../installation/MUMPS_custom/">Using Custom MUMPS Libraries</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Models</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-3-1" type="checkbox"/><label class="tocitem" for="menuitem-3-1"><span class="docs-label">Model Management with the EarthBox API</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../models/model_execution/api_building_and_execution/">Model Building, Execution and Plotting</a></li><li><a class="tocitem" href="../../../models/model_execution/input_file_execution/">Using Input Files</a></li><li><a class="tocitem" href="../../../models/model_execution/background_command_line_execution/">Background Command-line Execution</a></li><li><a class="tocitem" href="../../../models/model_execution/remote_execution/">Batch Remote Execution</a></li><li><a class="tocitem" href="../../../models/model_execution/batch_local_execution/">Batch Local Execution</a></li><li><a class="tocitem" href="../../../models/model_execution/parallel_marker_plotting/">Plotting Marker Swarms in Parallel</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">Models</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../models/model_list/">Model List</a></li><li><a class="tocitem" href="../../../models/lithospheric_extension/polyphase_extension_n17/">Polyphase Extension n17</a></li><li><a class="tocitem" href="../../../models/lithospheric_extension/extension_weak_fault/">Extension with Weak Fault</a></li><li><a class="tocitem" href="../../../models/lithospheric_extension/extension_with_softening_b14/">Extension with Softening b14</a></li><li><a class="tocitem" href="../../../models/sdr_formation/sdr_formation/">SDR Formation</a></li><li><a class="tocitem" href="../../../models/vep_extension_downhill_diffusion/vep_extension_downhill_diffusion/">Visco-elasto-plastic Extension with Downhill Diffusion</a></li><li><a class="tocitem" href="../../../models/subduction/slab_retreat/">Slab Retreat</a></li><li><a class="tocitem" href="../../../models/sandbox/sandbox_extension/">Sandbox Extension</a></li><li><a class="tocitem" href="../../../models/sandbox/sandbox_shortening/">Sandbox Shortening</a></li><li><a class="tocitem" href="../../../models/spreading_center/spreading_center/">Spreading Center</a></li><li><a class="tocitem" href="../../../models/hot_box_melting/hot_box_melting/">Hot Box Melting</a></li><li><a class="tocitem" href="../../../models/regional/catl/">Magmatic Crust Formation: Central Atlantic</a></li><li><a class="tocitem" href="../../../models/regional/iberia/">Magma Poor Margin: Iberia</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox" checked/><label class="tocitem" for="menuitem-4"><span class="docs-label">Methods</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../introduction/">Introduction</a></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">Governing Equations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../governing_equations/momentum_and_mass/">Conservation of Momentum and Mass</a></li><li><a class="tocitem" href="../../governing_equations/energy/">Conservation of Energy</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-3" type="checkbox" checked/><label class="tocitem" for="menuitem-4-3"><span class="docs-label">Discretization</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../grid_structure/">Staggered Grid Structure</a></li><li><a class="tocitem" href="../grid_generation/">Staggered Grid Generation</a></li><li><a class="tocitem" href="../marker_distribution/">Marker Distribution</a></li><li class="is-active"><a class="tocitem" href>Discretization of the 2D Stokes-continuity Equations</a><ul class="internal"><li><a class="tocitem" href="#x-Stokes-Discretization"><span>x-Stokes Discretization</span></a></li><li><a class="tocitem" href="#y-Stokes-Discretization"><span>y-Stokes Discretization</span></a></li><li><a class="tocitem" href="#Continuity-Discretization"><span>Continuity Discretization</span></a></li><li><a class="tocitem" href="#Sparse-Stokes-Matrix-Example"><span>Sparse Stokes Matrix Example</span></a></li></ul></li><li><a class="tocitem" href="../conduction/">Discretization of Heat-conduction Equation</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-4" type="checkbox"/><label class="tocitem" for="menuitem-4-4"><span class="docs-label">Boundary Conditions</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../stokes_bcs/">Stokes Boundary Conditions</a></li><li><a class="tocitem" href="../heat_bcs/">Heat Boundary Conditions</a></li></ul></li><li><a class="tocitem" href="../../interpolation/marker_grid_interpolation/">Marker-Grid Interpolation</a></li><li><a class="tocitem" href="../../stokes_algorithm/stokes_algorithm/">Stokes-Continuity Algorithm</a></li><li><a class="tocitem" href="../../heat_algorithm/heat_algorithm/">Heat Algorithm</a></li><li><a class="tocitem" href="../../sediment_transport/sediment_transport/">Sediment Transport</a></li><li><a class="tocitem" href="../../melt/melt/">Melt</a></li><li><a class="tocitem" href="../../lava_flow/lava_flow/">Lava Flow</a></li><li><a class="tocitem" href="../../viscous_creep/viscous_creep/">Viscous Creep</a></li><li><a class="tocitem" href="../../strain_weakening/strain_weakening/">Strain Weakening</a></li><li><a class="tocitem" href="../../hydrothermal/hydrothermal/">Hydrothermal Circulation</a></li><li><a class="tocitem" href="../../serpentinization/serpentinization/">Serpentinization</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Thermo-mechanical Algorithm</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/main_steps/">Main Steps</a></li><li><input class="collapse-toggle" id="menuitem-5-2" type="checkbox"/><label class="tocitem" for="menuitem-5-2"><span class="docs-label">Pre-solver Steps</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/pre_solver_steps/pre_solver_steps/">Pre-solver Steps</a></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/pre_solver_steps/sections/rock_property_update/">Rock Property Update Steps</a></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/pre_solver_steps/sections/latent_heat_update/">Latent Heat Update Steps</a></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/pre_solver_steps/sections/hydrothermal_update/">Hydrothermal Update Steps</a></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/pre_solver_steps/sections/marker_failure_prop_update/">Marker Failure Properties Update Steps</a></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/pre_solver_steps/sections/marker_viscosity_update/">Marker Creep Viscosity Update Steps</a></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/pre_solver_steps/sections/melt_damage_update/">Melt Damage Update Steps</a></li></ul></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/stokes_solver_steps/stokes_solver_steps/">Stokes-solver Steps</a></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/heat_solver_steps/heat_solver_steps/">Heat-solver Steps</a></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/advection_solver_steps/advection_solver_steps/">Advection-solver Steps</a></li><li><input class="collapse-toggle" id="menuitem-5-6" type="checkbox"/><label class="tocitem" for="menuitem-5-6"><span class="docs-label">Post-solver Steps</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/post_solver_steps/post_solver_steps/">Post-solver Steps</a></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/post_solver_steps/sections/topography/">Topography</a></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/post_solver_steps/sections/melt_extraction/">Melt Extraction</a></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/post_solver_steps/sections/sediment_transport/">Sediment Transport</a></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/post_solver_steps/sections/lava_flow/">Lava Flow</a></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/post_solver_steps/sections/marker_transformation/">Marker Transformation</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">EarthBox API</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/earthbox_api/">API Overview</a></li><li><a class="tocitem" href="../../../api/earthbox_state/earthbox_state/">EarthBoxState</a></li><li><input class="collapse-toggle" id="menuitem-6-3" type="checkbox"/><label class="tocitem" for="menuitem-6-3"><span class="docs-label">Model Management</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/model_manager/model_manager/">ModelManager</a></li><li><a class="tocitem" href="../../../api/model_manager/xdmf/xdmf_timestep_manager/">XdmfTimeStepsManager</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-4" type="checkbox"/><label class="tocitem" for="menuitem-6-4"><span class="docs-label">Staggered Grid</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/staggered_grid/initialization/">Initialization</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-5" type="checkbox"/><label class="tocitem" for="menuitem-6-5"><span class="docs-label">Material Geometry</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/material_geometry/sticky_air_geometry/">StickyAirGeometry</a></li><li><a class="tocitem" href="../../../api/material_geometry/earth_layering/">EarthLayering</a></li><li><a class="tocitem" href="../../../api/material_geometry/litho_strong_zones/">LithoStrongZones</a></li><li><a class="tocitem" href="../../../api/material_geometry/plume/">Plume</a></li><li><a class="tocitem" href="../../../api/material_geometry/crustal_hole/">CrustalHole</a></li><li><a class="tocitem" href="../../../api/material_geometry/rayleigh_taylor/">RayleighTaylor</a></li><li><a class="tocitem" href="../../../api/material_geometry/mobile_wall/">MobileWall</a></li><li><a class="tocitem" href="../../../api/material_geometry/sandbox/">Sandbox</a></li><li><a class="tocitem" href="../../../api/material_geometry/internal_velocity_zone/">InternalVelocityZone</a></li><li><a class="tocitem" href="../../../api/material_geometry/fracture_zone/">FractureZone</a></li><li><a class="tocitem" href="../../../api/material_geometry/weak_fault/">WeakFault</a></li><li><a class="tocitem" href="../../../api/material_geometry/weak_seed/">WeakSeed</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-6" type="checkbox"/><label class="tocitem" for="menuitem-6-6"><span class="docs-label">Boundary Conditions</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/boundary_conditions/boundary_conditions/">Initialization</a></li><li><a class="tocitem" href="../../../api/boundary_conditions/bc_managers/pressure/">Pressure</a></li><li><a class="tocitem" href="../../../api/boundary_conditions/bc_managers/temperature/">Temperature</a></li><li><a class="tocitem" href="../../../api/boundary_conditions/bc_managers/transient_bottom_temperature/">TransientBottomTemperature</a></li><li><a class="tocitem" href="../../../api/boundary_conditions/bc_managers/velocity/">Velocity</a></li><li><a class="tocitem" href="../../../api/boundary_conditions/bc_managers/velocity_from_strain_rate/">VelocityFromStrainRate</a></li><li><a class="tocitem" href="../../../api/boundary_conditions/bc_managers/velocity_stop/">VelocityStop</a></li><li><a class="tocitem" href="../../../api/boundary_conditions/bc_managers/velocity_step/">VelocityStep</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-7" type="checkbox"/><label class="tocitem" for="menuitem-6-7"><span class="docs-label">Marker Initialization</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/markers/coordinates/">MarkerCoordinates</a></li><li><a class="tocitem" href="../../../api/markers/temperature/">MarkerTemperature</a></li><li><a class="tocitem" href="../../../api/markers/friction/">MarkerFriction</a></li><li><a class="tocitem" href="../../../api/markers/cohesion/">MarkerCohesion</a></li><li><a class="tocitem" href="../../../api/markers/dilatancy/">MarkerDilatancy</a></li><li><a class="tocitem" href="../../../api/markers/viscous_strain_softening/">MarkerViscousStrainSoftening</a></li><li><a class="tocitem" href="../../../api/markers/preexponential/">MarkerPreexponential</a></li><li><a class="tocitem" href="../../../api/markers/stress_limits/">MarkerStressLimits</a></li><li><a class="tocitem" href="../../../api/markers/boundary_friction/">MarkerBoundaryFriction</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-8" type="checkbox"/><label class="tocitem" for="menuitem-6-8"><span class="docs-label">Marker Materials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/marker_materials/materials/">MarkerMaterials</a></li><li><a class="tocitem" href="../../../api/marker_materials/material_collection_files/">Material Collection Files</a></li><li><a class="tocitem" href="../../../api/marker_materials/material_properties/">Material Properties</a></li><li><a class="tocitem" href="../../../api/marker_materials/material_input/">Material Input</a></li><li><a class="tocitem" href="../../../api/marker_materials/material_types/">Material Types</a></li><li><a class="tocitem" href="../../../api/marker_materials/material_domains/">Material Domains</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-9" type="checkbox"/><label class="tocitem" for="menuitem-6-9"><span class="docs-label">Rock Properties</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/rock_properties/rock_properties/">RockProperties</a></li><li><a class="tocitem" href="../../../api/rock_properties/hydrothermal/hydrothermal/">Hydrothermal Circulation</a></li><li><a class="tocitem" href="../../../api/rock_properties/serpentinization/serpentinization/">Serpentinization</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-10" type="checkbox"/><label class="tocitem" for="menuitem-6-10"><span class="docs-label">Stokes Continuity Solver</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/stokes_continuity_solver/stokes_continuity_solver/">StokesContinuitySolver</a></li><li><a class="tocitem" href="../../../api/stokes_continuity_solver/global_plasticity_loop/">GlobalPlasticityLoop</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-11" type="checkbox"/><label class="tocitem" for="menuitem-6-11"><span class="docs-label">Heat Solver</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/heat_solver/heat_solver/">HeatSolver</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-12" type="checkbox"/><label class="tocitem" for="menuitem-6-12"><span class="docs-label">Marker Advection</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/advection/advection/">Advection</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-13" type="checkbox"/><label class="tocitem" for="menuitem-6-13"><span class="docs-label">Interpolation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/interpolation/interpolation/">Interpolation</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-14" type="checkbox"/><label class="tocitem" for="menuitem-6-14"><span class="docs-label">Melt Model</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/melt_model/melt_model/">MeltModel</a></li><li><a class="tocitem" href="../../../api/melt_model/melt_extraction/">MeltExtraction</a></li><li><a class="tocitem" href="../../../api/melt_model/melt_extrusion/">MeltExtrusion</a></li><li><a class="tocitem" href="../../../api/melt_model/melt_damage/">MeltDamage</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-15" type="checkbox"/><label class="tocitem" for="menuitem-6-15"><span class="docs-label">Surface Processes</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/surface_processes/topography/">Topography</a></li><li><a class="tocitem" href="../../../api/surface_processes/sealevel/">Sealevel</a></li><li><a class="tocitem" href="../../../api/surface_processes/relative_base_level/">RelativeBaseLevel</a></li><li><a class="tocitem" href="../../../api/surface_processes/sediment_transport/">SedimentTransport</a></li><li><a class="tocitem" href="../../../api/surface_processes/salt/">SaltDeposition</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-16" type="checkbox"/><label class="tocitem" for="menuitem-6-16"><span class="docs-label">Time Step Execution and Initialization</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/run_time_steps/run_time_steps/">Execution</a></li><li><a class="tocitem" href="../../../api/run_time_steps/time_Step_initialization/">Initialization</a></li><li><a class="tocitem" href="../../../api/run_time_steps/examples/">Examples</a></li></ul></li><li><a class="tocitem" href="../../../api/command_line_args/command_line_args/">Command-line Arguments</a></li><li><a class="tocitem" href="../../../api/case_management/case_management/">Case Management</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox"/><label class="tocitem" for="menuitem-7"><span class="docs-label">Material Library</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../material_library/material_library/">MaterialLibrary</a></li><li><a class="tocitem" href="../../../material_library/collections/lithospheric_deformation_eb1/">Collection: Lithospheric Deformation eb1</a></li><li><a class="tocitem" href="../../../material_library/collections/benchmarks/">Collection: Benchmarks</a></li><li><a class="tocitem" href="../../../material_library/collections/benchmarks_sfs/">Collection: Benchmarks SFS</a></li><li><a class="tocitem" href="../../../material_library/collections/sandbox/">Collection: Sandbox</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8" type="checkbox"/><label class="tocitem" for="menuitem-8"><span class="docs-label">Plot Tools</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../plot_tools/cl_plotter/">Command-line Plotter</a></li><li><a class="tocitem" href="../../../plot_tools/scalar_grid_plots/">Scalar Grid Plots</a></li><li><a class="tocitem" href="../../../plot_tools/vector_plots/">Velocity Vector Plots</a></li><li><a class="tocitem" href="../../../plot_tools/marker_plots/">Marker Swarm Plots</a></li><li><a class="tocitem" href="../../../plot_tools/yield_strength_plots/">Yield Strength Plots</a></li><li><a class="tocitem" href="../../../plot_tools/stokes_convergence_plots/">Stokes Convergence Plots</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-9" type="checkbox"/><label class="tocitem" for="menuitem-9"><span class="docs-label">Data Types</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../data_types/data_types/">Data Types</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-10" type="checkbox"/><label class="tocitem" for="menuitem-10"><span class="docs-label">Model Data</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../model_data/model_data/">ModelData</a></li><li><input class="collapse-toggle" id="menuitem-10-2" type="checkbox"/><label class="tocitem" for="menuitem-10-2"><span class="docs-label">Collections</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../model_data/collections/benchmarks/">Benchmarks</a></li><li><a class="tocitem" href="../../../model_data/collections/bcs/">BoundaryConditions</a></li><li><a class="tocitem" href="../../../model_data/collections/carbonate/">Carbonate</a></li><li><a class="tocitem" href="../../../model_data/collections/conversion/">Conversion</a></li><li><a class="tocitem" href="../../../model_data/collections/geometry/">Geometry</a></li><li><a class="tocitem" href="../../../model_data/collections/gravity/">Gravity</a></li><li><a class="tocitem" href="../../../model_data/collections/grids/">Grids</a></li><li><a class="tocitem" href="../../../model_data/collections/heat_equation/">HeatEquation</a></li><li><a class="tocitem" href="../../../model_data/collections/interpolation/">Interpolation</a></li><li><a class="tocitem" href="../../../model_data/collections/markers/">Markers</a></li><li><a class="tocitem" href="../../../model_data/collections/materials/">Materials</a></li><li><a class="tocitem" href="../../../model_data/collections/melting/">Melting</a></li><li><a class="tocitem" href="../../../model_data/collections/stokes_continuity/">StokesContinuity</a></li><li><a class="tocitem" href="../../../model_data/collections/timestep/">Timestep</a></li><li><a class="tocitem" href="../../../model_data/collections/topography/">Topography</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-11" type="checkbox"/><label class="tocitem" for="menuitem-11"><span class="docs-label">Units</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../units/units/">Units</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-12" type="checkbox"/><label class="tocitem" for="menuitem-12"><span class="docs-label">Benchmarks</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../benchmarks/benchmarks/">Benchmarks</a></li><li><a class="tocitem" href="../../../benchmarks/single_execution/">Single Execution</a></li><li><a class="tocitem" href="../../../benchmarks/batch_execution/">Batch Execution</a></li><li><input class="collapse-toggle" id="menuitem-12-4" type="checkbox"/><label class="tocitem" for="menuitem-12-4"><span class="docs-label">Results</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../benchmarks/models/couette_flow_viscous_heating/">Couette Flow with Viscous Heating</a></li><li><a class="tocitem" href="../../../benchmarks/models/channel_flow_variable_conductivity/">Channel Flow Variable Conductivity</a></li><li><a class="tocitem" href="../../../benchmarks/models/channel_flow_non_steady_temperature/">Channel Flow Non Steady Temperature</a></li><li><a class="tocitem" href="../../../benchmarks/models/channel_flow_non_newtonian/">Channel Flow Non Newtonian</a></li><li><a class="tocitem" href="../../../benchmarks/models/solid_body_rotation/">Solid Body Rotation</a></li><li><a class="tocitem" href="../../../benchmarks/models/rayleigh_taylor_instability/">Rayleigh Taylor Instability</a></li><li><a class="tocitem" href="../../../benchmarks/models/elastic_slab/">Elastic Slab</a></li><li><a class="tocitem" href="../../../benchmarks/models/viscoelastic_stress_buildup/">Viscoelastic Stress Buildup</a></li><li><a class="tocitem" href="../../../benchmarks/models/box_convection_isoviscous_1a/">Box Convection Isoviscous 1a</a></li><li><a class="tocitem" href="../../../benchmarks/models/plasticity_benchmark_kaus10/">Plasticity Benchmark Kaus10</a></li><li><a class="tocitem" href="../../../benchmarks/models/seafloor_spreading/">Seafloor Spreading</a></li><li><a class="tocitem" href="../../../benchmarks/models/flexure_triangular_hole/">Flexure Triangular Hole</a></li><li><a class="tocitem" href="../../../benchmarks/models/viscoelastic_extension/">Viscoelastic Extension</a></li><li><a class="tocitem" href="../../../benchmarks/models/viscoelastic_contraction/">Viscoelastic Contraction</a></li><li><a class="tocitem" href="../../../benchmarks/models/simple_sedimentation/">Simple Sedimentation</a></li></ul></li></ul></li><li><a class="tocitem" href="../../../bibliography/bibliography/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Methods</a></li><li><a class="is-disabled">Discretization</a></li><li class="is-active"><a href>Discretization of the 2D Stokes-continuity Equations</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Discretization of the 2D Stokes-continuity Equations</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/eakneller/EarthBox.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Discretizing-the-2D-Stokes-Continuity-Equations"><a class="docs-heading-anchor" href="#Discretizing-the-2D-Stokes-Continuity-Equations">Discretizing the 2D Stokes-Continuity Equations</a><a id="Discretizing-the-2D-Stokes-Continuity-Equations-1"></a><a class="docs-heading-anchor-permalink" href="#Discretizing-the-2D-Stokes-Continuity-Equations" title="Permalink"></a></h1><p>Coefficients and right-hand-side terms of the system of equations for the Stokes  and continuity equations are generated by looping over basic grid cells (<a href="../grid_structure/#fig:staggered-grid">fig:staggered-grid</a>)  and discretizing the governing equations associated with unknowns <span>$v_x$</span>, <span>$v_y$</span> and <span>$P&#39;$</span> using finite difference stencils where <span>$v_x$</span> is the x-velocity unknown defined on the  vx-staggered grid, <span>$v_y$</span> is the y-velocity unknown defined on the vy-staggered grid and  <span>$P&#39;$</span> is the scaled pressure unknown defined on the staggered pressure grid. The following  equation shows how the scaled pressure unknown <span>$P&#39;$</span> is related to the Pressure <span>$P$</span>:</p><h6 id="eq:scaled-pressure"><a class="docs-heading-anchor" href="#eq:scaled-pressure">eq:scaled-pressure</a><a id="eq:scaled-pressure-1"></a><a class="docs-heading-anchor-permalink" href="#eq:scaled-pressure" title="Permalink"></a></h6><p class="math-container">\[P&#39; = \frac{P}{f_{P}}\]</p><p>The scaling factor <span>$f_{P}$</span> is defined by the following equation:</p><h6 id="eq:pressure-scaling-factor"><a class="docs-heading-anchor" href="#eq:pressure-scaling-factor">eq:pressure-scaling-factor</a><a id="eq:pressure-scaling-factor-1"></a><a class="docs-heading-anchor-permalink" href="#eq:pressure-scaling-factor" title="Permalink"></a></h6><p class="math-container">\[f_{P} = \left(\frac{ 2\eta_{vp(0,0)b} }{ \Delta x_{avg} + \Delta y_{avg} }\right)\]</p><p>where <span>$\eta_{vp(0,0)b}$</span> is the visco-plastic viscosity at the upper-left node of the basic  grid, <span>$\Delta x_{avg}$</span> and <span>$\Delta y_{avg}$</span> are the average grid spacings in the <span>$x$</span>- and  <span>$y$</span>-directions, respectively, and <span>$P$</span> is pressure.</p><h2 id="x-Stokes-Discretization"><a class="docs-heading-anchor" href="#x-Stokes-Discretization">x-Stokes Discretization</a><a id="x-Stokes-Discretization-1"></a><a class="docs-heading-anchor-permalink" href="#x-Stokes-Discretization" title="Permalink"></a></h2><p>The finite difference representation of the x-Stokes equation <a href="../../governing_equations/momentum_and_mass/#eq:x-stokes">eq:x-stokes</a> is given by:</p><h6 id="eq:x-stokes-fd-representation"><a class="docs-heading-anchor" href="#eq:x-stokes-fd-representation">eq:x-stokes-fd-representation</a><a id="eq:x-stokes-fd-representation-1"></a><a class="docs-heading-anchor-permalink" href="#eq:x-stokes-fd-representation" title="Permalink"></a></h6><p class="math-container">\[\frac{\Delta \sigma_{xx}}{\Delta x} 
+ \frac{\Delta \sigma_{xy}}{\Delta y} 
- \frac{\Delta P}{\Delta x} = -g_x \rho \text{.}\]</p><p>As described by (<a href="../../../bibliography/bibliography/#gerya2010">Gerya, 2010</a>), a conservative finite difference formulation on the stencil shown in <a href="#fig:stencil-x-stokes">Fig.</a> allows <a href="#eq:x-stokes-fd-representation">Eq.</a> to be re-written as:</p><h6 id="eq:x-stokes-discretized"><a class="docs-heading-anchor" href="#eq:x-stokes-discretized">eq:x-stokes-discretized</a><a id="eq:x-stokes-discretized-1"></a><a class="docs-heading-anchor-permalink" href="#eq:x-stokes-discretized" title="Permalink"></a></h6><p class="math-container">\[\begin{split}
\left[
    \frac{
        2 \eta_{vp,R} \frac{(v_{xR} - v_{xC})}{\Delta x_R} 
        -2 \eta_{vp,L} \frac{(v_{xC} - v_{xL})}{\Delta x_L}
    } {\Delta x_C}
\right] \\
+ \left[
    \frac{ 
        \eta_{vp,D} \left(
                \frac{(v_{xD} - v_{xC})}{\Delta y_D} 
                + \frac{(v_{yLR} - v_{yLL})}{\Delta x_C}
            \right)
        - \eta_{vp,U} \left(
                \frac{(v_{xC} - v_{xU})}{\Delta y_U} 
                + \frac{(v_{yUR} - v_{yUL})}{\Delta x_C}
            \right)
    } {\Delta y_C}
\right] \\
- f_{P} \frac{(P_R&#39; - P_L&#39;)}{\Delta x_C} = -g_x \frac{(\rho_U + \rho_D)}{2} 
\end{split}\]</p><p>where the subscripts <span>$L$</span>, <span>$R$</span>, <span>$U$</span>, <span>$D$</span>, <span>$UL$</span>, <span>$LL$</span>, <span>$UR$</span> and <span>$LR$</span> denote nodal  position to the left, right, up, down, upper-left, lower-left, upper-right and lower-right,  respectively, with respect to the central velocity node <span>$v_{xC}$</span> located along the right right  boundary of the basic grid cell where the stencil is applied. Subscripts <span>$b$</span>, <span>$p$</span>, <span>$x$</span> and  <span>$y$</span> refer to the basic, pressure, x-velocity and y-velocity grids, respectively. The grid  spacings <span>$\Delta x_C$</span>, <span>$\Delta x_L$</span>, <span>$\Delta x_R$</span> denote the x-direction grid spacings  centered on the central velocity node <span>$v_{xC}$</span>, to the left of this node and to the right of  this node, respectively. The grid spacings <span>$\Delta y_C$</span>, <span>$\Delta y_U$</span>, <span>$\Delta y_D$</span>, denote  the y-direction grid spacings centered on the central velocity node <span>$v_{xC}$</span>, above this node  and below this node, respectively. </p><p><img src="../images/stencil_x_stokes.png" alt="x-Stokes Stencil"/></p><h5 id="fig:stencil-x-stokes"><a class="docs-heading-anchor" href="#fig:stencil-x-stokes">fig:stencil-x-stokes</a><a id="fig:stencil-x-stokes-1"></a><a class="docs-heading-anchor-permalink" href="#fig:stencil-x-stokes" title="Permalink"></a></h5><p><em>Stencil used to discretize Stokes equations in the x-direction to produce the finite  difference representation shown in equation <a href="#eq:x-stokes-discretized">Eq.</a>. This stencil is  used to generate an equation associated with the central velocity unknown <span>$v_{xC}$</span> for the large system of equations with coefficients for unknowns <span>$v_{xC}$</span>, <span>$v_{xL}$</span>, <span>$v_{xR}$</span>, <span>$v_{xU}$</span>, <span>$v_{xD}$</span>, <span>$v_{yUL}$</span>, <span>$v_{yLL}$</span>, <span>$v_{yUR}$</span>, <span>$v_{yLR}$</span>, <span>$P&#39;_R$</span>, <span>$P&#39;_L$</span> and the right-hand-side term as shown in  equation <a href="#eq:x-stokes-coeff">Eq.</a>. Red circles denote nodes on the x-velocity grid, blue circles  denote nodes on the y-velocity grid, light blue circles denote nodes on the pressure grid, and  black circles denote nodes on the basic grid. This stencil is applied to the basic grid cell  colored light gray with upper-left node indices <span>$(i,j)_b$</span>. Staggered grid indices are shown with  small font for nodes used in the stencil. Unknowns and staggered grid spacings use the following  subscript notation to denote position relative to the central velocity node <span>$v_{xC}$</span>: C, L, R, U,  D, UL, LL, UR, and LR denote the central, left, right, up, down, upper-left, lower-left,  upper-right, and lower-right positions, respectively.</em></p><p>Rearranging <a href="#eq:x-stokes-discretized">Eq.</a> leads to the following equation with coefficients  for unknowns <span>$v_{xC}$</span>, <span>$v_{xL}$</span>, <span>$v_{xR}$</span>, <span>$v_{xU}$</span>, <span>$v_{xD}$</span>, <span>$v_{yUL}$</span>, <span>$v_{yLL}$</span>,  <span>$v_{yUR}$</span>, <span>$v_{yLR}$</span>, <span>$P&#39;_R$</span>, <span>$P&#39;_L$</span> and the right-hand-side term <span>$R_x$</span>:</p><h6 id="eq:x-stokes-coeff"><a class="docs-heading-anchor" href="#eq:x-stokes-coeff">eq:x-stokes-coeff</a><a id="eq:x-stokes-coeff-1"></a><a class="docs-heading-anchor-permalink" href="#eq:x-stokes-coeff" title="Permalink"></a></h6><p class="math-container">\[\begin{split}
&amp; -\left(
     \frac{2 \eta_{vp,L}}{\Delta x_L \Delta x_C} 
    + \frac{2 \eta_{vp,R}}{\Delta x_R \Delta x_C} 
    + \frac{\eta_{vp,U}}{\Delta y_U \Delta y_C} 
    + \frac{\eta_{vp,D}}{\Delta y_D \Delta y_C}
 \right) v_{xC} \\
&amp; + \frac{2 \eta_{vp,L}}{\Delta x_L \Delta x_C} v_{xL} 
+ \frac{2 \eta_{vp,R}}{\Delta x_R \Delta x_C} v_{xR} 
+ \frac{\eta_{vp,U}}{\Delta y_U \Delta y_C} v_{xU} 
+ \frac{\eta_{vp,D}}{\Delta y_D \Delta y_C} v_{xD} \\
&amp; + \frac{\eta_{vp,U}}{\Delta x_C \Delta y_C} v_{yUL} 
- \frac{\eta_{vp,D}}{\Delta x_C \Delta y_C} v_{yLL} 
-\frac{\eta_{vp,U} }{\Delta x_C \Delta y_C} v_{yUR} 
-  \frac{\eta_{vp,D}}{\Delta x_C \Delta y_C} v_{yLR} \\
&amp; - \frac{f_{P}}{\Delta x_C} P_R&#39; 
+ \frac{f_{P}}{\Delta x_C} P_L&#39; 
= -g_x \frac{\rho_U + \rho_D}{2}.
\end{split}\]</p><p>The large matrix coordinates <span>$(i&#39;,j&#39;)$</span> of coefficients in equation  <a href="#eq:x-stokes-coeff">Eq.</a> are related to the global index <span>$I_{v_x}$</span> from  equation <a href="../grid_structure/#eq:global-indices-of-stokes-unknowns">Eq.</a> as follows:</p><h6 id="eq:stokes-coeff-global-indices"><a class="docs-heading-anchor" href="#eq:stokes-coeff-global-indices">eq:stokes-coeff-global-indices</a><a id="eq:stokes-coeff-global-indices-1"></a><a class="docs-heading-anchor-permalink" href="#eq:stokes-coeff-global-indices" title="Permalink"></a></h6><p class="math-container">\[\begin{split}
    v_{xC} \text{ : } &amp; (I_{v_x} \text{, } I_{v_x}) \\
    v_{xL} \text{ : } &amp; (I_{v_x} \text{, } I_{v_x} - \Delta I_{v_{xR}}) \\
    v_{xR} \text{ : } &amp; (I_{v_x} \text{, } I_{v_x} + \Delta I_{v_{xR}}) \\
    v_{xU} \text{ : } &amp; (I_{v_x} \text{, } I_{v_x} - 3) \\
    v_{xD} \text{ : } &amp; (I_{v_x} \text{, } I_{v_x} + 3) \\
    v_{yUL} \text{ : } &amp; (I_{v_x} \text{, } I_{v_x} - 2) \\
    v_{yUR} \text{ : } &amp; (I_{v_x} \text{, } I_{v_x} - 2 + \Delta I_{v_{xR}}) \\
    v_{yLL} \text{ : } &amp; (I_{v_x} \text{, } I_{v_x} + 1) \\
    v_{yLR} \text{ : } &amp; (I_{v_x} \text{, } I_{v_x} + 1 + \Delta I_{v_{xR}}) \\
    P&#39;_L \text{ : } &amp; (I_{v_x} \text{, } I_{v_x} + 2) \\
    P&#39;_R \text{ : } &amp; (I_{v_x} \text{, } I_{v_x} + 2 + \Delta I_{v_{xR}}) \\
\end{split}\]</p><p>where <span>$\Delta I_{v_{xR}}$</span> is the cell index shift required to get to the right velocity node and  is defined as follows: </p><p class="math-container">\[\Delta I_{v_{xR}} = 3(N_{y(b)} - 1)\]</p><p>The x-Stokes stencil is not applied along basic cells located along the right boundary  since the <span>$v_{xC}$</span> is prescribed. For these cases the matrix element  <span>$(3I_{cell} \text{, } 3I_{cell})$</span> is equal to 1 and the right-hand-side is equal to the  prescribed <span>$v_x$</span> velocity (<span>$v_x$</span> = zero for free slip and no slip). These nodes are referred  to as ghost unknowns by (<a href="../../../bibliography/bibliography/#gerya2010">Gerya, 2010</a>). When ghost boundary nodes are included in the  stencil formulation some unknowns become constants that are moved to the right-hand-side of the  system of equations.</p><h2 id="y-Stokes-Discretization"><a class="docs-heading-anchor" href="#y-Stokes-Discretization">y-Stokes Discretization</a><a id="y-Stokes-Discretization-1"></a><a class="docs-heading-anchor-permalink" href="#y-Stokes-Discretization" title="Permalink"></a></h2><p>The finite difference representation of the y-Stokes equation  <a href="../../governing_equations/momentum_and_mass/#eq:y-stokes-stabilization">eq:y-stokes-stabilization</a> is given by:</p><h6 id="eq:y-stokes-fd-representation"><a class="docs-heading-anchor" href="#eq:y-stokes-fd-representation">eq:y-stokes-fd-representation</a><a id="eq:y-stokes-fd-representation-1"></a><a class="docs-heading-anchor-permalink" href="#eq:y-stokes-fd-representation" title="Permalink"></a></h6><p class="math-container">\[\frac{\Delta \sigma_{yy}}{\Delta y} 
+ \frac{\Delta \sigma_{yx}}{\Delta x} 
- \frac{\Delta P}{\Delta y} 
- g_y \Delta t \left( v_x\frac{\Delta \rho}{\Delta x} + v_y\frac{\Delta \rho}{\Delta y}\right) 
= -g_y \rho \text{,}\]</p><p>which can be rewritten by applying conservative finite difference formulation of  (<a href="../../../bibliography/bibliography/#gerya2010">Gerya, 2010</a>) as:</p><h6 id="eq:y-stokes-discretized"><a class="docs-heading-anchor" href="#eq:y-stokes-discretized">eq:y-stokes-discretized</a><a id="eq:y-stokes-discretized-1"></a><a class="docs-heading-anchor-permalink" href="#eq:y-stokes-discretized" title="Permalink"></a></h6><p class="math-container">\[\begin{split}
\left[\frac{
    2\eta_{vp,D}\frac{(v_{yD} - v_{yC})}{\Delta y_D} 
    - 2\eta_{vp,U}\frac{(v_{yC} - v_{yU})}{\Delta y_U}
}{\Delta y_C}\right] \\
+ \left[\frac{ 
    \eta_{vp,R}
        \left(
            \frac{(v_{yR} - v_{yC})}{\Delta x_R} 
            + \frac{(v_{xLR} - v_{xUR})}{\Delta y_C}
        \right)
        - \eta_{vp,L}
            \left(
                \frac{(v_{yC} - v_{yL})}{\Delta x_L} 
                + \frac{(v_{xLL} - v_{xUL})}{\Delta y_C}
            \right) 
    }{\Delta x_C} \right]\\
- f_P\frac{(P&#39;_D - P&#39;_U)}{\Delta y_C}\\
- g_y  \Delta t \frac{1}{4}
    \left(v_{xUL} + v_{xUR} + v_{xLL} + v_{xLR}\right)
        \frac{1}{2}\left(\frac{\rho_{RR} - \rho_R}{\Delta x_R} + \frac{\rho_R - \rho_{L}}{\Delta x_L}\right)\\
- g_y  \Delta t v_{yC} \frac{1}{2}
    \left(\frac{\rho_{LR} - \rho_R}{\Delta y_D} + \frac{\rho_R - \rho_{UR}}{\Delta y_U}\right)\\
= -g_y\frac{(\rho_{bR}+\rho_{bL})}{2}
\end{split}\]</p><p>where the subscripts <span>$L$</span>, <span>$R$</span>, <span>$RR$</span>, <span>$U$</span>, <span>$D$</span>, <span>$UL$</span>, <span>$LL$</span>, <span>$UR$</span> and <span>$LR$</span> denote  nodal position to the left, right, right-right, up, down, upper-left, lower-left, upper-right and  lower-right, respectively, with respect to the central velocity node <span>$v_{yC}$</span> located along the  upper boundary of the basic grid cell where the stencil is applied. Subscripts <span>$b$</span>, <span>$p$</span>,  <span>$x$</span> and <span>$y$</span> refer to the basic, pressure, x-velocity and y-velocity grids, respectively. The  grid spacings <span>$\Delta y_C$</span>, <span>$\Delta y_U$</span>, <span>$\Delta y_D$</span> denote the y-direction grid spacings  centered on the central velocity node <span>$v_{yC}$</span>, above this node and below this node,  respectively. The grid spacings <span>$\Delta x_C$</span>, <span>$\Delta x_L$</span>, <span>$\Delta x_R$</span> denote the  x-direction grid spacings centered on the central velocity node <span>$v_{yC}$</span>, to the left of this  node and to the right of this node, respectively. </p><p><img src="../images/stencil_y_stokes.png" alt="y-Stokes Stencil"/></p><h5 id="fig:stencil-y-stokes"><a class="docs-heading-anchor" href="#fig:stencil-y-stokes">fig:stencil-y-stokes</a><a id="fig:stencil-y-stokes-1"></a><a class="docs-heading-anchor-permalink" href="#fig:stencil-y-stokes" title="Permalink"></a></h5><p><em>Stencil used to discretize Stokes equations in the y-direction to produce the finite  difference representation shown in equation <a href="#eq:y-stokes-discretized">Eq.</a>. This stencil is  used to generate an equation associated with the central velocity unknown <span>$v_{yC}$</span> for the large system of equations with coefficients for unknowns <span>$v_{yC}$</span>, <span>$v_{yL}$</span>+, <span>$v_{yR}$</span>, <span>$v_{yU}$</span>, <span>$v_{yD}$</span>, <span>$v_{xUL}$</span>, <span>$v_{xLL}$</span>, <span>$v_{xUR}$</span>, <span>$v_{xLR}$</span>, <span>$P&#39;_U$</span>, <span>$P&#39;_D$</span> and the right-hand-side term as shown in  equation <a href="#eq:y-stokes-coeff">Eq.</a>. See figure <a href="#fig:stencil-x-stokes">Fig.</a> for additional details.</em></p><p>Rearranging <a href="#eq:y-stokes-discretized">Eq.</a> leads to the following equation with coefficients  for unknowns <span>$v_{yC}$</span>, <span>$v_{yU}$</span>, <span>$v_{yD}$</span>, <span>$v_{yL}$</span>, <span>$v_{yR}$</span>, <span>$v_{xUL}$</span>, <span>$v_{xLL}$</span>,  <span>$v_{xUR}$</span>, <span>$v_{xLR}$</span>, <span>$P&#39;_U$</span>, <span>$P&#39;_D$</span> and the right-hand-side term <span>$R_y$</span>:</p><h6 id="eq:y-stokes-coeff"><a class="docs-heading-anchor" href="#eq:y-stokes-coeff">eq:y-stokes-coeff</a><a id="eq:y-stokes-coeff-1"></a><a class="docs-heading-anchor-permalink" href="#eq:y-stokes-coeff" title="Permalink"></a></h6><p class="math-container">\[\begin{split}
- \left(
    \frac{2\eta_{vp,U}}{\Delta y_C\Delta y_U} 
    + \frac{2\eta_{vp,D}}{\Delta y_C\Delta y_D} 
    + \frac{\eta_{vp,L}}{\Delta x_C\Delta x_L} 
    + \frac{\eta_{vp,R}}{\Delta x_C\Delta x_R}
    + c_{y,stab}
\right) v_{yC} \\
+ \frac{2\eta_{vp,L}}{\Delta x_C\Delta x_L}v_{yL}
+ \frac{2\eta_{vp,R}}{\Delta x_C\Delta x_R}v_{yR}
+ \frac{2\eta_{vp,U}}{\Delta y_C\Delta y_U}v_{yU}
+ \frac{2\eta_{vp,D}}{\Delta y_C\Delta y_D}v_{yD} \\
+ \left(\frac{\eta_{vp,L}}{\Delta x_C\Delta y_C}-c_{x,stab}\right)v_{xUL}\\
- \left(\frac{\eta_{vp,L}}{\Delta x_C\Delta y_C}+c_{x,stab}\right)v_{xLL}\\
- \left(\frac{\eta_{vp,R}}{\Delta x_C\Delta y_C}+c_{x,stab}\right)v_{xUR}\\
- \left(\frac{\eta_{vp,R}}{\Delta x_C\Delta y_C}+c_{x,stab}\right)v_{xLR} \\
- \frac{f_P}{\Delta y_C}P&#39;_D
+ \frac{f_P}{\Delta y_C}P&#39;_U
= -g_y\frac{(\rho_{bR}+\rho_{bL})}{2}
\end{split}\]</p><p>where <span>$c_{y,stab}$</span> is given by:</p><h6 id="eq:y-stokes-stab"><a class="docs-heading-anchor" href="#eq:y-stokes-stab">eq:y-stokes-stab</a><a id="eq:y-stokes-stab-1"></a><a class="docs-heading-anchor-permalink" href="#eq:y-stokes-stab" title="Permalink"></a></h6><p class="math-container">\[c_{y,stab} 
= g_y  \Delta t \frac{1}{2}
\left(\frac{\rho_{LR} - \rho_R}{\Delta y_D} + \frac{\rho_R - \rho_{UR}}{\Delta y_U}\right) \text{,}\]</p><p>and <span>$c_{x,stab}$</span> is given by:</p><h6 id="eq:x-stokes-stab"><a class="docs-heading-anchor" href="#eq:x-stokes-stab">eq:x-stokes-stab</a><a id="eq:x-stokes-stab-1"></a><a class="docs-heading-anchor-permalink" href="#eq:x-stokes-stab" title="Permalink"></a></h6><p class="math-container">\[c_{x,stab} = g_y  \Delta t \frac{1}{8}
\left(\frac{\rho_{RR} - \rho_R}{\Delta x_R} + \frac{\rho_R - \rho_{L}}{\Delta x_L}\right) \text{.}\]</p><p>The large matrix coordinates <span>$(i&#39;,j&#39;)$</span> of coefficients in equation  <a href="#eq:y-stokes-coeff">Eq.</a> are related to the global index <span>$I_{v_y}$</span> from  equation <a href="../grid_structure/#eq:global-indices-of-stokes-unknowns">eq:global-indices-of-stokes-unknowns</a> as follows:</p><h6 id="eq:y-stokes-matrix-indices"><a class="docs-heading-anchor" href="#eq:y-stokes-matrix-indices">eq:y-stokes-matrix-indices</a><a id="eq:y-stokes-matrix-indices-1"></a><a class="docs-heading-anchor-permalink" href="#eq:y-stokes-matrix-indices" title="Permalink"></a></h6><p class="math-container">\[\begin{split}
    v_{yC} \text{ : } &amp; (I_{v_y} \text{, } I_{v_y}) \\
    v_{yU} \text{ : } &amp;  (I_{v_y} \text{, } I_{v_y} - 3) \\
    v_{yD} \text{ : } &amp; (I_{v_y} \text{, } I_{v_y} + 3) \\
    v_{yL} \text{ : } &amp; (I_{v_y} \text{, } I_{v_y} - \Delta I_{v_{xR}}) \\
    v_{yR} \text{ : } &amp; (I_{v_y} \text{, } I_{v_y} + \Delta I_{v_{xR}}) \\
    v_{xUL} \text{ : } &amp; (I_{v_y} \text{, } I_{v_y} - 1 - \Delta I_{v_{xR}}) \\
    v_{xLL} \text{ : } &amp; (I_{v_y} \text{, } I_{v_y} + 2 - \Delta I_{v_{xR}}) \\
    v_{xUR} \text{ : } &amp; (I_{v_y} \text{, } I_{v_y} - 1) \\
    v_{xLR} \text{ : } &amp; (I_{v_y} \text{, } I_{v_y} + 2) \\
    P&#39;_U \text{ : } &amp; (I_{v_y} \text{, } I_{v_y} + 1) \\
    P&#39;_D \text{ : } &amp; (I_{v_y} \text{, } I_{v_y} + 4) \\
\end{split}\]</p><h2 id="Continuity-Discretization"><a class="docs-heading-anchor" href="#Continuity-Discretization">Continuity Discretization</a><a id="Continuity-Discretization-1"></a><a class="docs-heading-anchor-permalink" href="#Continuity-Discretization" title="Permalink"></a></h2><p>The finite difference representation of the continuity equation <a href="../../governing_equations/momentum_and_mass/#eq:continuity">Eq</a> is given by:</p><h6 id="eq:continuity-fd-representation"><a class="docs-heading-anchor" href="#eq:continuity-fd-representation">eq:continuity-fd-representation</a><a id="eq:continuity-fd-representation-1"></a><a class="docs-heading-anchor-permalink" href="#eq:continuity-fd-representation" title="Permalink"></a></h6><p class="math-container">\[\frac{\Delta v_x}{\Delta x} + \frac{\Delta v_y}{\Delta y} = R_c\]</p><p>which can be rewritten by applying conservative finite difference formulation of \cite{gerya2010} as:</p><h6 id="eq:continuity-discretized"><a class="docs-heading-anchor" href="#eq:continuity-discretized">eq:continuity-discretized</a><a id="eq:continuity-discretized-1"></a><a class="docs-heading-anchor-permalink" href="#eq:continuity-discretized" title="Permalink"></a></h6><p class="math-container">\[\begin{split}
\left[
    \frac{v_{xR} - v_{xL}}{\Delta x_b} 
    + \frac{v_{yD} - v_{yU}}{\Delta y_b}
\right] = 0
\end{split}\]</p><p>where the subscripts <span>$L$</span>, <span>$R$</span>, <span>$U$</span>, <span>$D$</span> denote nodal position to the left, right, up and down, respectively, with respect to the central pressure node <span>$P&#39;_{pC}$</span> located at the center of the basic grid cell where  the stencil is applied. Subscripts <span>$b$</span>, <span>$p$</span>, <span>$x$</span> and <span>$y$</span> refer to the basic, pressure, x-velocity and y-velocity grids, respectively. The grid spacings <span>$\Delta x_b$</span> and <span>$\Delta y_b$</span> denote the x and y-direction grid spacings of the basic grid centered on the central pressure node <span>$P&#39;_{pC}$</span>. Rearranging  <a href="#eq:continuity-discretized">Eq.</a> leads to the following equation with coefficients for unknowns <span>$v_{xL}$</span>, <span>$v_{xR}$</span>, <span>$v_{yU}$</span>, <span>$v_{yD}$</span> and the right-hand-side term <span>$R_c$</span>:</p><h6 id="eq:continuity-coeff"><a class="docs-heading-anchor" href="#eq:continuity-coeff">eq:continuity-coeff</a><a id="eq:continuity-coeff-1"></a><a class="docs-heading-anchor-permalink" href="#eq:continuity-coeff" title="Permalink"></a></h6><p class="math-container">\[\begin{split}
    \frac{f_P}{\Delta x_b}v_{xR}
    - \frac{f_P}{\Delta x_b}v_{xL}
    + \frac{f_P}{\Delta y_b}v_{yD}
    - \frac{f_P}{\Delta y_b}v_{yU}
    = 0
\end{split}\]</p><p><img src="../images/stencil_continuity.png" alt="Continuity Stencil"/></p><h5 id="fig:stencil-continuity"><a class="docs-heading-anchor" href="#fig:stencil-continuity">fig:stencil-continuity</a><a id="fig:stencil-continuity-1"></a><a class="docs-heading-anchor-permalink" href="#fig:stencil-continuity" title="Permalink"></a></h5><p><em>Stencil used to discretize the continuity equation to produce the finite  difference representation shown in equation <a href="#eq:continuity-discretized">Eq.</a>. This stencil is  used to generate an equation associated with the central pressure unknown <span>$P&#39;$</span> for the large system of equations with coefficients for unknowns <span>$v_{xL}$</span>, <span>$v_{xR}$</span>, <span>$v_{yU}$</span>, <span>$v_{yD}$</span>, <span>$P&#39;$</span> and the right-hand-side term as shown in equation <a href="#eq:continuity-coeff">Eq.</a>. See figure <a href="#fig:stencil-x-stokes">Fig.</a> for additional details.</em></p><p>The large matrix coordinates <span>$(i&#39;,j&#39;)$</span> of coefficients in equation  <a href="#eq:continuity-coeff">Eq.</a> are related to the global index <span>$I_{P}$</span> from  equation <a href="../grid_structure/#eq:global-indices-of-stokes-unknowns">Eq.</a> as follows:</p><h6 id="eq:continuity-matrix-indices"><a class="docs-heading-anchor" href="#eq:continuity-matrix-indices">eq:continuity-matrix-indices</a><a id="eq:continuity-matrix-indices-1"></a><a class="docs-heading-anchor-permalink" href="#eq:continuity-matrix-indices" title="Permalink"></a></h6><p class="math-container">\[\begin{split}
    v_{xL} \text{ : } &amp; (I_p \text{, } I_p - 2 - \Delta I_{v_{xR}})\\
    v_{xR} \text{ : } &amp; (I_p \text{, } I_p - 2)\\
    v_{xU} \text{ : } &amp; (I_p \text{, } I_p - 4)\\
    v_{yD} \text{ : } &amp; (I_p \text{, } I_p - 1)
\end{split}\]</p><h2 id="Sparse-Stokes-Matrix-Example"><a class="docs-heading-anchor" href="#Sparse-Stokes-Matrix-Example">Sparse Stokes Matrix Example</a><a id="Sparse-Stokes-Matrix-Example-1"></a><a class="docs-heading-anchor-permalink" href="#Sparse-Stokes-Matrix-Example" title="Permalink"></a></h2><p>Appling the stencils from <a href="#x-Stokes-Discretization">x-Stokes Discretization</a>, <a href="#y-Stokes-Discretization">y-Stokes Discretization</a> and <a href="#Continuity-Discretization">Continuity Discretization</a> for a small system leads to the system of equations shown in <a href="#fig:sparse-matrix-stokes">Fig.</a>.</p><table><tr><th style="text-align: right"></th><th style="text-align: right"></th><th style="text-align: right">0</th><th style="text-align: right">1</th><th style="text-align: right">2</th><th style="text-align: right">3</th><th style="text-align: right">4</th><th style="text-align: right">5</th><th style="text-align: right">6</th><th style="text-align: right">7</th><th style="text-align: right">8</th><th style="text-align: right">9</th><th style="text-align: right">10</th><th style="text-align: right">11</th><th style="text-align: right">12</th><th style="text-align: right">13</th><th style="text-align: right">14</th><th style="text-align: right">15</th><th style="text-align: right">16</th><th style="text-align: right">17</th><th style="text-align: right">18</th><th style="text-align: right">19</th><th style="text-align: right">20</th><th style="text-align: right">21</th><th style="text-align: right">22</th><th style="text-align: right">23</th><th style="text-align: right">24</th><th style="text-align: right">25</th><th style="text-align: right">26</th></tr><tr><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right">x</td><td style="text-align: right">y</td><td style="text-align: right">p</td><td style="text-align: right">x</td><td style="text-align: right">y</td><td style="text-align: right">p</td><td style="text-align: right">x</td><td style="text-align: right">y</td><td style="text-align: right">p</td><td style="text-align: right">x</td><td style="text-align: right">y</td><td style="text-align: right">p</td><td style="text-align: right">x</td><td style="text-align: right">y</td><td style="text-align: right">p</td><td style="text-align: right">x</td><td style="text-align: right">y</td><td style="text-align: right">p</td><td style="text-align: right">x</td><td style="text-align: right">y</td><td style="text-align: right">p</td><td style="text-align: right">x</td><td style="text-align: right">y</td><td style="text-align: right">p</td><td style="text-align: right">x</td><td style="text-align: right">y</td><td style="text-align: right">p</td></tr><tr><td style="text-align: right">0</td><td style="text-align: right">x</td><td style="text-align: right">C</td><td style="text-align: right">LL</td><td style="text-align: right">L</td><td style="text-align: right">D</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"><em>UR</em></td><td style="text-align: right"></td><td style="text-align: right">R</td><td style="text-align: right">LR</td><td style="text-align: right">R</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td></tr><tr><td style="text-align: right">1</td><td style="text-align: right">y</td><td style="text-align: right">UR</td><td style="text-align: right">C</td><td style="text-align: right">U</td><td style="text-align: right">LR</td><td style="text-align: right">D</td><td style="text-align: right">D</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right">R</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td></tr><tr><td style="text-align: right">2</td><td style="text-align: right">p</td><td style="text-align: right">R</td><td style="text-align: right">D</td><td style="text-align: right">1</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td></tr><tr><td style="text-align: right">3</td><td style="text-align: right">x</td><td style="text-align: right">U</td><td style="text-align: right">UL</td><td style="text-align: right"></td><td style="text-align: right">C</td><td style="text-align: right">LL</td><td style="text-align: right">L</td><td style="text-align: right">D</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right">UR</td><td style="text-align: right"></td><td style="text-align: right">R</td><td style="text-align: right">LR</td><td style="text-align: right">R</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td></tr><tr><td style="text-align: right">4</td><td style="text-align: right">y</td><td style="text-align: right"></td><td style="text-align: right">U</td><td style="text-align: right"></td><td style="text-align: right">UR</td><td style="text-align: right">C</td><td style="text-align: right">U</td><td style="text-align: right">LR</td><td style="text-align: right">D</td><td style="text-align: right">D</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right">R</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td></tr><tr><td style="text-align: right">5</td><td style="text-align: right">p</td><td style="text-align: right"></td><td style="text-align: right">U</td><td style="text-align: right"></td><td style="text-align: right">R</td><td style="text-align: right">D</td><td style="text-align: right">0</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td></tr><tr><td style="text-align: right">6</td><td style="text-align: right">x</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right">U</td><td style="text-align: right">UL</td><td style="text-align: right"></td><td style="text-align: right">C</td><td style="text-align: right"><em>LL</em></td><td style="text-align: right">L</td><td style="text-align: right">D</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right">UR</td><td style="text-align: right"></td><td style="text-align: right">R</td><td style="text-align: right"><em>LR</em></td><td style="text-align: right">R</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td></tr><tr><td style="text-align: right">7</td><td style="text-align: right">y</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right">1</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td></tr><tr><td style="text-align: right">8</td><td style="text-align: right">p</td><td style="text-align: right"><em>L</em></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right">U</td><td style="text-align: right"></td><td style="text-align: right">R</td><td style="text-align: right"><em>D</em></td><td style="text-align: right">0</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td></tr><tr><td style="text-align: right">9</td><td style="text-align: right">x</td><td style="text-align: right">L</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"><em>U</em></td><td style="text-align: right"><em>UL</em></td><td style="text-align: right"></td><td style="text-align: right">C</td><td style="text-align: right">LL</td><td style="text-align: right">L</td><td style="text-align: right">D</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"><em>UR</em></td><td style="text-align: right"></td><td style="text-align: right">R</td><td style="text-align: right">LR</td><td style="text-align: right">R</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td></tr><tr><td style="text-align: right">10</td><td style="text-align: right">y</td><td style="text-align: right">UL</td><td style="text-align: right">L</td><td style="text-align: right"></td><td style="text-align: right">LL</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"><em>U</em></td><td style="text-align: right"></td><td style="text-align: right">UR</td><td style="text-align: right">C</td><td style="text-align: right">U</td><td style="text-align: right">LR</td><td style="text-align: right">D</td><td style="text-align: right">D</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right">R</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td></tr><tr><td style="text-align: right">11</td><td style="text-align: right">p</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right">L</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"><em>U</em></td><td style="text-align: right"></td><td style="text-align: right">R</td><td style="text-align: right">D</td><td style="text-align: right">0</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td></tr><tr><td style="text-align: right">12</td><td style="text-align: right">x</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right">L</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right">U</td><td style="text-align: right">UL</td><td style="text-align: right"></td><td style="text-align: right">C</td><td style="text-align: right">LL</td><td style="text-align: right">L</td><td style="text-align: right">D</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right">UR</td><td style="text-align: right"></td><td style="text-align: right"><em>R</em></td><td style="text-align: right">LR</td><td style="text-align: right">R</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td></tr><tr><td style="text-align: right">13</td><td style="text-align: right">y</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right">UL</td><td style="text-align: right">L</td><td style="text-align: right"></td><td style="text-align: right">LL</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right">U</td><td style="text-align: right"></td><td style="text-align: right">UR</td><td style="text-align: right">C</td><td style="text-align: right">U</td><td style="text-align: right">LR</td><td style="text-align: right"><em>D</em></td><td style="text-align: right">D</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right">R</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td></tr><tr><td style="text-align: right">14</td><td style="text-align: right">p</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right">L</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right">U</td><td style="text-align: right"></td><td style="text-align: right">R</td><td style="text-align: right">D</td><td style="text-align: right">0</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td></tr><tr><td style="text-align: right">15</td><td style="text-align: right">x</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"><em>L</em></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right">U</td><td style="text-align: right">UL</td><td style="text-align: right"></td><td style="text-align: right">C</td><td style="text-align: right"><em>LL</em></td><td style="text-align: right">L</td><td style="text-align: right">D</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right">UR</td><td style="text-align: right"></td><td style="text-align: right"><em>R</em></td><td style="text-align: right"><em>LR</em></td><td style="text-align: right">R</td></tr><tr><td style="text-align: right">16</td><td style="text-align: right">y</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right">1</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td></tr><tr><td style="text-align: right">17</td><td style="text-align: right">p</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"><em>L</em></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right">U</td><td style="text-align: right"></td><td style="text-align: right">R</td><td style="text-align: right">D</td><td style="text-align: right">0</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td></tr><tr><td style="text-align: right">18</td><td style="text-align: right">x</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right">1</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td></tr><tr><td style="text-align: right">19</td><td style="text-align: right">y</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right">UL</td><td style="text-align: right">L</td><td style="text-align: right"></td><td style="text-align: right">LL</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"><em>U</em></td><td style="text-align: right"></td><td style="text-align: right"><em>UR</em></td><td style="text-align: right">C</td><td style="text-align: right">U</td><td style="text-align: right"><em>LR</em></td><td style="text-align: right">D</td><td style="text-align: right">D</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td></tr><tr><td style="text-align: right">20</td><td style="text-align: right">p</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right">L</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"><em>U</em></td><td style="text-align: right"></td><td style="text-align: right"><em>R</em></td><td style="text-align: right">D</td><td style="text-align: right">0</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td></tr><tr><td style="text-align: right">21</td><td style="text-align: right">x</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right">1</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td></tr><tr><td style="text-align: right">22</td><td style="text-align: right">y</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right">UL</td><td style="text-align: right">L</td><td style="text-align: right"></td><td style="text-align: right">LL</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right">U</td><td style="text-align: right"></td><td style="text-align: right"><em>UR</em></td><td style="text-align: right">C</td><td style="text-align: right">U</td><td style="text-align: right">LR</td><td style="text-align: right"><em>D</em></td><td style="text-align: right">D</td></tr><tr><td style="text-align: right">23</td><td style="text-align: right">p</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right">L</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right">U</td><td style="text-align: right"></td><td style="text-align: right"><em>R</em></td><td style="text-align: right">D</td><td style="text-align: right">0</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td></tr><tr><td style="text-align: right">24</td><td style="text-align: right">x</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right">1</td><td style="text-align: right"></td><td style="text-align: right"></td></tr><tr><td style="text-align: right">25</td><td style="text-align: right">y</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right">1</td><td style="text-align: right"></td></tr><tr><td style="text-align: right">26</td><td style="text-align: right">p</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right">L</td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right"></td><td style="text-align: right">U</td><td style="text-align: right"></td><td style="text-align: right"><em>R</em></td><td style="text-align: right"><em>D</em></td><td style="text-align: right">0</td></tr></table><h5 id="fig:sparse-matrix-stokes"><a class="docs-heading-anchor" href="#fig:sparse-matrix-stokes">fig:sparse-matrix-stokes</a><a id="fig:sparse-matrix-stokes-1"></a><a class="docs-heading-anchor-permalink" href="#fig:sparse-matrix-stokes" title="Permalink"></a></h5><p><em>Sparse matrix for discretized Stokes-continuity equations where <span>$N_{x,b} = N_{y,b} = 4$</span>.  For this case <span>$\Delta I_{v_{xR}}$</span> is equal to 9. Unknowns for <span>$v_x$</span>, <span>$v_y$</span> and <span>$P&#39;$</span> are  denoted along the horizontal and vertical matrix axes as x, y, and p, respectively. The associated  stencil is applied to each row of the matrix where the x-Stokes stencil is applied to rows labeled  as x, the y-Stokes stencil is applied to rows labeled as y, and the continuity stencil is applied  to rows labeled as p. Coefficients for unknowns associated with the equation generated from a given  stencil are applied to the appropriate column of the matrix. Locations of unknowns relative to a  main central node denoted by C are denoted as U, D, L, R, UL, UR, LL, LR which represent up, down,  left, right, upper-left, upper-right, lower-left, and lower-right, respectively. Coefficients with  italic font are equal to zero since the product of the prescribed unknown and associated coefficient  from the x-stokes-coeff equation is moved to the right-hand-side term. Central main nodes  associated with a given stencil with coefficients not equal to 0 or 1 are denoted as C.  Matrix values equal one in the central node location are associated with prescribed boundary  unknowns. Zeros along the diagonal represent pressure coefficients that are equal to zero since  pressure does not appear in the incompressible continuity equation. Blank spaces are zero-value  coefficients for non-diagonal unknowns. Note that the central pressure node <span>$P&#39;$</span> has one non-zero  coefficient equal to 1 at matrix location <span>$(2,2)$</span> where the pressure boundary condition is  applied.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../marker_distribution/">« Marker Distribution</a><a class="docs-footer-nextpage" href="../conduction/">Discretization of Heat-conduction Equation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.0 on <span class="colophon-date" title="Saturday 22 November 2025 09:28">Saturday 22 November 2025</span>. Using Julia version 1.12.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
