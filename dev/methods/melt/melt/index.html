<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Melt · EarthBox.jl</title><meta name="title" content="Melt · EarthBox.jl"/><meta property="og:title" content="Melt · EarthBox.jl"/><meta property="twitter:title" content="Melt · EarthBox.jl"/><meta name="description" content="Documentation for EarthBox.jl."/><meta property="og:description" content="Documentation for EarthBox.jl."/><meta property="twitter:description" content="Documentation for EarthBox.jl."/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/custom.css" rel="stylesheet" type="text/css"/><script src="../../../assets/equation-refs.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../"><img src="../../../assets/logo.png" alt="EarthBox.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">EarthBox.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../">Introduction</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox"/><label class="tocitem" for="menuitem-2"><span class="docs-label">Installation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../installation/installation/">Installation</a></li><li><a class="tocitem" href="../../../installation/MPI_system/">Using System MPI Binaries</a></li><li><a class="tocitem" href="../../../installation/MUMPS_custom/">Using Custom MUMPS Libraries</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Models</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-3-1" type="checkbox"/><label class="tocitem" for="menuitem-3-1"><span class="docs-label">Model Management with the EarthBox API</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../models/model_execution/api_building_and_execution/">Model Building, Execution and Plotting</a></li><li><a class="tocitem" href="../../../models/model_execution/input_file_execution/">Using Input Files</a></li><li><a class="tocitem" href="../../../models/model_execution/background_command_line_execution/">Background Command-line Execution</a></li><li><a class="tocitem" href="../../../models/model_execution/remote_execution/">Batch Remote Execution</a></li><li><a class="tocitem" href="../../../models/model_execution/batch_local_execution/">Batch Local Execution</a></li><li><a class="tocitem" href="../../../models/model_execution/parallel_marker_plotting/">Plotting Marker Swarms in Parallel</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">Models</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../models/model_list/">Model List</a></li><li><a class="tocitem" href="../../../models/lithospheric_extension/polyphase_extension_n17/">Polyphase Extension n17</a></li><li><a class="tocitem" href="../../../models/lithospheric_extension/extension_weak_fault/">Extension with Weak Fault</a></li><li><a class="tocitem" href="../../../models/lithospheric_extension/extension_with_softening_b14/">Extension with Softening b14</a></li><li><a class="tocitem" href="../../../models/sdr_formation/sdr_formation/">SDR Formation</a></li><li><a class="tocitem" href="../../../models/vep_extension_downhill_diffusion/vep_extension_downhill_diffusion/">Visco-elasto-plastic Extension with Downhill Diffusion</a></li><li><a class="tocitem" href="../../../models/subduction/slab_retreat/">Slab Retreat</a></li><li><a class="tocitem" href="../../../models/sandbox/sandbox_extension/">Sandbox Extension</a></li><li><a class="tocitem" href="../../../models/sandbox/sandbox_shortening/">Sandbox Shortening</a></li><li><a class="tocitem" href="../../../models/spreading_center/spreading_center/">Spreading Center</a></li><li><a class="tocitem" href="../../../models/hot_box_melting/hot_box_melting/">Hot Box Melting</a></li><li><a class="tocitem" href="../../../models/regional/catl/">Magmatic Crust Formation: Central Atlantic</a></li><li><a class="tocitem" href="../../../models/regional/iberia/">Magma Poor Margin: Iberia</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox" checked/><label class="tocitem" for="menuitem-4"><span class="docs-label">Methods</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../introduction/">Introduction</a></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">Governing Equations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../governing_equations/momentum_and_mass/">Conservation of Momentum and Mass</a></li><li><a class="tocitem" href="../../governing_equations/energy/">Conservation of Energy</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-3" type="checkbox"/><label class="tocitem" for="menuitem-4-3"><span class="docs-label">Discretization</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../discretization/grid_structure/">Staggered Grid Structure</a></li><li><a class="tocitem" href="../../discretization/grid_generation/">Staggered Grid Generation</a></li><li><a class="tocitem" href="../../discretization/marker_distribution/">Marker Distribution</a></li><li><a class="tocitem" href="../../discretization/stokes2D/">Discretization of the 2D Stokes-continuity Equations</a></li><li><a class="tocitem" href="../../discretization/conduction/">Discretization of Heat-conduction Equation</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-4" type="checkbox"/><label class="tocitem" for="menuitem-4-4"><span class="docs-label">Boundary Conditions</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../discretization/stokes_bcs/">Stokes Boundary Conditions</a></li><li><a class="tocitem" href="../../discretization/heat_bcs/">Heat Boundary Conditions</a></li></ul></li><li><a class="tocitem" href="../../interpolation/marker_grid_interpolation/">Marker-Grid Interpolation</a></li><li><a class="tocitem" href="../../stokes_algorithm/stokes_algorithm/">Stokes-Continuity Algorithm</a></li><li><a class="tocitem" href="../../heat_algorithm/heat_algorithm/">Heat Algorithm</a></li><li><a class="tocitem" href="../../sediment_transport/sediment_transport/">Sediment Transport</a></li><li class="is-active"><a class="tocitem" href>Melt</a></li><li><a class="tocitem" href="../../lava_flow/lava_flow/">Lava Flow</a></li><li><a class="tocitem" href="../../viscous_creep/viscous_creep/">Viscous Creep</a></li><li><a class="tocitem" href="../../strain_weakening/strain_weakening/">Strain Weakening</a></li><li><a class="tocitem" href="../../hydrothermal/hydrothermal/">Hydrothermal Circulation</a></li><li><a class="tocitem" href="../../serpentinization/serpentinization/">Serpentinization</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Thermo-mechanical Algorithm</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/main_steps/">Main Steps</a></li><li><input class="collapse-toggle" id="menuitem-5-2" type="checkbox"/><label class="tocitem" for="menuitem-5-2"><span class="docs-label">Pre-solver Steps</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/pre_solver_steps/pre_solver_steps/">Pre-solver Steps</a></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/pre_solver_steps/sections/rock_property_update/">Rock Property Update Steps</a></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/pre_solver_steps/sections/latent_heat_update/">Latent Heat Update Steps</a></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/pre_solver_steps/sections/hydrothermal_update/">Hydrothermal Update Steps</a></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/pre_solver_steps/sections/marker_failure_prop_update/">Marker Failure Properties Update Steps</a></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/pre_solver_steps/sections/marker_viscosity_update/">Marker Creep Viscosity Update Steps</a></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/pre_solver_steps/sections/melt_damage_update/">Melt Damage Update Steps</a></li></ul></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/stokes_solver_steps/stokes_solver_steps/">Stokes-solver Steps</a></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/heat_solver_steps/heat_solver_steps/">Heat-solver Steps</a></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/advection_solver_steps/advection_solver_steps/">Advection-solver Steps</a></li><li><input class="collapse-toggle" id="menuitem-5-6" type="checkbox"/><label class="tocitem" for="menuitem-5-6"><span class="docs-label">Post-solver Steps</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/post_solver_steps/post_solver_steps/">Post-solver Steps</a></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/post_solver_steps/sections/topography/">Topography</a></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/post_solver_steps/sections/melt_extraction/">Melt Extraction</a></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/post_solver_steps/sections/sediment_transport/">Sediment Transport</a></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/post_solver_steps/sections/lava_flow/">Lava Flow</a></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/post_solver_steps/sections/marker_transformation/">Marker Transformation</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">EarthBox API</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/earthbox_api/">API Overview</a></li><li><a class="tocitem" href="../../../api/earthbox_state/earthbox_state/">EarthBoxState</a></li><li><input class="collapse-toggle" id="menuitem-6-3" type="checkbox"/><label class="tocitem" for="menuitem-6-3"><span class="docs-label">Model Management</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/model_manager/model_manager/">ModelManager</a></li><li><a class="tocitem" href="../../../api/model_manager/xdmf/xdmf_timestep_manager/">XdmfTimeStepsManager</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-4" type="checkbox"/><label class="tocitem" for="menuitem-6-4"><span class="docs-label">Staggered Grid</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/staggered_grid/initialization/">Initialization</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-5" type="checkbox"/><label class="tocitem" for="menuitem-6-5"><span class="docs-label">Material Geometry</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/material_geometry/sticky_air_geometry/">StickyAirGeometry</a></li><li><a class="tocitem" href="../../../api/material_geometry/earth_layering/">EarthLayering</a></li><li><a class="tocitem" href="../../../api/material_geometry/litho_strong_zones/">LithoStrongZones</a></li><li><a class="tocitem" href="../../../api/material_geometry/plume/">Plume</a></li><li><a class="tocitem" href="../../../api/material_geometry/crustal_hole/">CrustalHole</a></li><li><a class="tocitem" href="../../../api/material_geometry/rayleigh_taylor/">RayleighTaylor</a></li><li><a class="tocitem" href="../../../api/material_geometry/mobile_wall/">MobileWall</a></li><li><a class="tocitem" href="../../../api/material_geometry/sandbox/">Sandbox</a></li><li><a class="tocitem" href="../../../api/material_geometry/internal_velocity_zone/">InternalVelocityZone</a></li><li><a class="tocitem" href="../../../api/material_geometry/fracture_zone/">FractureZone</a></li><li><a class="tocitem" href="../../../api/material_geometry/weak_fault/">WeakFault</a></li><li><a class="tocitem" href="../../../api/material_geometry/weak_seed/">WeakSeed</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-6" type="checkbox"/><label class="tocitem" for="menuitem-6-6"><span class="docs-label">Boundary Conditions</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/boundary_conditions/boundary_conditions/">Initialization</a></li><li><a class="tocitem" href="../../../api/boundary_conditions/bc_managers/pressure/">Pressure</a></li><li><a class="tocitem" href="../../../api/boundary_conditions/bc_managers/temperature/">Temperature</a></li><li><a class="tocitem" href="../../../api/boundary_conditions/bc_managers/transient_bottom_temperature/">TransientBottomTemperature</a></li><li><a class="tocitem" href="../../../api/boundary_conditions/bc_managers/velocity/">Velocity</a></li><li><a class="tocitem" href="../../../api/boundary_conditions/bc_managers/velocity_from_strain_rate/">VelocityFromStrainRate</a></li><li><a class="tocitem" href="../../../api/boundary_conditions/bc_managers/velocity_stop/">VelocityStop</a></li><li><a class="tocitem" href="../../../api/boundary_conditions/bc_managers/velocity_step/">VelocityStep</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-7" type="checkbox"/><label class="tocitem" for="menuitem-6-7"><span class="docs-label">Marker Initialization</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/markers/coordinates/">MarkerCoordinates</a></li><li><a class="tocitem" href="../../../api/markers/temperature/">MarkerTemperature</a></li><li><a class="tocitem" href="../../../api/markers/friction/">MarkerFriction</a></li><li><a class="tocitem" href="../../../api/markers/cohesion/">MarkerCohesion</a></li><li><a class="tocitem" href="../../../api/markers/dilatancy/">MarkerDilatancy</a></li><li><a class="tocitem" href="../../../api/markers/viscous_strain_softening/">MarkerViscousStrainSoftening</a></li><li><a class="tocitem" href="../../../api/markers/preexponential/">MarkerPreexponential</a></li><li><a class="tocitem" href="../../../api/markers/stress_limits/">MarkerStressLimits</a></li><li><a class="tocitem" href="../../../api/markers/boundary_friction/">MarkerBoundaryFriction</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-8" type="checkbox"/><label class="tocitem" for="menuitem-6-8"><span class="docs-label">Marker Materials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/marker_materials/materials/">MarkerMaterials</a></li><li><a class="tocitem" href="../../../api/marker_materials/material_collection_files/">Material Collection Files</a></li><li><a class="tocitem" href="../../../api/marker_materials/material_properties/">Material Properties</a></li><li><a class="tocitem" href="../../../api/marker_materials/material_input/">Material Input</a></li><li><a class="tocitem" href="../../../api/marker_materials/material_types/">Material Types</a></li><li><a class="tocitem" href="../../../api/marker_materials/material_domains/">Material Domains</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-9" type="checkbox"/><label class="tocitem" for="menuitem-6-9"><span class="docs-label">Rock Properties</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/rock_properties/rock_properties/">RockProperties</a></li><li><a class="tocitem" href="../../../api/rock_properties/hydrothermal/hydrothermal/">Hydrothermal Circulation</a></li><li><a class="tocitem" href="../../../api/rock_properties/serpentinization/serpentinization/">Serpentinization</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-10" type="checkbox"/><label class="tocitem" for="menuitem-6-10"><span class="docs-label">Stokes Continuity Solver</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/stokes_continuity_solver/stokes_continuity_solver/">StokesContinuitySolver</a></li><li><a class="tocitem" href="../../../api/stokes_continuity_solver/global_plasticity_loop/">GlobalPlasticityLoop</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-11" type="checkbox"/><label class="tocitem" for="menuitem-6-11"><span class="docs-label">Heat Solver</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/heat_solver/heat_solver/">HeatSolver</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-12" type="checkbox"/><label class="tocitem" for="menuitem-6-12"><span class="docs-label">Marker Advection</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/advection/advection/">Advection</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-13" type="checkbox"/><label class="tocitem" for="menuitem-6-13"><span class="docs-label">Interpolation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/interpolation/interpolation/">Interpolation</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-14" type="checkbox"/><label class="tocitem" for="menuitem-6-14"><span class="docs-label">Melt Model</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/melt_model/melt_model/">MeltModel</a></li><li><a class="tocitem" href="../../../api/melt_model/melt_extraction/">MeltExtraction</a></li><li><a class="tocitem" href="../../../api/melt_model/melt_extrusion/">MeltExtrusion</a></li><li><a class="tocitem" href="../../../api/melt_model/melt_damage/">MeltDamage</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-15" type="checkbox"/><label class="tocitem" for="menuitem-6-15"><span class="docs-label">Surface Processes</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/surface_processes/topography/">Topography</a></li><li><a class="tocitem" href="../../../api/surface_processes/sealevel/">Sealevel</a></li><li><a class="tocitem" href="../../../api/surface_processes/relative_base_level/">RelativeBaseLevel</a></li><li><a class="tocitem" href="../../../api/surface_processes/sediment_transport/">SedimentTransport</a></li><li><a class="tocitem" href="../../../api/surface_processes/salt/">SaltDeposition</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-16" type="checkbox"/><label class="tocitem" for="menuitem-6-16"><span class="docs-label">Time Step Execution and Initialization</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/run_time_steps/run_time_steps/">Execution</a></li><li><a class="tocitem" href="../../../api/run_time_steps/time_Step_initialization/">Initialization</a></li><li><a class="tocitem" href="../../../api/run_time_steps/examples/">Examples</a></li></ul></li><li><a class="tocitem" href="../../../api/command_line_args/command_line_args/">Command-line Arguments</a></li><li><a class="tocitem" href="../../../api/case_management/case_management/">Case Management</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox"/><label class="tocitem" for="menuitem-7"><span class="docs-label">Material Library</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../material_library/material_library/">MaterialLibrary</a></li><li><a class="tocitem" href="../../../material_library/collections/lithospheric_deformation_eb1/">Collection: Lithospheric Deformation eb1</a></li><li><a class="tocitem" href="../../../material_library/collections/benchmarks/">Collection: Benchmarks</a></li><li><a class="tocitem" href="../../../material_library/collections/benchmarks_sfs/">Collection: Benchmarks SFS</a></li><li><a class="tocitem" href="../../../material_library/collections/sandbox/">Collection: Sandbox</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8" type="checkbox"/><label class="tocitem" for="menuitem-8"><span class="docs-label">Plot Tools</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../plot_tools/cl_plotter/">Command-line Plotter</a></li><li><a class="tocitem" href="../../../plot_tools/scalar_grid_plots/">Scalar Grid Plots</a></li><li><a class="tocitem" href="../../../plot_tools/vector_plots/">Velocity Vector Plots</a></li><li><a class="tocitem" href="../../../plot_tools/marker_plots/">Marker Swarm Plots</a></li><li><a class="tocitem" href="../../../plot_tools/yield_strength_plots/">Yield Strength Plots</a></li><li><a class="tocitem" href="../../../plot_tools/stokes_convergence_plots/">Stokes Convergence Plots</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-9" type="checkbox"/><label class="tocitem" for="menuitem-9"><span class="docs-label">Data Types</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../data_types/data_types/">Data Types</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-10" type="checkbox"/><label class="tocitem" for="menuitem-10"><span class="docs-label">Model Data</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../model_data/model_data/">ModelData</a></li><li><input class="collapse-toggle" id="menuitem-10-2" type="checkbox"/><label class="tocitem" for="menuitem-10-2"><span class="docs-label">Collections</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../model_data/collections/benchmarks/">Benchmarks</a></li><li><a class="tocitem" href="../../../model_data/collections/bcs/">BoundaryConditions</a></li><li><a class="tocitem" href="../../../model_data/collections/carbonate/">Carbonate</a></li><li><a class="tocitem" href="../../../model_data/collections/conversion/">Conversion</a></li><li><a class="tocitem" href="../../../model_data/collections/geometry/">Geometry</a></li><li><a class="tocitem" href="../../../model_data/collections/gravity/">Gravity</a></li><li><a class="tocitem" href="../../../model_data/collections/grids/">Grids</a></li><li><a class="tocitem" href="../../../model_data/collections/heat_equation/">HeatEquation</a></li><li><a class="tocitem" href="../../../model_data/collections/interpolation/">Interpolation</a></li><li><a class="tocitem" href="../../../model_data/collections/markers/">Markers</a></li><li><a class="tocitem" href="../../../model_data/collections/materials/">Materials</a></li><li><a class="tocitem" href="../../../model_data/collections/melting/">Melting</a></li><li><a class="tocitem" href="../../../model_data/collections/stokes_continuity/">StokesContinuity</a></li><li><a class="tocitem" href="../../../model_data/collections/timestep/">Timestep</a></li><li><a class="tocitem" href="../../../model_data/collections/topography/">Topography</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-11" type="checkbox"/><label class="tocitem" for="menuitem-11"><span class="docs-label">Units</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../units/units/">Units</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-12" type="checkbox"/><label class="tocitem" for="menuitem-12"><span class="docs-label">Benchmarks</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../benchmarks/benchmarks/">Benchmarks</a></li><li><a class="tocitem" href="../../../benchmarks/single_execution/">Single Execution</a></li><li><a class="tocitem" href="../../../benchmarks/batch_execution/">Batch Execution</a></li><li><input class="collapse-toggle" id="menuitem-12-4" type="checkbox"/><label class="tocitem" for="menuitem-12-4"><span class="docs-label">Results</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../benchmarks/models/couette_flow_viscous_heating/">Couette Flow with Viscous Heating</a></li><li><a class="tocitem" href="../../../benchmarks/models/channel_flow_variable_conductivity/">Channel Flow Variable Conductivity</a></li><li><a class="tocitem" href="../../../benchmarks/models/channel_flow_non_steady_temperature/">Channel Flow Non Steady Temperature</a></li><li><a class="tocitem" href="../../../benchmarks/models/channel_flow_non_newtonian/">Channel Flow Non Newtonian</a></li><li><a class="tocitem" href="../../../benchmarks/models/solid_body_rotation/">Solid Body Rotation</a></li><li><a class="tocitem" href="../../../benchmarks/models/rayleigh_taylor_instability/">Rayleigh Taylor Instability</a></li><li><a class="tocitem" href="../../../benchmarks/models/elastic_slab/">Elastic Slab</a></li><li><a class="tocitem" href="../../../benchmarks/models/viscoelastic_stress_buildup/">Viscoelastic Stress Buildup</a></li><li><a class="tocitem" href="../../../benchmarks/models/box_convection_isoviscous_1a/">Box Convection Isoviscous 1a</a></li><li><a class="tocitem" href="../../../benchmarks/models/plasticity_benchmark_kaus10/">Plasticity Benchmark Kaus10</a></li><li><a class="tocitem" href="../../../benchmarks/models/seafloor_spreading/">Seafloor Spreading</a></li><li><a class="tocitem" href="../../../benchmarks/models/flexure_triangular_hole/">Flexure Triangular Hole</a></li><li><a class="tocitem" href="../../../benchmarks/models/viscoelastic_extension/">Viscoelastic Extension</a></li><li><a class="tocitem" href="../../../benchmarks/models/viscoelastic_contraction/">Viscoelastic Contraction</a></li><li><a class="tocitem" href="../../../benchmarks/models/simple_sedimentation/">Simple Sedimentation</a></li></ul></li></ul></li><li><a class="tocitem" href="../../../bibliography/bibliography/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Methods</a></li><li class="is-active"><a href>Melt</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Melt</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/eakneller/EarthBox.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Melt-generation,-Transport-and-Emplacement"><a class="docs-heading-anchor" href="#Melt-generation,-Transport-and-Emplacement">Melt generation, Transport and Emplacement</a><a id="Melt-generation,-Transport-and-Emplacement-1"></a><a class="docs-heading-anchor-permalink" href="#Melt-generation,-Transport-and-Emplacement" title="Permalink"></a></h1><p>The models presented in this work use a linearized equilibrium melt fraction model based on the  following equation:</p><h6 id="eq:melt-fraction"><a class="docs-heading-anchor" href="#eq:melt-fraction">eq:melt-fraction</a><a id="eq:melt-fraction-1"></a><a class="docs-heading-anchor-permalink" href="#eq:melt-fraction" title="Permalink"></a></h6><p class="math-container">\[M_m = \frac{T_m - T_{solidus,m}}{T_{liquidus,m} - T_{solidus,m}}\]</p><p>where <span>$m$</span> is the index of the marker, <span>$M_m$</span> is the melt fraction for the marker, <span>$T_m$</span> is the  temperature of the marker, <span>$T_{solidus,m}$</span> is the solidus temperature of the marker, and  <span>$T_{liquidus,m}$</span> is the liquidus temperature of the marker (<a href="../../../bibliography/bibliography/#gerya13">Gerya, 2013</a>). </p><p>The the solidus temperature of markers with ultramafic composition is defined for anhydrous  peridotite by the following equation:</p><h6 id="eq:solidus-mantle"><a class="docs-heading-anchor" href="#eq:solidus-mantle">eq:solidus-mantle</a><a id="eq:solidus-mantle-1"></a><a class="docs-heading-anchor-permalink" href="#eq:solidus-mantle" title="Permalink"></a></h6><p class="math-container">\[T_{solidus}^{mantle} =
\begin{cases}
    - 5.1(P_{GPa})^2 + 132.9P_{GPa} + 1085.7
        &amp; \text{for } P_{GPa} \leq 8 \text{ GPa }\\
    T_{solidus,K03}^{8GPa}
    + \frac{\left( T_{solidus20} - T_{solidus,K3}^{8GPa}\right)}{12}
        \left(P_{GPa} - 8\right)
            &amp; \text{for } P_{GPa} &gt; 8 \text{ GPa}
\end{cases}\]</p><p>where <span>$P_{GPa}$</span> is the pressure in GPa, <span>$T_{solidusK3}^{8GPa}$</span> is the solidus temperature in <span>$K$</span> at  8 GPa according to the model of <a href="../../../bibliography/bibliography/#katz03">Katz <em>et al.</em> (2003)</a>, and <span>$T_{solidus20}$</span> is the solidus temperature in <span>$K$</span> at 20 GPa set equal to 2250 <span>$K$</span>. Anhydrous peridotite is used as water is quickly removed from the  system during the early stages of melting. The liquidus temperature for ultramafic mantle markers is defined by the following equation for anhydrous peridotite:</p><h6 id="eq:liquidus-mantle"><a class="docs-heading-anchor" href="#eq:liquidus-mantle">eq:liquidus-mantle</a><a id="eq:liquidus-mantle-1"></a><a class="docs-heading-anchor-permalink" href="#eq:liquidus-mantle" title="Permalink"></a></h6><p class="math-container">\[T_{liquidus}^{mantle} =
\begin{cases}
    - 2(P_{GPa})^2 + 45.0P_{GPa} + 1780.0
        &amp; \text{for } P_{GPa} \leq 8 \text{ GPa }\\
    T_{liquidus,K3}^{8GPa}
    + \frac{\left( T_{liquidus20} - T_{liquidus,K03}^{8GPa}\right)}{12}
        \left(P_{GPa} - 8\right)
            &amp; \text{for } P_{GPa} &gt; 8 \text{ GPa}
\end{cases}\]</p><p>where <span>$T_{liquidusK3}^{8GPa}$</span> is the liquidus temperature in <span>$K$</span> at 8 GPa according to the model of <a href="../../../bibliography/bibliography/#katz03">Katz <em>et al.</em> (2003)</a>, and <span>$T_{liquidus20}$</span> is the liquidus temperature in <span>$K$</span> at 20 GPa set equal to 2600 <span>$K$</span>.</p><p>This study employs two distinct models to determine the solidus and liquidus temperatures for gabbro:  (1) a standard gabbro model representing the composition of primary melt products derived from the  mantle, and (2) a model for gabbroic materials that have experienced fractional crystallization  during emplacement. The solidus and liquidus temperatures for markers that have normal gabbro  composition are defined by the following equations (<a href="../../../bibliography/bibliography/#gerya2010">Gerya, 2010</a>):</p><h6 id="eq:solidus-liquidus-gabbro"><a class="docs-heading-anchor" href="#eq:solidus-liquidus-gabbro">eq:solidus-liquidus-gabbro</a><a id="eq:solidus-liquidus-gabbro-1"></a><a class="docs-heading-anchor-permalink" href="#eq:solidus-liquidus-gabbro" title="Permalink"></a></h6><p class="math-container">\[\begin{split}
    T_{solidus}^{gabbro} = 1327.0 + 91P_{GPa} \text{, }\\
    T_{liquidus}^{gabbro} = 1423 + 105P_{GPa}
\end{split}\]</p><p>The solidus and liquidus temperatures for fractionated gabbro are defined the following equations:</p><h6 id="eq:solidus-liquidus-fractionated-gabbro"><a class="docs-heading-anchor" href="#eq:solidus-liquidus-fractionated-gabbro">eq:solidus-liquidus-fractionated-gabbro</a><a id="eq:solidus-liquidus-fractionated-gabbro-1"></a><a class="docs-heading-anchor-permalink" href="#eq:solidus-liquidus-fractionated-gabbro" title="Permalink"></a></h6><p class="math-container">\[\begin{split}
    T_{solidus}^{frac} = T_{solidus}^{gabbro} + \Delta T_{solidus}^{frac}\\
    T_{liquidus}^{frac} = T_{liquidus}^{gabbro} + \Delta T_{liquidus}^{frac}
\end{split}\]</p><p>where <span>$\Delta T_{solidus}^{frac}$</span> and <span>$\Delta T_{liquidus}^{frac}$</span> are the temperature differences  between the solidus and liquidus temperatures for normal gabbro and fractionated gabbro, respectively.  We use the following values for fractionated shifts in solidus and liquidus temperatures based on the work of <a href="../../../bibliography/bibliography/#maclennan04">Maclennan <em>et al.</em> (2004)</a>: <span>$\Delta T_{solidus}^{frac} = 100$</span> <span>$K$</span> and  <span>$\Delta T_{liquidus}^{frac} = 300$</span> <span>$K$</span>. </p><p>Melt is assumed to migrate instantaneously to the top of the partially molten mantle domain and  then flow horizontally toward local high points. At the local maximum, melt is  divided into two fractions: one that is immediately emplaced at the base of the crust and another that  is transported to the surface. This simplified model of melt transport and emplacement is implemented  independently within each melt drainage basin bounded by local minima along the top of the partially  molten domain.</p><p>The extractable melt fraction for a marker <span>$m$</span> is defined by the following  equation:</p><h6 id="eq:extractable-melt-fraction"><a class="docs-heading-anchor" href="#eq:extractable-melt-fraction">eq:extractable-melt-fraction</a><a id="eq:extractable-melt-fraction-1"></a><a class="docs-heading-anchor-permalink" href="#eq:extractable-melt-fraction" title="Permalink"></a></h6><p class="math-container">\[M_{extractable,m} = M_{m} - M_{extracted,m}^o\]</p><p>where <span>$M_{m}$</span> is the total melt fraction for the marker as described in <a href="#eq:melt-fraction">Eq.</a> and  <span>$M_{extracted,m}^o$</span> is the melt fraction already extracted. The extracted melt fraction updated using:</p><h6 id="eq:extracted-melt-fraction"><a class="docs-heading-anchor" href="#eq:extracted-melt-fraction">eq:extracted-melt-fraction</a><a id="eq:extracted-melt-fraction-1"></a><a class="docs-heading-anchor-permalink" href="#eq:extracted-melt-fraction" title="Permalink"></a></h6><p class="math-container">\[M_{extracted,m} = M_{extracted,m}^o + M_{extractable,m}
    \quad \text{if} \quad M_m &gt; 0 \quad \text{and} \quad M_{extractable,m} &gt; 0\]</p><p>Marker density <span>$\rho_m$</span> is impacted by melting by depleting the rock matrix and through the presence of melt in the pore space. The impact of depletion is modeled using the approach of <a href="../../../bibliography/bibliography/#theunissen22">Theunissen <em>et al.</em> (2022)</a>  as described in following equation:</p><h6 id="eq:density-melt-depletion"><a class="docs-heading-anchor" href="#eq:density-melt-depletion">eq:density-melt-depletion</a><a id="eq:density-melt-depletion-1"></a><a class="docs-heading-anchor-permalink" href="#eq:density-melt-depletion" title="Permalink"></a></h6><p class="math-container">\[\rho_{m} = 
\begin{cases}
    \rho_m^o - 3.8 M_{extracted,m} 100
        &amp; \text{if } M_{extracted,m} &lt; 0.075 \\
    \rho_m^o - \left(24.84 + 0.488M_{extracted,m}100\right)
        &amp; \text{if } M_{extracted,m} \geq 0.075 \\
\end{cases}\]</p><p>where <span>$\rho_m^o$</span> is the density of the marker prior to the update step. The effect of melt in pore  space on density modeled using the following equation:</p><h6 id="eq:density-melt-pore-space"><a class="docs-heading-anchor" href="#eq:density-melt-pore-space">eq:density-melt-pore-space</a><a id="eq:density-melt-pore-space-1"></a><a class="docs-heading-anchor-permalink" href="#eq:density-melt-pore-space" title="Permalink"></a></h6><p class="math-container">\[\begin{split}
    \rho_{melt} = \rho_{ref,melt} + f_{eos}P_{Pa} \text{, }\\
    \rho_m = \rho_m^o(1 - M_{extractable,m}) + \rho_{melt} M_{extractable,m}
\end{split}\]</p><p>where <span>$\rho_m^o$</span> is the density of the marker prior to this update step, <span>$\rho_{ref,melt}$</span> is the  reference density of the melt set equal to 2750 <span>$\frac{kg}{m^3}$</span>, <span>$P_{Pa,m}$</span> is the pressure in <span>$Pa$</span>  and <span>$f_{eos}$</span> is the linearized derivative of melt density with respect to pressure equal to  <span>$8.97\cdot10^{-8} \frac{kg}{m^3Pa}$</span> derived from the Birch-Murnagham equation-of-state for anhydrous  basaltic melt using <span>$K_{to} = 20.8$</span> and <span>$K_{tp} = 4.6$</span> (<a href="../../../bibliography/bibliography/#lesher15">Lesher and Spera, 2015</a>; <a href="../../../bibliography/bibliography/#stopler81">Stolper <em>et al.</em>, 1981</a>).</p><p>The total number of magma markers in drainage basin <span>$k$</span> if all extractable melt  were consolidated into a single body is calculated as:</p><h6 id="eq:total-magma-markers"><a class="docs-heading-anchor" href="#eq:total-magma-markers">eq:total-magma-markers</a><a id="eq:total-magma-markers-1"></a><a class="docs-heading-anchor-permalink" href="#eq:total-magma-markers" title="Permalink"></a></h6><p class="math-container">\[N_{magma,tot,k}
    = f_{extraction}
        \left( \displaystyle \sum_{m=0}^{N_{marker}} M_{extractable,m} 
            + R_{melt,k}^o
        \right)\]</p><p>subject to the conditions:</p><p class="math-container">\[M_m &gt; 0 \text{, } \quad M_{extractable,m} &gt; 0 \quad \text{and} \quad
x_{divide,k} &lt; x_m &lt; x_{divide(k+1)}\]</p><p>where <span>$f_{extraction}$</span> is the extraction efficiency, <span>$R_{melt,k}^o$</span> is the residual  melt from the previous time step, <span>$x_{divide,k}$</span> and <span>$x_{divide(k+1)}$</span> are the x-coordinates of the  left and right drainage divides for drainage basin <span>$k$</span>, respectively, <span>$x_m$</span> is the x-coordinate of  the marker. For the experiments presented in this work <span>$f_{extraction} = 0.99$</span> to account for a small amount of melt retained in the mantle during transport. </p><p>The number of magma markers available for emplacement or extrusion in drainage basin <span>$k$</span> for a given  time step is:</p><h6 id="eq:available-magma-markers"><a class="docs-heading-anchor" href="#eq:available-magma-markers">eq:available-magma-markers</a><a id="eq:available-magma-markers-1"></a><a class="docs-heading-anchor-permalink" href="#eq:available-magma-markers" title="Permalink"></a></h6><p class="math-container">\[N_{magma,k} = int(N_{magma,tot,k})\]</p><p>and the residual component used in the next time step is updated as:</p><h6 id="eq:residual-melt"><a class="docs-heading-anchor" href="#eq:residual-melt">eq:residual-melt</a><a id="eq:residual-melt-1"></a><a class="docs-heading-anchor-permalink" href="#eq:residual-melt" title="Permalink"></a></h6><p class="math-container">\[R_{melt,k} = N_{magma,tot,k} - N_{magma,k} \text{.}\]</p><p>The total extractable magma volume in the drainage basic <span>$k$</span> is then:</p><h6 id="eq:total-extractable-magma-volume"><a class="docs-heading-anchor" href="#eq:total-extractable-magma-volume">eq:total-extractable-magma-volume</a><a id="eq:total-extractable-magma-volume-1"></a><a class="docs-heading-anchor-permalink" href="#eq:total-extractable-magma-volume" title="Permalink"></a></h6><p class="math-container">\[V_{magma,k} = N_{magma,k} \Delta x_m \Delta y_m\]</p><p>where <span>$\Delta x_m$</span> and <span>$\Delta y_m$</span> are the average widths of the markers in the x and y directions, respectively.</p><p>The height of new column of crust formed if <span>$V_{magma,k}$</span> is emplaced as a dike within a spreading  plate is:</p><h6 id="eq:char-magmatic-crust-height"><a class="docs-heading-anchor" href="#eq:char-magmatic-crust-height">eq:char-magmatic-crust-height</a><a id="eq:char-magmatic-crust-height-1"></a><a class="docs-heading-anchor-permalink" href="#eq:char-magmatic-crust-height" title="Permalink"></a></h6><p class="math-container">\[H_{mc,k}
    = \frac{V_{magma,k}}{v_{ext}\Delta t}\]</p><p>where <span>$v_{ext}$</span> is the full extension velocity and <span>$\Delta t$</span> is the model time step. This  characteristic magmatic crust height, <span>$H_{mc,k}$</span>, is used to as a proxy for the efficiency of melt transport to the surface.</p><p>The number of volcanic markers that are available for extrusion on the surface as lava flows above  drainage basin <span>$k$</span> is given by:</p><h6 id="eq:volcanic-markers"><a class="docs-heading-anchor" href="#eq:volcanic-markers">eq:volcanic-markers</a><a id="eq:volcanic-markers-1"></a><a class="docs-heading-anchor-permalink" href="#eq:volcanic-markers" title="Permalink"></a></h6><p class="math-container">\[N_{volcanic,k} = int(f_{v}N_{magma,k})\]</p><p>where <span>$f_{v}$</span> is the extrusion efficiency factor. We assume that the efficiency of melt transport to the surface correlates with the characteristic magmatic crust height <span>$H_{mc,k}$</span> as described by the following equation:</p><h6 id="eq:extrusion_efficiency"><a class="docs-heading-anchor" href="#eq:extrusion_efficiency">eq:extrusion_efficiency</a><a id="eq:extrusion_efficiency-1"></a><a class="docs-heading-anchor-permalink" href="#eq:extrusion_efficiency" title="Permalink"></a></h6><p class="math-container">\[f_{v} = 
    \begin{cases}
        f_{v,min}
            &amp; \quad \text{for} \quad H_{mc,k} \leq H_{mc,min}
                \quad \text{and} \\
        f_{v(max)}
            &amp; \quad \text{for} \quad H_{mc,k} \geq H_{mc,max}
                \quad \text{and} \\
        f_{v,min} + 
            \frac{(H_{mc,k} - H_{mc,min})}{\Delta H_{mc}}\Delta f_v
            &amp; \quad \text{for} \quad H_{mc,min} &lt; H_{mc,k} &lt; H_{mc,max}
    \end{cases}\]</p><p>where <span>$\Delta f_v$</span> is equal to <span>$f_{v,max} - f_{v,min}$</span> and <span>$\Delta H_{mc}$</span>  is equal to <span>$H_{mc,max} - H_{mc,min}$</span>. For this work, <span>$f_{v,min} = 0.03$</span>, <span>$H_{mc,min} = 6000 m$</span> and <span>$H_{mc,max} = 17500 m$</span>. Alternative scenarios for parameter <span>$f_{v(max)}$</span> are explored ranging from 0.1 to 0.5. The total volume of volcanic markers <span>$V_{vol,k}$</span> extruded on the surface for a given time step is:</p><h6 id="eq:volcanic-extrusion-volume"><a class="docs-heading-anchor" href="#eq:volcanic-extrusion-volume">eq:volcanic-extrusion-volume</a><a id="eq:volcanic-extrusion-volume-1"></a><a class="docs-heading-anchor-permalink" href="#eq:volcanic-extrusion-volume" title="Permalink"></a></h6><p class="math-container">\[V_{vol,k} = V_{vol,k}^o + N_{volcanic,k} \Delta x_m \Delta y_m \text{.}\]</p><p>where <span>$V_{vol,k}^o$</span> is the volume of material available for extrusion from previous model times  steps within the current eruption interval. The number of magma markers <span>$N_{magma,k}$</span> can be updated to account for volcanic material as follows:</p><h6 id="eq:magma-markers-final"><a class="docs-heading-anchor" href="#eq:magma-markers-final">eq:magma-markers-final</a><a id="eq:magma-markers-final-1"></a><a class="docs-heading-anchor-permalink" href="#eq:magma-markers-final" title="Permalink"></a></h6><p class="math-container">\[N_{magma,k} = N_{magma,k} - N_{volcanic,k} \text{.}\]</p><p>Therefore, the volume of magma markers from equation that are emplaced at the base of the crust is:</p><h6 id="eq:magma-volume-final"><a class="docs-heading-anchor" href="#eq:magma-volume-final">eq:magma-volume-final</a><a id="eq:magma-volume-final-1"></a><a class="docs-heading-anchor-permalink" href="#eq:magma-volume-final" title="Permalink"></a></h6><p class="math-container">\[V_{magma,k} = N_{magma,k} \Delta x_m \Delta y_m \text{.}\]</p><p>Gabbroic magma is injected at the base of the Moho within an injection zone of width <span>$W_{inj,k}$</span> that is centered on the local maximum of the partially molten domain of the mantle. The width of the magma  injection zone <span>$W_{inj,k}$</span> is calculated using the following equation:</p><h6 id="eq:injection-width"><a class="docs-heading-anchor" href="#eq:injection-width">eq:injection-width</a><a id="eq:injection-width-1"></a><a class="docs-heading-anchor-permalink" href="#eq:injection-width" title="Permalink"></a></h6><p class="math-container">\[W_{inj,k} = 
\begin{cases}
    \frac{V_{magma,k}}{H_{inj,limit}} &amp;
        \quad \text{for} \quad H_{inj} &gt; H_{inj,limit}\\
    W_{inj}^{char} &amp;
        \quad \text{for} \quad H_{inj} \leq H_{inj,limit}
\end{cases}\]</p><p>where <span>$W_{inj}^{char}$</span> is the characteristic injection width, <span>$H_{inj,limit}$</span> is the maximum injection height limit, and <span>$H_{inj}$</span> is the injection height defined by:</p><h6 id="eq:injection-height"><a class="docs-heading-anchor" href="#eq:injection-height">eq:injection-height</a><a id="eq:injection-height-1"></a><a class="docs-heading-anchor-permalink" href="#eq:injection-height" title="Permalink"></a></h6><p class="math-container">\[H_{inj} = \frac{V_{magma,k}}{W_{inj}^{char}} \text{.}\]</p><p>The injection zone is divided into subdomains that are selected using a normal probability  distribution centered on the local maximum of the partially molten domain of the mantle. The  injection of gabbroic magma is implemented by replacing the shallowest marker below the Moho within  a selected subdomain with a marker that has the composition of gabbroic magma and emplacement  temperature of 1200<span>$^{\circ}$</span>C. At the beginning of each time step, gabbroic magma markers that are within 2km of the Moho are converted into fractionated gabbroic magma markers. This  conversion accounts for the fractional crystallization that occurs during the emplacement of magma  in the crust, including processes such as dike and sill injection and the flow of crystal mush in  the so called gabbro glacier.</p><p>Markers undergo solidification based on their updated melt fraction <span>$M_m$</span>. The solidification process occurs as follows: </p><ol><li><p>Solidification is modeled by transforming purely molten markers that have  cooled below the liquidus temperature to a solid state.</p></li><li><p>Solid markers with temperatures between the solidus and liquidus temperatures are  transformed to a partially molten state.</p></li><li><p>Partially molten markers that have cooled below the solidus are transformed to  a solid state by updating.</p></li></ol><p>If the melt fraction <span>$M_m$</span> from <a href="#eq:melt-fraction">Eq.</a> falls below the extracted melt  fraction <span>$M_{extracted,m}$</span> from <a href="#eq:extractable-melt-fraction">Eq.</a> (i.e. <span>$M_{extractable} &lt; 0$</span>)  the marker is transformed into a refractory state.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../sediment_transport/sediment_transport/">« Sediment Transport</a><a class="docs-footer-nextpage" href="../../lava_flow/lava_flow/">Lava Flow »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.0 on <span class="colophon-date" title="Thursday 20 November 2025 22:37">Thursday 20 November 2025</span>. Using Julia version 1.12.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
