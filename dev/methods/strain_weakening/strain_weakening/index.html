<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Strain Weakening · EarthBox.jl</title><meta name="title" content="Strain Weakening · EarthBox.jl"/><meta property="og:title" content="Strain Weakening · EarthBox.jl"/><meta property="twitter:title" content="Strain Weakening · EarthBox.jl"/><meta name="description" content="Documentation for EarthBox.jl."/><meta property="og:description" content="Documentation for EarthBox.jl."/><meta property="twitter:description" content="Documentation for EarthBox.jl."/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/custom.css" rel="stylesheet" type="text/css"/><script src="../../../assets/equation-refs.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../"><img src="../../../assets/logo.png" alt="EarthBox.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">EarthBox.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../">Introduction</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox"/><label class="tocitem" for="menuitem-2"><span class="docs-label">Installation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../installation/installation/">Installation</a></li><li><a class="tocitem" href="../../../installation/MPI_system/">Using System MPI Binaries</a></li><li><a class="tocitem" href="../../../installation/MUMPS_custom/">Using Custom MUMPS Libraries</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Models</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-3-1" type="checkbox"/><label class="tocitem" for="menuitem-3-1"><span class="docs-label">Model Management with the EarthBox API</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../models/model_execution/api_building_and_execution/">Model Building, Execution and Plotting</a></li><li><a class="tocitem" href="../../../models/model_execution/input_file_execution/">Using Input Files</a></li><li><a class="tocitem" href="../../../models/model_execution/background_command_line_execution/">Background Command-line Execution</a></li><li><a class="tocitem" href="../../../models/model_execution/remote_execution/">Batch Remote Execution</a></li><li><a class="tocitem" href="../../../models/model_execution/batch_local_execution/">Batch Local Execution</a></li><li><a class="tocitem" href="../../../models/model_execution/parallel_marker_plotting/">Plotting Marker Swarms in Parallel</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">Models</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../models/model_list/">Model List</a></li><li><a class="tocitem" href="../../../models/lithospheric_extension/polyphase_extension_n17/">Polyphase Extension n17</a></li><li><a class="tocitem" href="../../../models/lithospheric_extension/extension_weak_fault/">Extension with Weak Fault</a></li><li><a class="tocitem" href="../../../models/lithospheric_extension/extension_with_softening_b14/">Extension with Softening b14</a></li><li><a class="tocitem" href="../../../models/sdr_formation/sdr_formation/">SDR Formation</a></li><li><a class="tocitem" href="../../../models/vep_extension_downhill_diffusion/vep_extension_downhill_diffusion/">Visco-elasto-plastic Extension with Downhill Diffusion</a></li><li><a class="tocitem" href="../../../models/subduction/slab_retreat/">Slab Retreat</a></li><li><a class="tocitem" href="../../../models/sandbox/sandbox_extension/">Sandbox Extension</a></li><li><a class="tocitem" href="../../../models/sandbox/sandbox_shortening/">Sandbox Shortening</a></li><li><a class="tocitem" href="../../../models/spreading_center/spreading_center/">Spreading Center</a></li><li><a class="tocitem" href="../../../models/hot_box_melting/hot_box_melting/">Hot Box Melting</a></li><li><a class="tocitem" href="../../../models/regional/catl/">Magmatic Crust Formation: Central Atlantic</a></li><li><a class="tocitem" href="../../../models/regional/iberia/">Magma Poor Margin: Iberia</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox" checked/><label class="tocitem" for="menuitem-4"><span class="docs-label">Methods</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../introduction/">Introduction</a></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">Governing Equations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../governing_equations/momentum_and_mass/">Conservation of Momentum and Mass</a></li><li><a class="tocitem" href="../../governing_equations/energy/">Conservation of Energy</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-3" type="checkbox"/><label class="tocitem" for="menuitem-4-3"><span class="docs-label">Discretization</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../discretization/grid_structure/">Staggered Grid Structure</a></li><li><a class="tocitem" href="../../discretization/grid_generation/">Staggered Grid Generation</a></li><li><a class="tocitem" href="../../discretization/marker_distribution/">Marker Distribution</a></li><li><a class="tocitem" href="../../discretization/stokes2D/">Discretization of the 2D Stokes-continuity Equations</a></li><li><a class="tocitem" href="../../discretization/conduction/">Discretization of Heat-conduction Equation</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-4" type="checkbox"/><label class="tocitem" for="menuitem-4-4"><span class="docs-label">Boundary Conditions</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../discretization/stokes_bcs/">Stokes Boundary Conditions</a></li><li><a class="tocitem" href="../../discretization/heat_bcs/">Heat Boundary Conditions</a></li></ul></li><li><a class="tocitem" href="../../interpolation/marker_grid_interpolation/">Marker-Grid Interpolation</a></li><li><a class="tocitem" href="../../stokes_algorithm/stokes_algorithm/">Stokes-Continuity Algorithm</a></li><li><a class="tocitem" href="../../heat_algorithm/heat_algorithm/">Heat Algorithm</a></li><li><a class="tocitem" href="../../sediment_transport/sediment_transport/">Sediment Transport</a></li><li><a class="tocitem" href="../../melt/melt/">Melt</a></li><li><a class="tocitem" href="../../lava_flow/lava_flow/">Lava Flow</a></li><li><a class="tocitem" href="../../viscous_creep/viscous_creep/">Viscous Creep</a></li><li class="is-active"><a class="tocitem" href>Strain Weakening</a></li><li><a class="tocitem" href="../../hydrothermal/hydrothermal/">Hydrothermal Circulation</a></li><li><a class="tocitem" href="../../serpentinization/serpentinization/">Serpentinization</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Thermo-mechanical Algorithm</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/main_steps/">Main Steps</a></li><li><input class="collapse-toggle" id="menuitem-5-2" type="checkbox"/><label class="tocitem" for="menuitem-5-2"><span class="docs-label">Pre-solver Steps</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/pre_solver_steps/pre_solver_steps/">Pre-solver Steps</a></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/pre_solver_steps/sections/rock_property_update/">Rock Property Update Steps</a></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/pre_solver_steps/sections/latent_heat_update/">Latent Heat Update Steps</a></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/pre_solver_steps/sections/hydrothermal_update/">Hydrothermal Update Steps</a></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/pre_solver_steps/sections/marker_failure_prop_update/">Marker Failure Properties Update Steps</a></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/pre_solver_steps/sections/marker_viscosity_update/">Marker Creep Viscosity Update Steps</a></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/pre_solver_steps/sections/melt_damage_update/">Melt Damage Update Steps</a></li></ul></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/stokes_solver_steps/stokes_solver_steps/">Stokes-solver Steps</a></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/heat_solver_steps/heat_solver_steps/">Heat-solver Steps</a></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/advection_solver_steps/advection_solver_steps/">Advection-solver Steps</a></li><li><input class="collapse-toggle" id="menuitem-5-6" type="checkbox"/><label class="tocitem" for="menuitem-5-6"><span class="docs-label">Post-solver Steps</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/post_solver_steps/post_solver_steps/">Post-solver Steps</a></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/post_solver_steps/sections/topography/">Topography</a></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/post_solver_steps/sections/melt_extraction/">Melt Extraction</a></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/post_solver_steps/sections/sediment_transport/">Sediment Transport</a></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/post_solver_steps/sections/lava_flow/">Lava Flow</a></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/post_solver_steps/sections/marker_transformation/">Marker Transformation</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">EarthBox API</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/earthbox_api/">API Overview</a></li><li><a class="tocitem" href="../../../api/earthbox_state/earthbox_state/">EarthBoxState</a></li><li><input class="collapse-toggle" id="menuitem-6-3" type="checkbox"/><label class="tocitem" for="menuitem-6-3"><span class="docs-label">Model Management</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/model_manager/model_manager/">ModelManager</a></li><li><a class="tocitem" href="../../../api/model_manager/xdmf/xdmf_timestep_manager/">XdmfTimeStepsManager</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-4" type="checkbox"/><label class="tocitem" for="menuitem-6-4"><span class="docs-label">Staggered Grid</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/staggered_grid/initialization/">Initialization</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-5" type="checkbox"/><label class="tocitem" for="menuitem-6-5"><span class="docs-label">Material Geometry</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/material_geometry/sticky_air_geometry/">StickyAirGeometry</a></li><li><a class="tocitem" href="../../../api/material_geometry/earth_layering/">EarthLayering</a></li><li><a class="tocitem" href="../../../api/material_geometry/litho_strong_zones/">LithoStrongZones</a></li><li><a class="tocitem" href="../../../api/material_geometry/plume/">Plume</a></li><li><a class="tocitem" href="../../../api/material_geometry/crustal_hole/">CrustalHole</a></li><li><a class="tocitem" href="../../../api/material_geometry/rayleigh_taylor/">RayleighTaylor</a></li><li><a class="tocitem" href="../../../api/material_geometry/mobile_wall/">MobileWall</a></li><li><a class="tocitem" href="../../../api/material_geometry/sandbox/">Sandbox</a></li><li><a class="tocitem" href="../../../api/material_geometry/internal_velocity_zone/">InternalVelocityZone</a></li><li><a class="tocitem" href="../../../api/material_geometry/fracture_zone/">FractureZone</a></li><li><a class="tocitem" href="../../../api/material_geometry/weak_fault/">WeakFault</a></li><li><a class="tocitem" href="../../../api/material_geometry/weak_seed/">WeakSeed</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-6" type="checkbox"/><label class="tocitem" for="menuitem-6-6"><span class="docs-label">Boundary Conditions</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/boundary_conditions/boundary_conditions/">Initialization</a></li><li><a class="tocitem" href="../../../api/boundary_conditions/bc_managers/pressure/">Pressure</a></li><li><a class="tocitem" href="../../../api/boundary_conditions/bc_managers/temperature/">Temperature</a></li><li><a class="tocitem" href="../../../api/boundary_conditions/bc_managers/transient_bottom_temperature/">TransientBottomTemperature</a></li><li><a class="tocitem" href="../../../api/boundary_conditions/bc_managers/velocity/">Velocity</a></li><li><a class="tocitem" href="../../../api/boundary_conditions/bc_managers/velocity_from_strain_rate/">VelocityFromStrainRate</a></li><li><a class="tocitem" href="../../../api/boundary_conditions/bc_managers/velocity_stop/">VelocityStop</a></li><li><a class="tocitem" href="../../../api/boundary_conditions/bc_managers/velocity_step/">VelocityStep</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-7" type="checkbox"/><label class="tocitem" for="menuitem-6-7"><span class="docs-label">Marker Initialization</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/markers/coordinates/">MarkerCoordinates</a></li><li><a class="tocitem" href="../../../api/markers/temperature/">MarkerTemperature</a></li><li><a class="tocitem" href="../../../api/markers/friction/">MarkerFriction</a></li><li><a class="tocitem" href="../../../api/markers/cohesion/">MarkerCohesion</a></li><li><a class="tocitem" href="../../../api/markers/dilatancy/">MarkerDilatancy</a></li><li><a class="tocitem" href="../../../api/markers/viscous_strain_softening/">MarkerViscousStrainSoftening</a></li><li><a class="tocitem" href="../../../api/markers/preexponential/">MarkerPreexponential</a></li><li><a class="tocitem" href="../../../api/markers/stress_limits/">MarkerStressLimits</a></li><li><a class="tocitem" href="../../../api/markers/boundary_friction/">MarkerBoundaryFriction</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-8" type="checkbox"/><label class="tocitem" for="menuitem-6-8"><span class="docs-label">Marker Materials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/marker_materials/materials/">MarkerMaterials</a></li><li><a class="tocitem" href="../../../api/marker_materials/material_collection_files/">Material Collection Files</a></li><li><a class="tocitem" href="../../../api/marker_materials/material_properties/">Material Properties</a></li><li><a class="tocitem" href="../../../api/marker_materials/material_input/">Material Input</a></li><li><a class="tocitem" href="../../../api/marker_materials/material_types/">Material Types</a></li><li><a class="tocitem" href="../../../api/marker_materials/material_domains/">Material Domains</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-9" type="checkbox"/><label class="tocitem" for="menuitem-6-9"><span class="docs-label">Rock Properties</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/rock_properties/rock_properties/">RockProperties</a></li><li><a class="tocitem" href="../../../api/rock_properties/hydrothermal/hydrothermal/">Hydrothermal Circulation</a></li><li><a class="tocitem" href="../../../api/rock_properties/serpentinization/serpentinization/">Serpentinization</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-10" type="checkbox"/><label class="tocitem" for="menuitem-6-10"><span class="docs-label">Stokes Continuity Solver</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/stokes_continuity_solver/stokes_continuity_solver/">StokesContinuitySolver</a></li><li><a class="tocitem" href="../../../api/stokes_continuity_solver/global_plasticity_loop/">GlobalPlasticityLoop</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-11" type="checkbox"/><label class="tocitem" for="menuitem-6-11"><span class="docs-label">Heat Solver</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/heat_solver/heat_solver/">HeatSolver</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-12" type="checkbox"/><label class="tocitem" for="menuitem-6-12"><span class="docs-label">Marker Advection</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/advection/advection/">Advection</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-13" type="checkbox"/><label class="tocitem" for="menuitem-6-13"><span class="docs-label">Interpolation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/interpolation/interpolation/">Interpolation</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-14" type="checkbox"/><label class="tocitem" for="menuitem-6-14"><span class="docs-label">Melt Model</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/melt_model/melt_model/">MeltModel</a></li><li><a class="tocitem" href="../../../api/melt_model/melt_extraction/">MeltExtraction</a></li><li><a class="tocitem" href="../../../api/melt_model/melt_extrusion/">MeltExtrusion</a></li><li><a class="tocitem" href="../../../api/melt_model/melt_damage/">MeltDamage</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-15" type="checkbox"/><label class="tocitem" for="menuitem-6-15"><span class="docs-label">Surface Processes</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/surface_processes/topography/">Topography</a></li><li><a class="tocitem" href="../../../api/surface_processes/sealevel/">Sealevel</a></li><li><a class="tocitem" href="../../../api/surface_processes/relative_base_level/">RelativeBaseLevel</a></li><li><a class="tocitem" href="../../../api/surface_processes/sediment_transport/">SedimentTransport</a></li><li><a class="tocitem" href="../../../api/surface_processes/salt/">SaltDeposition</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-16" type="checkbox"/><label class="tocitem" for="menuitem-6-16"><span class="docs-label">Time Step Execution and Initialization</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/run_time_steps/run_time_steps/">Execution</a></li><li><a class="tocitem" href="../../../api/run_time_steps/time_Step_initialization/">Initialization</a></li><li><a class="tocitem" href="../../../api/run_time_steps/examples/">Examples</a></li></ul></li><li><a class="tocitem" href="../../../api/command_line_args/command_line_args/">Command-line Arguments</a></li><li><a class="tocitem" href="../../../api/case_management/case_management/">Case Management</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox"/><label class="tocitem" for="menuitem-7"><span class="docs-label">Material Library</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../material_library/material_library/">MaterialLibrary</a></li><li><a class="tocitem" href="../../../material_library/collections/lithospheric_deformation_eb1/">Collection: Lithospheric Deformation eb1</a></li><li><a class="tocitem" href="../../../material_library/collections/benchmarks/">Collection: Benchmarks</a></li><li><a class="tocitem" href="../../../material_library/collections/benchmarks_sfs/">Collection: Benchmarks SFS</a></li><li><a class="tocitem" href="../../../material_library/collections/sandbox/">Collection: Sandbox</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8" type="checkbox"/><label class="tocitem" for="menuitem-8"><span class="docs-label">Plot Tools</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../plot_tools/cl_plotter/">Command-line Plotter</a></li><li><a class="tocitem" href="../../../plot_tools/scalar_grid_plots/">Scalar Grid Plots</a></li><li><a class="tocitem" href="../../../plot_tools/vector_plots/">Velocity Vector Plots</a></li><li><a class="tocitem" href="../../../plot_tools/marker_plots/">Marker Swarm Plots</a></li><li><a class="tocitem" href="../../../plot_tools/yield_strength_plots/">Yield Strength Plots</a></li><li><a class="tocitem" href="../../../plot_tools/stokes_convergence_plots/">Stokes Convergence Plots</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-9" type="checkbox"/><label class="tocitem" for="menuitem-9"><span class="docs-label">Data Types</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../data_types/data_types/">Data Types</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-10" type="checkbox"/><label class="tocitem" for="menuitem-10"><span class="docs-label">Model Data</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../model_data/model_data/">ModelData</a></li><li><input class="collapse-toggle" id="menuitem-10-2" type="checkbox"/><label class="tocitem" for="menuitem-10-2"><span class="docs-label">Collections</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../model_data/collections/benchmarks/">Benchmarks</a></li><li><a class="tocitem" href="../../../model_data/collections/bcs/">BoundaryConditions</a></li><li><a class="tocitem" href="../../../model_data/collections/carbonate/">Carbonate</a></li><li><a class="tocitem" href="../../../model_data/collections/conversion/">Conversion</a></li><li><a class="tocitem" href="../../../model_data/collections/geometry/">Geometry</a></li><li><a class="tocitem" href="../../../model_data/collections/gravity/">Gravity</a></li><li><a class="tocitem" href="../../../model_data/collections/grids/">Grids</a></li><li><a class="tocitem" href="../../../model_data/collections/heat_equation/">HeatEquation</a></li><li><a class="tocitem" href="../../../model_data/collections/interpolation/">Interpolation</a></li><li><a class="tocitem" href="../../../model_data/collections/markers/">Markers</a></li><li><a class="tocitem" href="../../../model_data/collections/materials/">Materials</a></li><li><a class="tocitem" href="../../../model_data/collections/melting/">Melting</a></li><li><a class="tocitem" href="../../../model_data/collections/stokes_continuity/">StokesContinuity</a></li><li><a class="tocitem" href="../../../model_data/collections/timestep/">Timestep</a></li><li><a class="tocitem" href="../../../model_data/collections/topography/">Topography</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-11" type="checkbox"/><label class="tocitem" for="menuitem-11"><span class="docs-label">Units</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../units/units/">Units</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-12" type="checkbox"/><label class="tocitem" for="menuitem-12"><span class="docs-label">Benchmarks</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../benchmarks/benchmarks/">Benchmarks</a></li><li><a class="tocitem" href="../../../benchmarks/single_execution/">Single Execution</a></li><li><a class="tocitem" href="../../../benchmarks/batch_execution/">Batch Execution</a></li><li><input class="collapse-toggle" id="menuitem-12-4" type="checkbox"/><label class="tocitem" for="menuitem-12-4"><span class="docs-label">Results</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../benchmarks/models/couette_flow_viscous_heating/">Couette Flow with Viscous Heating</a></li><li><a class="tocitem" href="../../../benchmarks/models/channel_flow_variable_conductivity/">Channel Flow Variable Conductivity</a></li><li><a class="tocitem" href="../../../benchmarks/models/channel_flow_non_steady_temperature/">Channel Flow Non Steady Temperature</a></li><li><a class="tocitem" href="../../../benchmarks/models/channel_flow_non_newtonian/">Channel Flow Non Newtonian</a></li><li><a class="tocitem" href="../../../benchmarks/models/solid_body_rotation/">Solid Body Rotation</a></li><li><a class="tocitem" href="../../../benchmarks/models/rayleigh_taylor_instability/">Rayleigh Taylor Instability</a></li><li><a class="tocitem" href="../../../benchmarks/models/elastic_slab/">Elastic Slab</a></li><li><a class="tocitem" href="../../../benchmarks/models/viscoelastic_stress_buildup/">Viscoelastic Stress Buildup</a></li><li><a class="tocitem" href="../../../benchmarks/models/box_convection_isoviscous_1a/">Box Convection Isoviscous 1a</a></li><li><a class="tocitem" href="../../../benchmarks/models/plasticity_benchmark_kaus10/">Plasticity Benchmark Kaus10</a></li><li><a class="tocitem" href="../../../benchmarks/models/seafloor_spreading/">Seafloor Spreading</a></li><li><a class="tocitem" href="../../../benchmarks/models/flexure_triangular_hole/">Flexure Triangular Hole</a></li><li><a class="tocitem" href="../../../benchmarks/models/viscoelastic_extension/">Viscoelastic Extension</a></li><li><a class="tocitem" href="../../../benchmarks/models/viscoelastic_contraction/">Viscoelastic Contraction</a></li><li><a class="tocitem" href="../../../benchmarks/models/simple_sedimentation/">Simple Sedimentation</a></li></ul></li></ul></li><li><a class="tocitem" href="../../../bibliography/bibliography/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Methods</a></li><li class="is-active"><a href>Strain Weakening</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Strain Weakening</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/eakneller/EarthBox.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Strain-Weakening-and-Melt-Damage"><a class="docs-heading-anchor" href="#Strain-Weakening-and-Melt-Damage">Strain Weakening and Melt Damage</a><a id="Strain-Weakening-and-Melt-Damage-1"></a><a class="docs-heading-anchor-permalink" href="#Strain-Weakening-and-Melt-Damage" title="Permalink"></a></h1><p>Experimental works shows that the yield stress in equation <a href="../../governing_equations/momentum_and_mass/#eq:yield-stress">eq:yield-stress</a> decreases as  phyllosilicate minerals and foliation form and the pressure-solution deformation mechanism becomes  dominant as grain size is reduced in shear zones (<a href="../../../bibliography/bibliography/#bos02">Bos and Spiers, 2002</a>). This weakening of frictional-plastic strength is modeled by reducing the cohesion and friction angle with increasing plastic strain as  described by the following equations:</p><h6 id="eq:strain-weakening"><a class="docs-heading-anchor" href="#eq:strain-weakening">eq:strain-weakening</a><a id="eq:strain-weakening-1"></a><a class="docs-heading-anchor-permalink" href="#eq:strain-weakening" title="Permalink"></a></h6><p class="math-container">\[\begin{split}
    \sigma_{c,m} = 
        \sigma_{c,m}^o
        + \frac{(\sigma_{c,m}^f - \sigma_{c,m}^o)}{(\epsilon^f - \epsilon^o)}(\epsilon_{plastic,m} - \epsilon^o)  \\
    \theta_m = 
        \theta_m^o
        + \frac{(\theta_m^f - \theta_m^o)}{(\epsilon^f - \epsilon^o)}(\epsilon_{plastic,m} - \epsilon^o)
\end{split}\]</p><p>where <span>$m$</span> is the index of the marker, <span>$\epsilon_{plastic,m}$</span> is plastic strain of the marker,  <span>$\epsilon^o$</span> and <span>$\epsilon^f$</span> are initial and final reference plastic strain, <span>$\sigma_{c,m}^o$</span> and  <span>$\sigma_{c,m}^f$</span> are initial and final reference cohesion, and <span>$\theta_m^f$</span> is the final reference  friction angle and <span>$\theta_m^o$</span> is the final initial reference friction angle that is randomized at  the beginning of each time step using the following equation from (<a href="../../../bibliography/bibliography/#naliboff17">Naliboff <em>et al.</em>, 2017</a>):</p><h6 id="eq:friction-angle-randomization"><a class="docs-heading-anchor" href="#eq:friction-angle-randomization">eq:friction-angle-randomization</a><a id="eq:friction-angle-randomization-1"></a><a class="docs-heading-anchor-permalink" href="#eq:friction-angle-randomization" title="Permalink"></a></h6><p class="math-container">\[\theta_m^o = \theta&#39;_m{^o} + (0.5 - r)f_{random}\]</p><p>where <span>$\theta&#39;_{m}{^o}$</span> is the initial reference friction angle of the material associated  with marker <span>$m$</span>, <span>$r$</span> is a random number in the range [0,1], and <span>$f_{random}$</span> is a randomization  factor controlling the magnitude of the perturbation and set equal to 10 for the experiments of this work. The randomization of friction angles described in equation <a href="#eq:friction-angle-randomization">Eq.</a> is  used to model the evolving variability of frictional-plastic strength due to fluid-rock interactions  (<a href="../../../bibliography/bibliography/#naliboff17">Naliboff <em>et al.</em>, 2017</a>). The final reference friction angle <span>$\theta_m^f$</span> is defined as:</p><h6 id="eq:final-friction-angle"><a class="docs-heading-anchor" href="#eq:final-friction-angle">eq:final-friction-angle</a><a id="eq:final-friction-angle-1"></a><a class="docs-heading-anchor-permalink" href="#eq:final-friction-angle" title="Permalink"></a></h6><p class="math-container">\[\theta_m^f = \frac{\theta&#39;_m{^f}}{\theta&#39;_{m}{^o}}\theta_{m}^o\]</p><p>where <span>$\theta&#39;_m{^f}$</span> is the unmodified final reference friction angle of the material associated  with marker <span>$m$</span>. Marker plastic strain <span>$\epsilon _{plastic,m}$</span> in equation <a href="#eq:strain-weakening">Eq.</a>  is calculate using the following equations:</p><h6 id="eq:plastic-strain"><a class="docs-heading-anchor" href="#eq:plastic-strain">eq:plastic-strain</a><a id="eq:plastic-strain-1"></a><a class="docs-heading-anchor-permalink" href="#eq:plastic-strain" title="Permalink"></a></h6><p class="math-container">\[\begin{split}
    \sigma_{II,m}&#39; = \sqrt{
        \left(\sigma_{xx,m}&#39;\right)^2 + \left(\sigma_{xy,m}&#39;\right)^2}
        \text{,} \\
    \dot \epsilon _{plastic,m} = \frac{1}{2}\sigma_{II,m}&#39;
        \left( \frac{1}{\eta_{vp,m}} - \frac{1}{\eta_{creep,m}}\right)
        \text{,} \\
    \epsilon _{plastic,m} 
        = \epsilon _{plastic,m}^o 
            + \left( \dot \epsilon _{plastic,m} \Delta t - \dot \epsilon_{healing} \Delta t \right)             
\end{split}\]</p><p>where <span>$\epsilon _{plastic,m}^o$</span> is the current marker plastic strain, <span>$\dot \epsilon _{plastic,m}$</span> is the plastic strain rate, <span>$\sigma_{II,m}&#39;$</span> is the second invariant of the stress tensor, and <span>$\dot \epsilon_{healing}$</span> is the plastic healing rate.</p><p>As melt is transported through the lithosphere and crust it can weaken the bulk frictional-plastic  yield strength of the rock by forming reactive channelized networks, increasing fluid pressure and  forming dikes and sills that may be weaker than the surrounding rock prior to solidification. In this  work, weakening associated with melt transport is assumed to be probabilistically localized above local  maxima of the partially molten domain in the mantle that act as focusing points for melt migration.  The maximum probability of melt damage is assumed to scale with amount of melt being generated in a  melt drainage basin <span>$k$</span>, which is defined by the characteristic magmatic crust height <span>$H_{mc,k}$</span>  calculated during melt extraction (see equation <a href="../../melt/melt/#eq:char-magmatic-crust-height">eq:char-magmatic-crust-height</a>). The weakening from  damage associated with melt transport is modeled by reducing cohesion and friction angle based on a  melt damage factor <span>$f_{damage,m}$</span> as described by the following equations:</p><h6 id="eq:melt-damage-weakening"><a class="docs-heading-anchor" href="#eq:melt-damage-weakening">eq:melt-damage-weakening</a><a id="eq:melt-damage-weakening-1"></a><a class="docs-heading-anchor-permalink" href="#eq:melt-damage-weakening" title="Permalink"></a></h6><p class="math-container">\[\begin{split}
    \sigma_{c,m} = \frac{\sigma_{c,m}}{f_{damage,m}} \text{,}\\
    \theta_m = \frac{\theta_m}{f_{damage,m}} \text{.}
\end{split}\]</p><p>The melt damage factor <span>$f_{damage,m}$</span> is defined in a binary manner where <span>$f_{damage,m}$</span> is set equal to 1 outside of the melt damage zone and set equal to either 1 or a constant value greater than 1 based on a probability distribution within the melt damage zone. A melt damage zone is defined for a given melt drainage basin <span>$k$</span> by the x-coordinate limits <span>$x_{damage}^{min}$</span> and <span>$x_{damage}^{max}$</span> and y-coordinate limit <span>$y_{damage}^{max}$</span> defined as follows:</p><h6 id="eq:melt-damage-zone-limits"><a class="docs-heading-anchor" href="#eq:melt-damage-zone-limits">eq:melt-damage-zone-limits</a><a id="eq:melt-damage-zone-limits-1"></a><a class="docs-heading-anchor-permalink" href="#eq:melt-damage-zone-limits" title="Permalink"></a></h6><p class="math-container">\[\begin{split}
    x_{damage}^{min} &amp; = x&#39;_{shallow,pm,k} - \frac{W_{damage}}{2} \text{,}\\
    x_{damage}^{max} &amp; = x&#39;_{shallow,pm,k} + \frac{W_{damage}}{2} \text{,}\\
    y_{damage}^{max} &amp; = y&#39;_{shallow,pm,k}\\
\end{split}\]</p><p>where <span>$x&#39;_{shallow,pm,k}$</span> is the average x-coordinate of the shallowest partially molten mantle marker and <span>$y&#39;_{shallow,pm,k}$</span> is the average y-coordinate of the shallowest partially molten mantle marker calculated during melt extraction, and <span>$W_{damage}$</span> is the width of the damage zone. The melt model is applied to each marker <span>$m$</span> in the melt damage zone excluding sticky air and water markers.</p><p>The melt damage factor <span>$f_{damage,m}$</span> for a given marker <span>$m$</span> is calculated using the following equation:</p><h6 id="eq:melt-damage-factor"><a class="docs-heading-anchor" href="#eq:melt-damage-factor">eq:melt-damage-factor</a><a id="eq:melt-damage-factor-1"></a><a class="docs-heading-anchor-permalink" href="#eq:melt-damage-factor" title="Permalink"></a></h6><p class="math-container">\[f_{damage,m} = 
\begin{cases}
    f_{damage,max} &amp; \text{if } r &lt; p_{damage,m} \\
    1.0 &amp; \text{if } r \geq p_{damage,m}
\end{cases}\]</p><p>where <span>$f_{damage,max}$</span> is the maximum melt damage factor set equal to 10 for the experiments of  this work, and <span>$r$</span> is a random number between 0 and 1. The damage probability <span>$p_{damage,m}$</span> is  calculated using the following equation:</p><h6 id="eq:melt-damage-probability"><a class="docs-heading-anchor" href="#eq:melt-damage-probability">eq:melt-damage-probability</a><a id="eq:melt-damage-probability-1"></a><a class="docs-heading-anchor-permalink" href="#eq:melt-damage-probability" title="Permalink"></a></h6><p class="math-container">\[p_{damage,m} = 
\begin{cases}
    0.0 &amp; \text{if } x_{damage}^{max} &lt; x_m &lt; x_{damage}^{min} \\
    \left[\frac{
            p_{damage}^{central}
        }{
            2\cos\left(\frac{\left(x_m - x&#39;_{shallow,pm,k}\right)}{W_{damage}}2\pi\right) + 1
        } \right]
        &amp; \text{if } x_{damage}^{min} \leq x_m \leq x_{damage}^{max}
\end{cases}\]</p><p>where the central damage zone damage probability <span>$p_{damage}^{central}$</span> is given by:</p><h6 id="eq:central-damage-probability"><a class="docs-heading-anchor" href="#eq:central-damage-probability">eq:central-damage-probability</a><a id="eq:central-damage-probability-1"></a><a class="docs-heading-anchor-permalink" href="#eq:central-damage-probability" title="Permalink"></a></h6><p class="math-container">\[p_{damage}^{central} = 
\begin{cases}
    0.0 &amp; \text{if } H_{mc,k} \leq H_{mc,min} \\

    p_{damage}^{max} &amp; \text{if } H_{mc,k} \geq H_{mc,max} \\

    \frac{p_{damage}^{inter}}{H_{mc,inter} - H_{mc,min}}\Delta H_1
            &amp; \text{if } H_{mc,min} &lt; H_{mc,k} \leq H_{mc,inter} \\

    p_{damage}^{inter}
        + \frac{p_{damage}^{max} - p_{damage}^{inter}}{H_{mc,max} - H_{mc,inter}}\Delta H_2
                &amp; \text{if } H_{mc,inter} &lt; H_{mc,k} &lt; H_{mc,max}
\end{cases}\]</p><p>where <span>$\Delta H_1 = (H_{mc,k} - H_{mc,min})$</span>, <span>$\Delta H_2 = (H_{mc,k} - H_{mc,inter})$</span>, <span>$H_{mc,k}$</span> is characteristic magmatic crust height for drainage basin <span>$k$</span> calculated  during melt extraction, <span>$H_{mc,min}$</span> is the minimum reference characteristic magmatic crust height, <span>$H_{mc,max}$</span> is the maximum reference  characteristic magmatic crust height, <span>$H_{mc,inter}$</span> is the intermediate reference characteristic magmatic crust height, <span>$p_{damage}^{max}$</span> is the maximum  damage probability, and <span>$p_{damage}^{inter}$</span> is the intermediate damage probability.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../viscous_creep/viscous_creep/">« Viscous Creep</a><a class="docs-footer-nextpage" href="../../hydrothermal/hydrothermal/">Hydrothermal Circulation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.0 on <span class="colophon-date" title="Saturday 22 November 2025 09:28">Saturday 22 November 2025</span>. Using Julia version 1.12.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
