<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Lava Flow · EarthBox.jl</title><meta name="title" content="Lava Flow · EarthBox.jl"/><meta property="og:title" content="Lava Flow · EarthBox.jl"/><meta property="twitter:title" content="Lava Flow · EarthBox.jl"/><meta name="description" content="Documentation for EarthBox.jl."/><meta property="og:description" content="Documentation for EarthBox.jl."/><meta property="twitter:description" content="Documentation for EarthBox.jl."/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/custom.css" rel="stylesheet" type="text/css"/><script src="../../../assets/equation-refs.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../"><img src="../../../assets/logo.png" alt="EarthBox.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">EarthBox.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../">Introduction</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox"/><label class="tocitem" for="menuitem-2"><span class="docs-label">Installation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../installation/installation/">Installation</a></li><li><a class="tocitem" href="../../../installation/MPI_system/">Using System MPI Binaries</a></li><li><a class="tocitem" href="../../../installation/MUMPS_custom/">Using Custom MUMPS Libraries</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Models</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><input class="collapse-toggle" id="menuitem-3-1" type="checkbox"/><label class="tocitem" for="menuitem-3-1"><span class="docs-label">Model Management with the EarthBox API</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../models/model_execution/api_building_and_execution/">Model Building, Execution and Plotting</a></li><li><a class="tocitem" href="../../../models/model_execution/input_file_execution/">Using Input Files</a></li><li><a class="tocitem" href="../../../models/model_execution/background_command_line_execution/">Background Command-line Execution</a></li><li><a class="tocitem" href="../../../models/model_execution/remote_execution/">Batch Remote Execution</a></li><li><a class="tocitem" href="../../../models/model_execution/batch_local_execution/">Batch Local Execution</a></li><li><a class="tocitem" href="../../../models/model_execution/parallel_marker_plotting/">Plotting Marker Swarms in Parallel</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">Models</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../models/model_list/">Model List</a></li><li><a class="tocitem" href="../../../models/lithospheric_extension/polyphase_extension_n17/">Polyphase Extension n17</a></li><li><a class="tocitem" href="../../../models/lithospheric_extension/extension_weak_fault/">Extension with Weak Fault</a></li><li><a class="tocitem" href="../../../models/lithospheric_extension/extension_with_softening_b14/">Extension with Softening b14</a></li><li><a class="tocitem" href="../../../models/sdr_formation/sdr_formation/">SDR Formation</a></li><li><a class="tocitem" href="../../../models/vep_extension_downhill_diffusion/vep_extension_downhill_diffusion/">Visco-elasto-plastic Extension with Downhill Diffusion</a></li><li><a class="tocitem" href="../../../models/subduction/slab_retreat/">Slab Retreat</a></li><li><a class="tocitem" href="../../../models/sandbox/sandbox_extension/">Sandbox Extension</a></li><li><a class="tocitem" href="../../../models/sandbox/sandbox_shortening/">Sandbox Shortening</a></li><li><a class="tocitem" href="../../../models/spreading_center/spreading_center/">Spreading Center</a></li><li><a class="tocitem" href="../../../models/hot_box_melting/hot_box_melting/">Hot Box Melting</a></li><li><a class="tocitem" href="../../../models/regional/catl/">Magmatic Crust Formation: Central Atlantic</a></li><li><a class="tocitem" href="../../../models/regional/iberia/">Magma Poor Margin: Iberia</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox" checked/><label class="tocitem" for="menuitem-4"><span class="docs-label">Methods</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../introduction/">Introduction</a></li><li><input class="collapse-toggle" id="menuitem-4-2" type="checkbox"/><label class="tocitem" for="menuitem-4-2"><span class="docs-label">Governing Equations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../governing_equations/momentum_and_mass/">Conservation of Momentum and Mass</a></li><li><a class="tocitem" href="../../governing_equations/energy/">Conservation of Energy</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-3" type="checkbox"/><label class="tocitem" for="menuitem-4-3"><span class="docs-label">Discretization</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../discretization/grid_structure/">Staggered Grid Structure</a></li><li><a class="tocitem" href="../../discretization/grid_generation/">Staggered Grid Generation</a></li><li><a class="tocitem" href="../../discretization/marker_distribution/">Marker Distribution</a></li><li><a class="tocitem" href="../../discretization/stokes2D/">Discretization of the 2D Stokes-continuity Equations</a></li><li><a class="tocitem" href="../../discretization/conduction/">Discretization of Heat-conduction Equation</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4-4" type="checkbox"/><label class="tocitem" for="menuitem-4-4"><span class="docs-label">Boundary Conditions</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../discretization/stokes_bcs/">Stokes Boundary Conditions</a></li><li><a class="tocitem" href="../../discretization/heat_bcs/">Heat Boundary Conditions</a></li></ul></li><li><a class="tocitem" href="../../interpolation/marker_grid_interpolation/">Marker-Grid Interpolation</a></li><li><a class="tocitem" href="../../stokes_algorithm/stokes_algorithm/">Stokes-Continuity Algorithm</a></li><li><a class="tocitem" href="../../heat_algorithm/heat_algorithm/">Heat Algorithm</a></li><li><a class="tocitem" href="../../sediment_transport/sediment_transport/">Sediment Transport</a></li><li><a class="tocitem" href="../../melt/melt/">Melt</a></li><li class="is-active"><a class="tocitem" href>Lava Flow</a></li><li><a class="tocitem" href="../../viscous_creep/viscous_creep/">Viscous Creep</a></li><li><a class="tocitem" href="../../strain_weakening/strain_weakening/">Strain Weakening</a></li><li><a class="tocitem" href="../../hydrothermal/hydrothermal/">Hydrothermal Circulation</a></li><li><a class="tocitem" href="../../serpentinization/serpentinization/">Serpentinization</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-5" type="checkbox"/><label class="tocitem" for="menuitem-5"><span class="docs-label">Thermo-mechanical Algorithm</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/main_steps/">Main Steps</a></li><li><input class="collapse-toggle" id="menuitem-5-2" type="checkbox"/><label class="tocitem" for="menuitem-5-2"><span class="docs-label">Pre-solver Steps</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/pre_solver_steps/pre_solver_steps/">Pre-solver Steps</a></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/pre_solver_steps/sections/rock_property_update/">Rock Property Update Steps</a></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/pre_solver_steps/sections/latent_heat_update/">Latent Heat Update Steps</a></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/pre_solver_steps/sections/hydrothermal_update/">Hydrothermal Update Steps</a></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/pre_solver_steps/sections/marker_failure_prop_update/">Marker Failure Properties Update Steps</a></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/pre_solver_steps/sections/marker_viscosity_update/">Marker Creep Viscosity Update Steps</a></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/pre_solver_steps/sections/melt_damage_update/">Melt Damage Update Steps</a></li></ul></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/stokes_solver_steps/stokes_solver_steps/">Stokes-solver Steps</a></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/heat_solver_steps/heat_solver_steps/">Heat-solver Steps</a></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/advection_solver_steps/advection_solver_steps/">Advection-solver Steps</a></li><li><input class="collapse-toggle" id="menuitem-5-6" type="checkbox"/><label class="tocitem" for="menuitem-5-6"><span class="docs-label">Post-solver Steps</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/post_solver_steps/post_solver_steps/">Post-solver Steps</a></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/post_solver_steps/sections/topography/">Topography</a></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/post_solver_steps/sections/melt_extraction/">Melt Extraction</a></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/post_solver_steps/sections/sediment_transport/">Sediment Transport</a></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/post_solver_steps/sections/lava_flow/">Lava Flow</a></li><li><a class="tocitem" href="../../../thermo_mechanical_algorithm/post_solver_steps/sections/marker_transformation/">Marker Transformation</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-6" type="checkbox"/><label class="tocitem" for="menuitem-6"><span class="docs-label">EarthBox API</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/earthbox_api/">API Overview</a></li><li><a class="tocitem" href="../../../api/earthbox_state/earthbox_state/">EarthBoxState</a></li><li><input class="collapse-toggle" id="menuitem-6-3" type="checkbox"/><label class="tocitem" for="menuitem-6-3"><span class="docs-label">Model Management</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/model_manager/model_manager/">ModelManager</a></li><li><a class="tocitem" href="../../../api/model_manager/xdmf/xdmf_timestep_manager/">XdmfTimeStepsManager</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-4" type="checkbox"/><label class="tocitem" for="menuitem-6-4"><span class="docs-label">Staggered Grid</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/staggered_grid/initialization/">Initialization</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-5" type="checkbox"/><label class="tocitem" for="menuitem-6-5"><span class="docs-label">Material Geometry</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/material_geometry/sticky_air_geometry/">StickyAirGeometry</a></li><li><a class="tocitem" href="../../../api/material_geometry/earth_layering/">EarthLayering</a></li><li><a class="tocitem" href="../../../api/material_geometry/litho_strong_zones/">LithoStrongZones</a></li><li><a class="tocitem" href="../../../api/material_geometry/plume/">Plume</a></li><li><a class="tocitem" href="../../../api/material_geometry/crustal_hole/">CrustalHole</a></li><li><a class="tocitem" href="../../../api/material_geometry/rayleigh_taylor/">RayleighTaylor</a></li><li><a class="tocitem" href="../../../api/material_geometry/mobile_wall/">MobileWall</a></li><li><a class="tocitem" href="../../../api/material_geometry/sandbox/">Sandbox</a></li><li><a class="tocitem" href="../../../api/material_geometry/internal_velocity_zone/">InternalVelocityZone</a></li><li><a class="tocitem" href="../../../api/material_geometry/fracture_zone/">FractureZone</a></li><li><a class="tocitem" href="../../../api/material_geometry/weak_fault/">WeakFault</a></li><li><a class="tocitem" href="../../../api/material_geometry/weak_seed/">WeakSeed</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-6" type="checkbox"/><label class="tocitem" for="menuitem-6-6"><span class="docs-label">Boundary Conditions</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/boundary_conditions/boundary_conditions/">Initialization</a></li><li><a class="tocitem" href="../../../api/boundary_conditions/bc_managers/pressure/">Pressure</a></li><li><a class="tocitem" href="../../../api/boundary_conditions/bc_managers/temperature/">Temperature</a></li><li><a class="tocitem" href="../../../api/boundary_conditions/bc_managers/transient_bottom_temperature/">TransientBottomTemperature</a></li><li><a class="tocitem" href="../../../api/boundary_conditions/bc_managers/velocity/">Velocity</a></li><li><a class="tocitem" href="../../../api/boundary_conditions/bc_managers/velocity_from_strain_rate/">VelocityFromStrainRate</a></li><li><a class="tocitem" href="../../../api/boundary_conditions/bc_managers/velocity_stop/">VelocityStop</a></li><li><a class="tocitem" href="../../../api/boundary_conditions/bc_managers/velocity_step/">VelocityStep</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-7" type="checkbox"/><label class="tocitem" for="menuitem-6-7"><span class="docs-label">Marker Initialization</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/markers/coordinates/">MarkerCoordinates</a></li><li><a class="tocitem" href="../../../api/markers/temperature/">MarkerTemperature</a></li><li><a class="tocitem" href="../../../api/markers/friction/">MarkerFriction</a></li><li><a class="tocitem" href="../../../api/markers/cohesion/">MarkerCohesion</a></li><li><a class="tocitem" href="../../../api/markers/dilatancy/">MarkerDilatancy</a></li><li><a class="tocitem" href="../../../api/markers/viscous_strain_softening/">MarkerViscousStrainSoftening</a></li><li><a class="tocitem" href="../../../api/markers/preexponential/">MarkerPreexponential</a></li><li><a class="tocitem" href="../../../api/markers/stress_limits/">MarkerStressLimits</a></li><li><a class="tocitem" href="../../../api/markers/boundary_friction/">MarkerBoundaryFriction</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-8" type="checkbox"/><label class="tocitem" for="menuitem-6-8"><span class="docs-label">Marker Materials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/marker_materials/materials/">MarkerMaterials</a></li><li><a class="tocitem" href="../../../api/marker_materials/material_collection_files/">Material Collection Files</a></li><li><a class="tocitem" href="../../../api/marker_materials/material_properties/">Material Properties</a></li><li><a class="tocitem" href="../../../api/marker_materials/material_input/">Material Input</a></li><li><a class="tocitem" href="../../../api/marker_materials/material_types/">Material Types</a></li><li><a class="tocitem" href="../../../api/marker_materials/material_domains/">Material Domains</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-9" type="checkbox"/><label class="tocitem" for="menuitem-6-9"><span class="docs-label">Rock Properties</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/rock_properties/rock_properties/">RockProperties</a></li><li><a class="tocitem" href="../../../api/rock_properties/hydrothermal/hydrothermal/">Hydrothermal Circulation</a></li><li><a class="tocitem" href="../../../api/rock_properties/serpentinization/serpentinization/">Serpentinization</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-10" type="checkbox"/><label class="tocitem" for="menuitem-6-10"><span class="docs-label">Stokes Continuity Solver</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/stokes_continuity_solver/stokes_continuity_solver/">StokesContinuitySolver</a></li><li><a class="tocitem" href="../../../api/stokes_continuity_solver/global_plasticity_loop/">GlobalPlasticityLoop</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-11" type="checkbox"/><label class="tocitem" for="menuitem-6-11"><span class="docs-label">Heat Solver</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/heat_solver/heat_solver/">HeatSolver</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-12" type="checkbox"/><label class="tocitem" for="menuitem-6-12"><span class="docs-label">Marker Advection</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/advection/advection/">Advection</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-13" type="checkbox"/><label class="tocitem" for="menuitem-6-13"><span class="docs-label">Interpolation</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/interpolation/interpolation/">Interpolation</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-14" type="checkbox"/><label class="tocitem" for="menuitem-6-14"><span class="docs-label">Melt Model</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/melt_model/melt_model/">MeltModel</a></li><li><a class="tocitem" href="../../../api/melt_model/melt_extraction/">MeltExtraction</a></li><li><a class="tocitem" href="../../../api/melt_model/melt_extrusion/">MeltExtrusion</a></li><li><a class="tocitem" href="../../../api/melt_model/melt_damage/">MeltDamage</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-15" type="checkbox"/><label class="tocitem" for="menuitem-6-15"><span class="docs-label">Surface Processes</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/surface_processes/topography/">Topography</a></li><li><a class="tocitem" href="../../../api/surface_processes/sealevel/">Sealevel</a></li><li><a class="tocitem" href="../../../api/surface_processes/relative_base_level/">RelativeBaseLevel</a></li><li><a class="tocitem" href="../../../api/surface_processes/sediment_transport/">SedimentTransport</a></li><li><a class="tocitem" href="../../../api/surface_processes/salt/">SaltDeposition</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-6-16" type="checkbox"/><label class="tocitem" for="menuitem-6-16"><span class="docs-label">Time Step Execution and Initialization</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../api/run_time_steps/run_time_steps/">Execution</a></li><li><a class="tocitem" href="../../../api/run_time_steps/time_Step_initialization/">Initialization</a></li><li><a class="tocitem" href="../../../api/run_time_steps/examples/">Examples</a></li></ul></li><li><a class="tocitem" href="../../../api/command_line_args/command_line_args/">Command-line Arguments</a></li><li><a class="tocitem" href="../../../api/case_management/case_management/">Case Management</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-7" type="checkbox"/><label class="tocitem" for="menuitem-7"><span class="docs-label">Material Library</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../material_library/material_library/">MaterialLibrary</a></li><li><a class="tocitem" href="../../../material_library/collections/lithospheric_deformation_eb1/">Collection: Lithospheric Deformation eb1</a></li><li><a class="tocitem" href="../../../material_library/collections/benchmarks/">Collection: Benchmarks</a></li><li><a class="tocitem" href="../../../material_library/collections/benchmarks_sfs/">Collection: Benchmarks SFS</a></li><li><a class="tocitem" href="../../../material_library/collections/sandbox/">Collection: Sandbox</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-8" type="checkbox"/><label class="tocitem" for="menuitem-8"><span class="docs-label">Plot Tools</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../plot_tools/cl_plotter/">Command-line Plotter</a></li><li><a class="tocitem" href="../../../plot_tools/scalar_grid_plots/">Scalar Grid Plots</a></li><li><a class="tocitem" href="../../../plot_tools/vector_plots/">Velocity Vector Plots</a></li><li><a class="tocitem" href="../../../plot_tools/marker_plots/">Marker Swarm Plots</a></li><li><a class="tocitem" href="../../../plot_tools/yield_strength_plots/">Yield Strength Plots</a></li><li><a class="tocitem" href="../../../plot_tools/stokes_convergence_plots/">Stokes Convergence Plots</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-9" type="checkbox"/><label class="tocitem" for="menuitem-9"><span class="docs-label">Data Types</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../data_types/data_types/">Data Types</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-10" type="checkbox"/><label class="tocitem" for="menuitem-10"><span class="docs-label">Model Data</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../model_data/model_data/">ModelData</a></li><li><input class="collapse-toggle" id="menuitem-10-2" type="checkbox"/><label class="tocitem" for="menuitem-10-2"><span class="docs-label">Collections</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../model_data/collections/benchmarks/">Benchmarks</a></li><li><a class="tocitem" href="../../../model_data/collections/bcs/">BoundaryConditions</a></li><li><a class="tocitem" href="../../../model_data/collections/carbonate/">Carbonate</a></li><li><a class="tocitem" href="../../../model_data/collections/conversion/">Conversion</a></li><li><a class="tocitem" href="../../../model_data/collections/geometry/">Geometry</a></li><li><a class="tocitem" href="../../../model_data/collections/gravity/">Gravity</a></li><li><a class="tocitem" href="../../../model_data/collections/grids/">Grids</a></li><li><a class="tocitem" href="../../../model_data/collections/heat_equation/">HeatEquation</a></li><li><a class="tocitem" href="../../../model_data/collections/interpolation/">Interpolation</a></li><li><a class="tocitem" href="../../../model_data/collections/markers/">Markers</a></li><li><a class="tocitem" href="../../../model_data/collections/materials/">Materials</a></li><li><a class="tocitem" href="../../../model_data/collections/melting/">Melting</a></li><li><a class="tocitem" href="../../../model_data/collections/stokes_continuity/">StokesContinuity</a></li><li><a class="tocitem" href="../../../model_data/collections/timestep/">Timestep</a></li><li><a class="tocitem" href="../../../model_data/collections/topography/">Topography</a></li></ul></li></ul></li><li><input class="collapse-toggle" id="menuitem-11" type="checkbox"/><label class="tocitem" for="menuitem-11"><span class="docs-label">Units</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../units/units/">Units</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-12" type="checkbox"/><label class="tocitem" for="menuitem-12"><span class="docs-label">Benchmarks</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../benchmarks/benchmarks/">Benchmarks</a></li><li><a class="tocitem" href="../../../benchmarks/single_execution/">Single Execution</a></li><li><a class="tocitem" href="../../../benchmarks/batch_execution/">Batch Execution</a></li><li><input class="collapse-toggle" id="menuitem-12-4" type="checkbox"/><label class="tocitem" for="menuitem-12-4"><span class="docs-label">Results</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../../benchmarks/models/couette_flow_viscous_heating/">Couette Flow with Viscous Heating</a></li><li><a class="tocitem" href="../../../benchmarks/models/channel_flow_variable_conductivity/">Channel Flow Variable Conductivity</a></li><li><a class="tocitem" href="../../../benchmarks/models/channel_flow_non_steady_temperature/">Channel Flow Non Steady Temperature</a></li><li><a class="tocitem" href="../../../benchmarks/models/channel_flow_non_newtonian/">Channel Flow Non Newtonian</a></li><li><a class="tocitem" href="../../../benchmarks/models/solid_body_rotation/">Solid Body Rotation</a></li><li><a class="tocitem" href="../../../benchmarks/models/rayleigh_taylor_instability/">Rayleigh Taylor Instability</a></li><li><a class="tocitem" href="../../../benchmarks/models/elastic_slab/">Elastic Slab</a></li><li><a class="tocitem" href="../../../benchmarks/models/viscoelastic_stress_buildup/">Viscoelastic Stress Buildup</a></li><li><a class="tocitem" href="../../../benchmarks/models/box_convection_isoviscous_1a/">Box Convection Isoviscous 1a</a></li><li><a class="tocitem" href="../../../benchmarks/models/plasticity_benchmark_kaus10/">Plasticity Benchmark Kaus10</a></li><li><a class="tocitem" href="../../../benchmarks/models/seafloor_spreading/">Seafloor Spreading</a></li><li><a class="tocitem" href="../../../benchmarks/models/flexure_triangular_hole/">Flexure Triangular Hole</a></li><li><a class="tocitem" href="../../../benchmarks/models/viscoelastic_extension/">Viscoelastic Extension</a></li><li><a class="tocitem" href="../../../benchmarks/models/viscoelastic_contraction/">Viscoelastic Contraction</a></li><li><a class="tocitem" href="../../../benchmarks/models/simple_sedimentation/">Simple Sedimentation</a></li></ul></li></ul></li><li><a class="tocitem" href="../../../bibliography/bibliography/">References</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Methods</a></li><li class="is-active"><a href>Lava Flow</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Lava Flow</a></li></ul></nav><div class="docs-right"><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Melt-Extrusion-and-Lava-Flow"><a class="docs-heading-anchor" href="#Melt-Extrusion-and-Lava-Flow">Melt Extrusion and Lava Flow</a><a id="Melt-Extrusion-and-Lava-Flow-1"></a><a class="docs-heading-anchor-permalink" href="#Melt-Extrusion-and-Lava-Flow" title="Permalink"></a></h1><p>Volcanic extrusion and lava flow for a given eruption time step is modeled using a cellular automata  approach (<a href="../../../bibliography/bibliography/#dietterich17">Dietterich <em>et al.</em>, 2017</a>) where the volume of magma available for extrusion in a melt  drainage basin is divided into  <span>$N_{flow}$</span> flow events that extrude from a probabilistic eruption location <span>$x_{e}$</span>. Flow events occur at  an eruption interval <span>$\Delta t_e$</span> and involve the extrusion of all melt extracted during model time steps within the eruption interval. At the beginning of each  flow event, the current topography grid <span>$(x_{topo} \text{, } y_{topo})$</span> is decimated to a uniform  grid <span>$(x_{topo}&#39;\text{, } y_{topo}&#39;)$</span> with spacing <span>$\Delta x_{topo}&#39;$</span> to improve the computational  performance of the cellular automata calculation. Then a decimated flow thickness grid for the flow  event, <span>$(x_{topo}&#39;\text{, } H_{flow}&#39;)$</span>, is initialized to zero thickness. Each flow is that divided  into <span>$N_{pulse}$</span> pulses that laterally flow from the eruption location <span>$x_{e}$</span> to adjacent cells on  the decimated topography grid. </p><p>The volume of volcanic material per flow <span>$V_{flow}$</span> is calculated using the following equation:</p><h6 id="eq:flow-volume"><a class="docs-heading-anchor" href="#eq:flow-volume">eq:flow-volume</a><a id="eq:flow-volume-1"></a><a class="docs-heading-anchor-permalink" href="#eq:flow-volume" title="Permalink"></a></h6><p class="math-container">\[V_{flow} = \frac{V_{vol,k}}{N_{flow}}\]</p><p>where <span>$N_{flow}$</span> is given by:</p><h6 id="eq:num-flows"><a class="docs-heading-anchor" href="#eq:num-flows">eq:num-flows</a><a id="eq:num-flows-1"></a><a class="docs-heading-anchor-permalink" href="#eq:num-flows" title="Permalink"></a></h6><p class="math-container">\[N_{flow} =
\begin{cases}
    int\left( \frac{V_{vol,k}}{V_{flow}^{char}} \right) &amp; \quad \text{for} \quad V_{vol,k} &gt; V_{flow}^{char}\\
    1 &amp; \quad \text{for} \quad \text{otherwise}
\end{cases}\]</p><p>where <span>$V_{vol,k}$</span> is the total volume of volcanic material available for extrusion from the drainage  basin <span>$k$</span> calculated during the melt extraction steps within the eruption interval and <span>$V_{flow}^{char}$</span>  is the characteristic volume of volcanic material per flow given by:</p><h6 id="eq:char-flow-volume"><a class="docs-heading-anchor" href="#eq:char-flow-volume">eq:char-flow-volume</a><a id="eq:char-flow-volume-1"></a><a class="docs-heading-anchor-permalink" href="#eq:char-flow-volume" title="Permalink"></a></h6><p class="math-container">\[V_{flow}^{char} = 
\begin{cases}
    L_{sa} H_{res,sa}
        &amp; \quad \text{for} \quad  y_{e,fc} \leq y_{sl}
            \quad \text{and} \\
    L_{sm} H_{res,sm}
        &amp; \quad \text{for} \quad  y_{e,fc} &gt; y_{sl}
\end{cases}\]</p><p>where <span>$L_{sa}$</span> is the characteristic subaerial flow length, <span>$H_{res,sa}$</span> is the  subaerial residual flow thickness, <span>$L_{sm}$</span> is the characteristic submarine flow length, and <span>$H_{res,sm}$</span> is the submarine residual flow thickness, <span>$y_{e,fc}$</span> is the forecasted y-coordinate of the eruption, and <span>$y_{sl}$</span> is the y-coordinate of sea level. The forecasted y-coordinate  of the eruption <span>$y_{e,fc}$</span> in equation <a href="#eq:char-flow-volume">Eq.</a> is determined by interpolating  the y-coordinate from the decimated topography grid <span>$(x_{topo}&#39; \text{, } y_{topo}&#39;)$</span> at the  forecasted eruption location <span>$x_{e,fc}$</span> which is calculated using the following equation:</p><h6 id="eq:x-eruption-fc"><a class="docs-heading-anchor" href="#eq:x-eruption-fc">eq:x-eruption-fc</a><a id="eq:x-eruption-fc-1"></a><a class="docs-heading-anchor-permalink" href="#eq:x-eruption-fc" title="Permalink"></a></h6><p class="math-container">\[x_{e,fc} = x_{e, min} + \frac{W_e}{2}\]</p><p>where <span>$x_{e, min}$</span> is the minimum x-coordinate of the eruption location give by:</p><h6 id="eq:x-eruption-min"><a class="docs-heading-anchor" href="#eq:x-eruption-min">eq:x-eruption-min</a><a id="eq:x-eruption-min-1"></a><a class="docs-heading-anchor-permalink" href="#eq:x-eruption-min" title="Permalink"></a></h6><p class="math-container">\[x_{e, min} = x_{shallow,pm}&#39; - \frac{W_e}{2}\]</p><p>where <span>$x_{shallow,pm}&#39;$</span> is the average x-coordinate of the shallowest partially molten mantle  marker within drainage basin <span>$k$</span> calculated during melt extraction, and <span>$W_e$</span> is the width  of the eruption zone given by the following equation:</p><h6 id="eq:eruption-width"><a class="docs-heading-anchor" href="#eq:eruption-width">eq:eruption-width</a><a id="eq:eruption-width-1"></a><a class="docs-heading-anchor-permalink" href="#eq:eruption-width" title="Permalink"></a></h6><p class="math-container">\[W_e = 
\begin{cases}
    W_{e,min}
        &amp; \quad \text{for} \quad H_{mc} \leq H_{mc,min} \quad \text{and} \\
    W_{e,max}
        &amp; \quad \text{for} \quad H_{mc} \geq H_{mc,max} \quad \text{and} \\
    W_{e,min} + 
        \frac{(H_{mc,k} - H_{mc,min})}{(H_{mc,max} - H_{mc,min})}(W_{e,max} - W_{e,min})
        &amp; \quad \text{for} \quad H_{mc,min} &lt; H_{mc} &lt; H_{mc,max}
\end{cases}\]</p><p>where <span>$H_{mc,k}$</span> is the characteristic magmatic crust height for melt drainage basin <span>$k$</span> calculated  during melt extraction, <span>$H_{mc,min}$</span> is the minimum characteristic magmatic crust height, <span>$H_{mc,max}$</span>  is the maximum characteristic magmatic crust height, <span>$W_{e,min}$</span> is the minimum width of the  eruption zone and <span>$W_{e,max}$</span> is the maximum width of the eruption zone. </p><p>Each flow is erupted on the surface at eruption location <span>$x_{e}$</span> calculated as a normally distributed random variable as described by the following equation:</p><h6 id="eq:random-eruption-location"><a class="docs-heading-anchor" href="#eq:random-eruption-location">eq:random-eruption-location</a><a id="eq:random-eruption-location-1"></a><a class="docs-heading-anchor-permalink" href="#eq:random-eruption-location" title="Permalink"></a></h6><p class="math-container">\[x_e \sim \mathcal{N} \left( x_{e,min} + 0.5W_e, \, (0.25W_e)^2 \right)\]</p><p>subject to the constraint:</p><h6 id="eq:eruption-location-constraints"><a class="docs-heading-anchor" href="#eq:eruption-location-constraints">eq:eruption-location-constraints</a><a id="eq:eruption-location-constraints-1"></a><a class="docs-heading-anchor-permalink" href="#eq:eruption-location-constraints" title="Permalink"></a></h6><p class="math-container">\[x_{e,min} \leq x_e \leq x_{e,min} + W_e \text{.}\]</p><p>If <span>$x_e$</span> falls outside this range, it is recalculated.</p><p>Each flow is erupted in a series of pulses where the number of pulses is:</p><h6 id="eq:num_pulses"><a class="docs-heading-anchor" href="#eq:num_pulses">eq:num_pulses</a><a id="eq:num_pulses-1"></a><a class="docs-heading-anchor-permalink" href="#eq:num_pulses" title="Permalink"></a></h6><p class="math-container">\[N_{pulse} = \max\left[
    int\left(\frac{V_{flow}}{\left(\Delta x_{topo}&#39; H_{res}\right)}\right)
    \text{, } 1
    \right]\]</p><p>where <span>$\Delta x_{topo}&#39;$</span> is the grid spacing of a decimated topography grid used to perform cellular automata calculations, and <span>$H_{res}$</span> is the residual flow thickness given by:</p><h6 id="eq:residual*flow*thickness"><a class="docs-heading-anchor" href="#eq:residual*flow*thickness">eq:residual<em>flow</em>thickness</a><a id="eq:residual*flow*thickness-1"></a><a class="docs-heading-anchor-permalink" href="#eq:residual*flow*thickness" title="Permalink"></a></h6><p class="math-container">\[H_{res} = 
\begin{cases}
    H_{res,sa}
        &amp; \quad \text{for} \quad  y_e \leq Y_{sl}
            \quad \text{and} \\
    H_{res,sm}
        &amp; \quad \text{for} \quad  y_e &gt; Y_{sl}
\end{cases}\]</p><p>The thickness of each pulse is calculated using the following equation:</p><h6 id="eq:pulse_thickness"><a class="docs-heading-anchor" href="#eq:pulse_thickness">eq:pulse_thickness</a><a id="eq:pulse_thickness-1"></a><a class="docs-heading-anchor-permalink" href="#eq:pulse_thickness" title="Permalink"></a></h6><p class="math-container">\[H_{pulse} = \frac{V_{flow}}{N_{pulse}\Delta x_{topo}&#39;}\]</p><p>A critical step in the cellular automata calculation is to sort the indices of the decimated topography grid based on the distance from the eruption location <span>$x_{e}$</span> with grid index given by:</p><h6 id="eq:eruption-index"><a class="docs-heading-anchor" href="#eq:eruption-index">eq:eruption-index</a><a id="eq:eruption-index-1"></a><a class="docs-heading-anchor-permalink" href="#eq:eruption-index" title="Permalink"></a></h6><p class="math-container">\[i_e = int\left(\frac{x_e}{\Delta x_{topo}&#39;}\right) \text{.}\]</p><p>For a given pulse of volcanic material, the cellular automata calculation is initialized as:</p><h6 id="eq:initialize-pulse-thickness"><a class="docs-heading-anchor" href="#eq:initialize-pulse-thickness">eq:initialize-pulse-thickness</a><a id="eq:initialize-pulse-thickness-1"></a><a class="docs-heading-anchor-permalink" href="#eq:initialize-pulse-thickness" title="Permalink"></a></h6><p class="math-container">\[H_{flow(i_e)}&#39; = H_{flow(i_e)}&#39;^{o} + H_{pulse} \text{.}\]</p><p>where <span>$H_{flow(i_e)}&#39;^{o}$</span> is the thickness of the flow at index <span>$i_e$</span> prior to the current pulse. For a given lava pulse, flow thickness <span>$H_{flow}&#39;$</span> is updated for each cell by radiating output from  index <span>$i_e$</span>. Basaltic lava material flows from cells with higher relative elevation to adjacent cells  with the lower relative elevation until the integrated thickness of the lava flow <span>$H_{flow}&#39;$</span> equals  the residual thickness <span>$H_{res}$</span> after which flow ceases to occur. During the iterative update procedure  for a given pulse of the lava, the y-coordinates of topography, <span>$y_{topo(i)}&#39;&#39;$</span>, <span>$y_{topo(i-1)}&#39;&#39;$</span>,  and <span>$y_{topo(i+1)}&#39;&#39;$</span> are are related to current flow thickness <span>$H_{flow(i)}&#39;$</span> as follows:</p><p class="math-container">\[\begin{split}
    y_{topo(i)}&#39;&#39; = y_{topo}(i)&#39; - H_{flow(i)}&#39; \\
    y_{topo(i-1)}&#39;&#39; = y_{topo}(i-1)&#39; - H_{flow(i-1)}&#39; \\
    y_{topo(i+1)}&#39;&#39; = y_{topo}(i+1)&#39; - H_{flow(i+1)}&#39;
\end{split}\]</p><p>and elevation differences that drive flow from cell <span>$i$</span> to adjacent cells are given by:</p><p class="math-container">\[\begin{split}
    \Delta E_{left(i)}&#39; = \max(0 \text{, } y_{topo(i-1)}&#39;&#39; - y_{topo(i)}&#39;&#39;) \\
    \Delta E_{right(i)}&#39; = \max(0 \text{, } y_{topo(i+1)}&#39;&#39; - y_{topo(i)}&#39;&#39;) \text{.}
\end{split}\]</p><p>where positive values of <span>$\Delta E_{left(i)}&#39;$</span> and <span>$\Delta E_{right(i)}&#39;$</span> indicate that flow will  occur from cell <span>$i$</span> to adjacent cells <span>$i-1$</span> and <span>$i+1$</span>, respectively, if current flow thickness <span>$H_{flow(i)}&#39;$</span> is greater than the residual thickness <span>$H_{res}$</span>. The total thickness of lava  available to flow to adjacent cells is given by:</p><h6 id="eq:total-outflow-thickness"><a class="docs-heading-anchor" href="#eq:total-outflow-thickness">eq:total-outflow-thickness</a><a id="eq:total-outflow-thickness-1"></a><a class="docs-heading-anchor-permalink" href="#eq:total-outflow-thickness" title="Permalink"></a></h6><p class="math-container">\[\Delta H_{out,total(i)}&#39; = \frac{2}{3}
    \min\left[
            \max\left( 0 \text{, } H_{flow(i)}&#39; - H_{res}\right)
            \text{, }
            \Delta E_{limit(i)}&#39;
        \right]\]</p><p>where <span>$\Delta H_{out,total(i)}&#39;$</span> is the total thickness of lava available to flow from cell <span>$i$</span> to adjacent cells, and <span>$\Delta E_{limit(i)}&#39;$</span> is given by:</p><h6 id="eq:lava-delta-elevation-limit"><a class="docs-heading-anchor" href="#eq:lava-delta-elevation-limit">eq:lava-delta-elevation-limit</a><a id="eq:lava-delta-elevation-limit-1"></a><a class="docs-heading-anchor-permalink" href="#eq:lava-delta-elevation-limit" title="Permalink"></a></h6><p class="math-container">\[\Delta E_{limit(i)}&#39; = 
\begin{cases}
    \left(\Delta E_{left(i)}&#39; + \Delta E_{right(i)}&#39;\right)/2
        &amp; \quad \text{if} \quad
            \Delta E_{left(i)}&#39; &gt; 0 \quad \text{and} \quad 
            \Delta E_{right(i))}&#39; &gt; 0 \\
    \Delta E_{right(i)}&#39;
        &amp; \quad \text{else if} \quad \Delta E_{right(i)}&#39; &gt; 0 \\
    \Delta E_{left(i)}&#39;
        &amp; \quad \text{else} \quad \Delta E_{left(i)}&#39; &gt; 0 \text{.}
\end{cases}\]</p><p>Equation <a href="#eq:total-outflow-thickness">Eq.</a> facilitates convergence of the cellular automata  iterations by limiting the amount of inter-cellular flow and ensures that flow does not occur if flow thickness is less than or equal to the residual flow thickness <span>$H_{res}$</span>.</p><p>The total outflow thickness <span>$H_{out,total(i)}&#39;$</span> is partitioned to adjacent cells using the following equations:</p><h6 id="eq:outflow-thickness"><a class="docs-heading-anchor" href="#eq:outflow-thickness">eq:outflow-thickness</a><a id="eq:outflow-thickness-1"></a><a class="docs-heading-anchor-permalink" href="#eq:outflow-thickness" title="Permalink"></a></h6><p class="math-container">\[\begin{split}
    \Delta H_{out,left(i)}&#39; = min\left(
        \Delta H_{out,total(i)}&#39;
        \frac{\Delta E_{left(i)}&#39;}
            {\left( |\Delta E_{left(i)}&#39;| + |\Delta E_{right(i)}&#39;| \right)} \text{, } \Delta E_{left(i)}&#39;
        \right) \\
    \Delta H_{out,right(i)}&#39; = min\left(
        \Delta H_{out,total(i)}&#39;
        \frac{\Delta E_{right(i)}&#39;}
            {\left( |\Delta E_{left(i)}&#39;| + |\Delta E_{right(i)}&#39;| \right)} \text{, } \Delta E_{right(i)}&#39;
        \right) \text{. }
\end{split}\]</p><p>where outflow thickness is limited by elevation differences between cells. The thickness of the flow is updated for cell <span>$i$</span> and adjacent cells using the following equations:</p><h6 id="eq:flow-thickness-update"><a class="docs-heading-anchor" href="#eq:flow-thickness-update">eq:flow-thickness-update</a><a id="eq:flow-thickness-update-1"></a><a class="docs-heading-anchor-permalink" href="#eq:flow-thickness-update" title="Permalink"></a></h6><p class="math-container">\[\begin{split}
    H_{flow(i-1)}&#39; = H_{flow(i-1)}&#39;^{o} + \Delta H_{out,left(i)}&#39; \\
    H_{flow(i)}&#39; = H_{flow(i)}&#39;^{o} - \Delta H_{out,left(i)}&#39; - \Delta H_{out,right(i)}&#39; \\
    H_{flow(i+1)}&#39; = H_{flow(i+1)}&#39;^{o} + \Delta H_{out,right(i)}&#39;
\end{split}\]</p><p>where <span>$H_{flow(i-1)}&#39;^{o}$</span>, <span>$H_{flow(i)}&#39;^{o}$</span>, and <span>$H_{flow(i+1)}&#39;^{o}$</span> are the thickness of the flow prior to the current cellular automata iteration. For each iteration of the cellular automata calculation, equations <a href="#eq:flow-thickness-update">Eq.</a> are applied to each cell in the decimated topography grid. These iterations are repeated until the maximum thickness difference between iterations falls below a  tolerance of <span>$10^{-4}$</span>.</p><p>After the thickness of the flow on the decimated grid, <span>$H_{flow,i}&#39;$</span>, is updated for each pulse, flow thickness is interpolated and added to the original un-decimated topography grid producing an  updated flow thickness <span>$H_{flow,i}$</span>. The topography grid at the end of a flow event is then updated as follows:</p><h6 id="eq:topo-flow-update"><a class="docs-heading-anchor" href="#eq:topo-flow-update">eq:topo-flow-update</a><a id="eq:topo-flow-update-1"></a><a class="docs-heading-anchor-permalink" href="#eq:topo-flow-update" title="Permalink"></a></h6><p class="math-container">\[y_{topo,i} = y_{topo,i}^o - H_{flow,i}\]</p><p>where <span>$y_{topo,i}^o$</span> is y-coordinate of the topography from the prior flow event. Equation  <a href="#eq:topo-flow-update">Eq.</a> ensures that lava flow calculations are consistent with a dynamically  evolving landscape impacted by the flow of volcanic material. </p><p>The thickness of lava <span>$H_{flow,i}$</span> produced during a given flow event is added to <span>$H_{flow,tot,i}$</span>, which is  the integrated thickness of all flow events associated with a thermo-mechanical model time step. The total flow thickness <span>$H_{flow,tot,i}$</span> is used to transform sticky markers to volcanic material if <span>$y_m$</span> is greater than <span>$y_{topo,m}$</span>, which is the interpolated y-coordinate of the updated topography grid <span>$y_{topo,i}$</span> at x-coordinate <span>$x_m$</span>. For cases where topography has been  updated for both sedimentation and extrusive flow, sticky markers are transformed to volcanic  sediment if <span>$y_m$</span> is greater than <span>$y_{topo,m} + H_{flow,tot,m}$</span> and to volcanic markers if  <span>$y_m$</span> is less than <span>$y_{topo,m} + H_{flow,tot,m}$</span> where <span>$H_{flow,tot,m}$</span> is the total thickness of lava  flows interpolated at the x-coordinate of the marker <span>$x_m$</span>. This approach assumes that sediment is deposited prior to the eruption of volcanic material. The current volume of volcanic material available for extrusion, <span>$V_{vol,k}$</span>, is reset to zero at the end of each eruption interval.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../melt/melt/">« Melt</a><a class="docs-footer-nextpage" href="../../viscous_creep/viscous_creep/">Viscous Creep »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.0 on <span class="colophon-date" title="Thursday 20 November 2025 21:32">Thursday 20 November 2025</span>. Using Julia version 1.12.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
